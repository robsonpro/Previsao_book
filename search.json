[
  {
    "objectID": "ST4.html#regressão-linear-simples",
    "href": "ST4.html#regressão-linear-simples",
    "title": "4  Regressão de séries temporais",
    "section": "4.1 Regressão linear simples",
    "text": "4.1 Regressão linear simples\nA regressão de séries temporais serve para prever uma série em função de outra ou mais relacionadas. Não é o método mais usual e sofisticado, uma vez que os métodos mais avançados consideram o padrão da própria série para modelagem e previsão. Entretanto, em algumas situações tal abordagem pode ser útil. Ademais, há possibilidade de combinar a regressão com ARIMA, conforme será abordado futuramente.\nSeja um problema onde deseja-se prever uma série temporal contínua, \\(y_1, y_2, ..., y_T\\), em função de outra, \\(x_1, x_2, ..., x_T\\).\nNa Figura 4.1 são plotadas as séries temporais anuais de área plantada em hectare e grãos produzidos em toneladas no Brasil de 1977 a 2022, http://www.ipeadata.gov.br. As séries apresentam tendência de crescimento não linear.\n\n\n\n\n\nFigura 4.1: Produção de grãos no Brasil\n\n\n\n\nAo plotar um diagrama de dispersão entre as séries, pode-se observar uma correlação linear positiva alta entre estas, conforme Figura 4.2.\n\n\n\n\n\nFigura 4.2: Área plantada versus Produção de grãos\n\n\n\n\nConforme observado na Figura 4.3, pode-se considerar em diversos casos a aproximação de uma função linear para tal relação.\n\n\n\n\n\nFigura 4.3: Modelo de regressão linear simples para produção de grãos em função da área plantada\n\n\n\n\nO modelo linear plotado em azul pode ser descrito conforme Equação abaixo, onde \\(\\beta_0\\) é uma constante e \\(\\beta_1\\) é um coeficiente linear.\n\\[\n\\hat{y}_t = \\beta_0+\\beta_{1}x_t\n\\]\nAs observações da série dependente ou resposta podem ser descritas conforme segue, como sendo o valor estimado adicionado, \\(\\hat y_t\\), de um termo de erro ou resíduo, \\(\\varepsilon_t\\).\n\\[\n\\begin{aligned}\ny_t = \\hat{y}_t + \\varepsilon_t \\\\\ny_t = \\beta_0 + \\beta_1x_t + \\varepsilon_t \\\\\n\\end{aligned}\n\\]\nConsiderando as \\(T\\) observações das séries, \\((x_1, y_1), (x_2, y_2), ..., (x_T, y_T)\\), pode-se pensar em um modelo que minimize os erros de previsão. Uma vez que o erro é normalmente distribuído, com média nula e variância \\(\\sigma_\\varepsilon^2\\), sendo os resíduos normalmente distribuídos, com média nula e variância igual a \\(\\sigma_\\varepsilon^2\\), \\(\\varepsilon \\sim N(0,\\sigma_\\varepsilon^2)\\), pode-se trabalhar a minimização da soma dos quadrados dos erros de previsão, \\(\\sum_{t=1}^{T}\\varepsilon_t^2\\). A Figura Figura 4.4 plota em linhas vermelhas verticais os resíduos. O modelo plotado minimiza a soma dos quadrados de tais erros.\n\n\n\n\n\nFigura 4.4: Erros de previsão para o modelo de regressão linear para produção de grãos em função da área plantada\n\n\n\n\nA análise à seguir expõe os coeficientes do modelo estimado com teste t para significância destes. Neste curso não será dada ênfase na inferência, mas na previsão. De forma simples um valor t com alta magnitude ou um p-valor (Pr(&gt;|t|)) baixo indica risco baixo de rejeitar a hipótese nula de ausência de efeito da variável ou série independente (\\(x_t\\)).\n\n\nSeries: producao \nModel: TSLM \n\nResiduals:\n   Min     1Q Median     3Q    Max \n-42054 -17157   1734  17910  39834 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   -1.896e+05  1.500e+04  -12.64   &lt;2e-16 ***\narea_plantada  6.782e+00  3.138e-01   21.61   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 23540 on 45 degrees of freedom\nMultiple R-squared: 0.9121, Adjusted R-squared: 0.9102\nF-statistic: 467.2 on 1 and 45 DF, p-value: &lt; 2.22e-16\n\n\nO modelo para prever a produção de grãos em função da área plantada fica:\n\\[\n\\hat{y}_t = -1,89 \\times 10^{5} + 6,782x_t\n\\]"
  },
  {
    "objectID": "ST4.html#regressão-linear-múltipla",
    "href": "ST4.html#regressão-linear-múltipla",
    "title": "4  Regressão de séries temporais",
    "section": "4.2 Regressão linear múltipla",
    "text": "4.2 Regressão linear múltipla\nNo caso de onde há múltiplas séries independentes ou regressoras de interesse, \\(x_{t1}, x_{t2}, ..., x_{tk}\\), onde \\(k\\) é o número de séries consideradas para estimar \\(y_t\\), pode-se considerar o modelo com um coeficiente linear associado a cada variável, isto é:\n\\[\n\\hat{y}_t = \\beta_0 + \\beta_1x_{t1} + \\beta_2x_{t2} + \\cdots + \\beta_kx_{tk} = \\beta_0 + \\sum_{j=1}^{k}\\beta_jx_{tj},  \n\\]\nou de forma matricial com \\(\\mathbf{X}_{[T\\times (k+1)]}\\) e \\(\\mathbf{\\beta}_{[(k+1) \\times 1]}\\):\n\\[\n\\begin{aligned}\n\\hat{\\mathbf{y}} = \\mathbf{X}\\mathbf{\\beta}\n\\end{aligned},\n\\]\nonde a matrix \\(\\mathbf{X}\\) contém uma coluna unitária para a constante e uma coluna para cada série independente:\n\\[\n\\mathbf{X} =\n\\begin{bmatrix}\n1 & x_{11} & x_{12} & \\cdots & x_{1k}\\\\\n1 & x_{21} & x_{22} & \\cdots & x_{2k} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots\\\\\n1 & x_{T1} & x_{T2} & \\cdots & x_{Tk} \\\\\n\\end{bmatrix}, e\\\\\n\\]\ne \\(\\beta\\) consite no vetor de coeficientes:\n\\[\n\\mathbf{\\beta}^T =\n\\begin{bmatrix}\n\\beta_0 & \\beta_1 & \\cdots & \\beta_k\\\\\n\\end{bmatrix}. \\\\\n\\]\nOs valores observados da série \\(\\mathbf{y}\\) podem ser recuperados somando os valores preditos e o erro.\n\\[\n\\begin{aligned}\n\\mathbf{y} = \\mathbf{X}\\mathbf{\\beta} + \\mathbf{\\varepsilon}\n\\end{aligned}\n\\]\nTomando tal notação, a soma dos quadrados dos erros pode ser descrita como \\(\\sum_{t=1}^{T}\\varepsilon_t^2 = \\mathbf{\\varepsilon}^T\\mathbf{\\varepsilon}\\). Desenvolvendo tal expressão tem-se:\n\\[\n\\begin{aligned}\nL(\\mathbf{\\beta}) = \\mathbf{\\varepsilon}^T\\mathbf{\\varepsilon} = (\\mathbf{y} - \\mathbf{X}\\mathbf{\\beta})^T(\\mathbf{y} - \\mathbf{X}\\mathbf{\\beta}) \\\\\n\\mathbf{y}^T\\mathbf{y} - 2\\mathbf{\\beta}^T\\mathbf{X}^T\\mathbf{y} + \\mathbf{\\beta}^T\\mathbf{X}^T\\mathbf{X}\\mathbf{\\beta}\n\\end{aligned}\n\\]\nPara minimizar \\(L\\) em relação à estimativa de \\(\\mathbf{\\beta}\\), pode-se diferenciar tal quantidade em relação à \\(\\mathbf{\\beta}\\) e igualar a zero:\n\\[\n\\begin{aligned}\n\\frac{\\partial L}{\\partial \\mathbf{\\beta}} = -2\\mathbf{X}^T\\mathbf{y} + 2\\mathbf{X}^T\\mathbf{X}\\mathbf{\\beta} = 0 \\\\\n\\hat{\\mathbf{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}(\\mathbf{X}^T\\mathbf{y})\n\\end{aligned}\n\\]\nA estimativa dos coeficientes \\(\\hat\\beta\\) obtida minimiza a soma dos quadrados dos resíduos, \\(\\sum \\varepsilon_i^2\\), sendo portanto as estimativas de mínimos quadrados.\nSeja a série multivariada de índices de produção de bens de capital, de consumo duráveis, intermediários e de consumo não duráveis, plotada na Figura 4.5.\n\n\n\n\n\nFigura 4.5: Bens de consumo duráveis, intermediários e de consumo não duráveis\n\n\n\n\nObserva-se na Figura 4.6 diagramas de dispersão e correlações aos pares, ficando clara a relação linear entre tais índices.\n\n\n\n\n\nFigura 4.6: Bens de consumo duráveis, intermediários e de consumo não duráveis\n\n\n\n\nUma vez que os bens de consumo duráveis dependem dos bens de capital, os quais consistem nos ativos de empresas para produzir produtos ou serviços, e dos bens intermediários, supõe-se a possibilidade de obter um modelo de regressão múltipla desta série em função daquelas. A seguir apresenta-se o modelo de regressão múltipla estimado para a prever o índice de bens de consumos duráveis \\(y_t\\) em função dos de capital, \\(x_{t1}\\), e de produtos intermediários, \\(x_{t2}\\). Ambos apresentaram significância estatística.\n\n\nSeries: consumo_duraveis \nModel: TSLM \n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-38.361  -7.949   1.382   8.824  33.937 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    -60.12405    9.55694  -6.291 1.28e-09 ***\ncapital          0.73046    0.05886  12.409  &lt; 2e-16 ***\nintermediarios   1.09143    0.12334   8.849  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 13.04 on 268 degrees of freedom\nMultiple R-squared: 0.7734, Adjusted R-squared: 0.7717\nF-statistic: 457.4 on 2 and 268 DF, p-value: &lt; 2.22e-16\n\n\nO modelo obtido pode ser escrito confirme segue:\n\\[\n\\hat y_t = -60,12 + 0,73x_{t1} + 1,09x_{t2}\n\\]"
  },
  {
    "objectID": "ST4.html#desempenho-do-modelo-de-regressão",
    "href": "ST4.html#desempenho-do-modelo-de-regressão",
    "title": "4  Regressão de séries temporais",
    "section": "4.3 Desempenho do modelo de regressão",
    "text": "4.3 Desempenho do modelo de regressão\nUma forma de medir o ajuste do modelo obtido aos dados seria a partir do cálculo do coeficiente de determinação múltipla, \\(R^2\\), conforme segue,\n\\[\n\\begin{align}\nR^2 = 1- SS_{E}/SS_T \\\\\nR^2 = 1- \\frac{\\sum_{i=1}^{N}(y_i-\\hat{y}_i)^2}{\\sum_{i=1}^{N}(y_i-\\overline{y}_i)^2},\n\\end{align}\n\\]\nonde \\(SS_E\\) consiste na soma dos quadrados dos erros e \\(SS_T\\) consiste na soma dos quadrados total, ou no numerador da variância da série a ser predita.\nO \\(R^2\\) sempre aumenta ao se adicionar novos termos no modelo, mesmo se estes não são significativos, uma vez que não leva em conta os graus de liberdade no cálculo. O coeficiente de determinação múltipla ajustado, \\(R^2_{aj}\\), é uma métrica mais interessante, já que considera as médias dos quadrados ao invés das somas dos quadrados dos erros, conforme segue:\n\\[\n\\begin{align}\nR^2 = 1- MS_{E}/MS_T \\\\\nR^2 = 1- \\frac{\\sum_{i=1}^{N}(y_i-\\hat{y}_i)^2/(T-K-1)}{\\sum_{i=1}^{N}(y_i-\\overline{y}_i)^2/(T-1)},\n\\end{align}\n\\]\nonde \\(K\\) é o número de termos no modelo, \\(MS_E\\) consiste média dos quadrados dos erros, que consiste na estimativa de variância dos resíduos, enquanto \\(MS_T\\) consiste na média dos quadrados total, ou na variância da série a ser predita.\nPara o modelo de regressão simples para produção de grãos em função da área plantada foi obtido um ajuste de mais de 91%, garantindo tal percentual de explicação da variabilidade da série de produção em função da área plantada. A Figura 4.7 plota a série de produção de grãos observada e a aproximada pelo modelo de regressão.\n\n\n\n\n\nFigura 4.7: Produção de grãos\n\n\n\n\nA Figura 4.8 plota a série do índice de produção de bens de consumo duráveis observada e a aproximada pelo modelo de regressão múltipla.\n\n\n\n\n\nFigura 4.8: Bens de consumo duráveis"
  },
  {
    "objectID": "ST4.html#diagnóstico-dos-resíduos",
    "href": "ST4.html#diagnóstico-dos-resíduos",
    "title": "4  Regressão de séries temporais",
    "section": "4.4 Diagnóstico dos resíduos",
    "text": "4.4 Diagnóstico dos resíduos\nA Figura 4.9 apresenta alguns gráficos dos resíduos do modelo de produção de grãos em função da área plantada. Pode-se observar que o primeiro gráfico apresenta tendências em alguns instantes, com padrão não aleatório, indicando presença de autocorrelação. O correlograma confirma presença de autocorrelação nos resíduos até a defasagem de ordem 4. Logo, há informação importante não capturada pelo modelo de regressão.\n\n\n\n\n\nFigura 4.9: Resíduos do modelo de produão de grãos em função da área plantada"
  },
  {
    "objectID": "ST4.html#preditores-úteis",
    "href": "ST4.html#preditores-úteis",
    "title": "4  Regressão de séries temporais",
    "section": "4.5 Preditores úteis",
    "text": "4.5 Preditores úteis\nMuitas séries temporais costumam apresentar tendência. Um modelo linear simples pode considerar o tempo, \\(t\\), como preditor, de forma a capturar a tendência.\n\\[\n\\hat{y}_t = \\beta_0+\\beta_{1}t\n\\]\nPode-se também considerar variáveis dicotômicas ou binárias (dummy) para considerar a sazonalidade, feriados, ou algum evento especial. Por exemplo, para sazonalidade anual com uma série de frequência quadrimestral, pode-se considerar como variávis dummy as expostas na Tabela Tabela 4.1.\n\n\nTabela 4.1: Criação de variáveis dummy\n\n\nQuadrimestre\n\\(d_{1,t}\\)\n\\(d_{2,t}\\)\n\\(d_{3,t}\\)\n\\(d_{4,t}\\)\n\n\n\n\nQ1\n1\n0\n0\n0\n\n\nQ2\n0\n1\n0\n0\n\n\nQ3\n0\n0\n1\n0\n\n\nQ4\n0\n0\n0\n1\n\n\nQ1\n1\n0\n0\n0\n\n\n\\(\\vdots\\)\n\\(\\vdots\\)\n\\(\\vdots\\)\n\\(\\vdots\\)\n\\(\\vdots\\)\n\n\n\n\nA Figura 4.10 exibe a série temporal de temperatura de São João del-Rei para os dias 15 a 28 de junho com frequência horária.\n\n\n\n\n\nFigura 4.10: Temperatura em São João del-Rei nas duas últimas semanas de junho\n\n\n\n\nA Figura 4.11 expõe o gráfico sazonal da mesma série. Observa-se sazonalidade diária e uma tendência de crescimento, especialmente da temperatura mínima, para os dias considerados.\n\n\n\n\n\nFigura 4.11: Gráfico sazonal da temperatura em São João del-Rei\n\n\n\n\nUm modelo de regressão considerando a tendência e sazonalidade para este caso deve considerar como variáveis dummy o dia, de forma a capturar a variação hora a hora. Logo, neste caso, 24 variáveis dummy são criadas. Observa-se que além da tendência a maior parte de tais variáveis apresenta significância e o modelo contempla mais de 95% de variabilidade da série.\n\n\nSeries: Temp \nModel: TSLM \n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3.20212 -0.76300 -0.08292  0.87326  2.92845 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   15.0055227  0.3406085  44.055  &lt; 2e-16 ***\ntrend()        0.0088820  0.0006822  13.020  &lt; 2e-16 ***\nseason()day2  -0.8445963  0.4572598  -1.847 0.065685 .  \nseason()day3  -1.5463355  0.4572613  -3.382 0.000812 ***\nseason()day4  -2.4052175  0.4572639  -5.260 2.69e-07 ***\nseason()day5  -3.3355281  0.4572674  -7.294 2.51e-12 ***\nseason()day6  -4.0515530  0.4572720  -8.860  &lt; 2e-16 ***\nseason()day7  -4.5675778  0.4572776  -9.989  &lt; 2e-16 ***\nseason()day8  -5.1978884  0.4572842 -11.367  &lt; 2e-16 ***\nseason()day9  -5.6281990  0.4572918 -12.308  &lt; 2e-16 ***\nseason()day10 -6.2156525  0.4573005 -13.592  &lt; 2e-16 ***\nseason()day11 -6.4245345  0.4573102 -14.049  &lt; 2e-16 ***\nseason()day12 -5.3119879  0.4573208 -11.615  &lt; 2e-16 ***\nseason()day13 -2.1708700  0.4573326  -4.747 3.16e-06 ***\nseason()day14  2.6273909  0.4573453   5.745 2.19e-08 ***\nseason()day15  6.6756517  0.4573590  14.596  &lt; 2e-16 ***\nseason()day16  8.3024840  0.4573738  18.153  &lt; 2e-16 ***\nseason()day17  9.1650305  0.4573895  20.038  &lt; 2e-16 ***\nseason()day18  9.7490056  0.4574063  21.314  &lt; 2e-16 ***\nseason()day19  9.8258379  0.4574241  21.481  &lt; 2e-16 ***\nseason()day20  8.9883845  0.4574429  19.649  &lt; 2e-16 ***\nseason()day21  7.7795024  0.4574628  17.006  &lt; 2e-16 ***\nseason()day22  4.5277633  0.4574836   9.897  &lt; 2e-16 ***\nseason()day23  2.9474527  0.4575055   6.442 4.47e-10 ***\nseason()day24  1.4742850  0.4575284   3.222 0.001407 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.21 on 311 degrees of freedom\nMultiple R-squared: 0.961,  Adjusted R-squared: 0.958\nF-statistic: 319.5 on 24 and 311 DF, p-value: &lt; 2.22e-16\n\n\nHá uma tendência de aumento da temperatura nos dias considerados de 0,00888 °C por hora, ou 0,213°C por dia. Cada coeficiente das variáveis dummy expõe a diferença da respectiva hora em relação à primeira hora do dia. Por exemplo, às 6 da manhã a diferença de temperatura em relação a 1 da manhã é igual a -4.05°C. A Figura Figura 4.12 apresenta a série observada e a prevista pelo modelo de regressão.\n\n\n\n\n\nFigura 4.12: Temperatura em São João del-Rei\n\n\n\n\nA Figura 4.13 apresenta os valores previstos e observados plotados com as horas do dia separadas em cores distintas. Observa-se o excelente ajuste do modelo e a variação da temperatura segundo hora do dia.\n\n\n\n\n\nFigura 4.13: Temperatura em São João del-Rei"
  },
  {
    "objectID": "ST4.html#seleção-de-preditores",
    "href": "ST4.html#seleção-de-preditores",
    "title": "4  Regressão de séries temporais",
    "section": "4.6 Seleção de preditores",
    "text": "4.6 Seleção de preditores\nA Figura 4.14 exibe séries temporais de petróleo refinado e derivados produzidos no Brasil em \\(m^3\\), https://www.gov.br/anp/pt-br/centrais-de-conteudo/dados-estatisticos. O petróleo considera o volume nacional e importado.\n\n\n\n\n\nFigura 4.14: Petróleo refinado e produção de derivados\n\n\n\n\nA Figura 4.15 expõe um gráfico de correlação entre tais séries. As séries foram agrupadas segundo a magnitude e sinal das correlações. A série de petróleo refinado tem correlação positiva com asfalto, oléo diesel, outros não energéticos, querosene de avião, coque e gasolina e correlação negativa ou desprezível com as demais séries.\n\n\n\n\n\nFigura 4.15: Correlação entre petróleo refinado e derivados\n\n\n\n\nA seguir expõe-se um modelo de regressão múltipla do petróleo refinado em função do volume produzido dos derivados. Apenas GLP, coque, querosene de avião, querosene iluminante e solvente não apresentaram significância estatística.\n\n\nSeries: petroleo \nModel: TSLM \n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-4.927e-11 -7.235e-12 -5.715e-13  5.091e-12  4.892e-10 \n\nCoefficients:\n                         Estimate Std. Error    t value Pr(&gt;|t|)    \n(Intercept)             3.528e-11  3.190e-11  1.106e+00 0.269750    \nGLP                    -5.660e-17  4.844e-17 -1.169e+00 0.243583    \nasfalto                -3.794e-16  5.256e-17 -7.218e+00 4.93e-12 ***\ncoque                  -9.954e-17  6.589e-17 -1.511e+00 0.132011    \ngasolina               -1.357e-16  1.725e-17 -7.869e+00 7.78e-14 ***\nlubrificante           -9.102e-16  1.935e-16 -4.703e+00 4.02e-06 ***\nnafta                  -3.579e-16  2.820e-17 -1.269e+01  &lt; 2e-16 ***\noleo_combustivel       -1.703e-16  1.625e-17 -1.048e+01  &lt; 2e-16 ***\noleo_diesel            -2.345e-16  1.589e-17 -1.475e+01  &lt; 2e-16 ***\noutros_nao_energeticos -3.699e-16  5.580e-17 -6.628e+00 1.73e-10 ***\nparafina               -2.542e-15  7.252e-16 -3.505e+00 0.000532 ***\npetroleo                1.000e+00  1.090e-17  9.176e+16  &lt; 2e-16 ***\nquerosene_aviao        -2.851e-17  3.489e-17 -8.170e-01 0.414435    \nquerosene_iluminante    5.304e-16  5.472e-16  9.690e-01 0.333249    \nsolvente                2.219e-19  1.712e-16  1.000e-03 0.998967    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.227e-11 on 281 degrees of freedom\nMultiple R-squared:     1,  Adjusted R-squared:     1\nF-statistic: 1.21e+34 on 14 and 281 DF, p-value: &lt; 2.22e-16\n\n\nGeralmente, em regressão múltipla é interessante selecionar um modelo com os melhores preditores, de forma a melhorar a capacidade preditiva do modelo. Além do \\(R^2_{aj}\\), outras métricas podem ser usadas, por exemplo o critério de informação de Akaike, AIC. O AIC considera o número de parâmetros e o erro do modelo, sendo esta uma métrica mais interessante para seleção de modelos.\n\\[\nAIC = T\\text{ log}\\bigg(\\frac{SS_E}{T}\\bigg)+2(k+2)\n\\]\nA Tabela 4.2 apresenta os resultados de AIC, AIC corrigido e \\(R^2_{aj}\\) para o modelo completo e um modelo sem os parâmetros GLP, coque, querosene de avião, querosene iluminante e solvente. O modelo completo apresentou melhor resultado, uma vez que minimiza AIC e AICc.\n\n\n\n\nTabela 4.2: \\(R^2_{aj}\\), AIC e AIC corrigido para os modelos\n\n\nmodel\nadj_r_squared\nAIC\nAICc\n\n\n\n\ncompleto\n1\n-14284.33\n-14282.38\n\n\nreduzido\n1\n-13198.62\n-13197.69\n\n\n\n\n\n\nA forma correta de realizar a remoção de coeficientes, conforme pode-se presumir pelo exemplo anterior, não é considerando a significância. Ademais, não sugere-se a remoção manual de coeficientes. Recomenda-se o uso de um algoritmo para tal fim. O algoritmo stepwise com eliminação para trás segue os seguintes passos:\n\nComece com o modelo completo.\nRemova um preditor por vez. Mantenha o modelo com melhor desempenho, considerando por exemplo o AIC.\nRepita o procedimento até encontrar o melhor modelo."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Séries Temporais e Previsão",
    "section": "",
    "text": "Prefácio\nApostila de séries temporais.\nEsta apostila é baseada no excelente livro de Hyndman and Athanasopoulos (2021), disponível em OTexts.com/fpp3.\nEntretanto, não foram considerados os mesmos exemplos. Os dados para os exemplos e exercícios propostos foram coletados a partir principalmente de bases de dados brasileiras.\nRobson Bruno Dutra Pereira\n\n\n\n\nHyndman, RJ, and G Athanasopoulos. 2021. Forecasting: Principles and Practice. OTexts. OTexts.com/fpp3."
  },
  {
    "objectID": "ST1.html#introdução-à-previsão-e-séries-temporais",
    "href": "ST1.html#introdução-à-previsão-e-séries-temporais",
    "title": "1  Introdução e gráficos",
    "section": "1.1 Introdução à Previsão e Séries Temporais",
    "text": "1.1 Introdução à Previsão e Séries Temporais\nUma série temporal consiste em um conjunto de observações de uma variável aleatória ordenada no tempo. A Análise de Séries temporais visa o estudo e obtenção de modelos preditivos para este tipo de dados. O objetivo ao final é realizar previsões com o modelo obtido, de forma a viabilizar ações de planejamento, prever cenários e possibilidades.\nA previsão é importante em diversos contextos das engenharias, administração e ciências. Por exemplo, para decidir o nível de produção e planejar o próximo período é importante prever a demanda. Para avaliar se um investimento é viável é importante prever a sua rentabilidade. Para planejamento dos sistemas energéticos é importante prever o consumo de energia. Para prever a capacidade de produção de energia hidroelétrica é preciso prever a precipitação."
  },
  {
    "objectID": "ST1.html#exemplos-de-séries-e-visualizações",
    "href": "ST1.html#exemplos-de-séries-e-visualizações",
    "title": "1  Introdução e gráficos",
    "section": "1.2 Exemplos de séries e visualizações",
    "text": "1.2 Exemplos de séries e visualizações\n\n1.2.1 Séries univariadas\nNa Figura 1.1 observa-se graficamente a série temporal do índice de preços ao consumidor (IPCA), com frequência mensal a partir de 1980. A série foi obtida em http://www.ipeadata.gov.br. As primeiras observações da série também são exibidas na Tabela 1.1. Observa-se claramente como a inflação no país foi controlada a partir da adoção do plano real.\n\n\n\n\nTabela 1.1: IPCA no Brasil\n\n\nindex\nvalue\n\n\n\n\n1980 Feb\n4.62\n\n\n1980 Mar\n6.04\n\n\n1980 Apr\n5.29\n\n\n1980 May\n5.70\n\n\n1980 Jun\n5.31\n\n\n1980 Jul\n5.55\n\n\n\n\n\n\n\n\n\n\n\nFigura 1.1: IPCA no Brasil\n\n\n\n\nPara visualizar melhor como o IPCA variou nos últimos 20 anos, pode-se selecionar os dados a partir do ano 2000. O resultado é plotado na Figura 1.2.\n\n\n\n\n\nFigura 1.2: IPCA no Brasil a partir de 2000\n\n\n\n\nA Tabela 1.2 exibe as primeiras observações da série temporal de volume de carros produzidos no Brasil a partir de 1990. A série foi obtida em https://anfavea.com.br/site/edicoes-em-excel/ e apresenta frequência mensal.\n\n\n\n\nTabela 1.2: Produção de carros no Brasil\n\n\ndata\nvalor\n\n\n\n\n1990-02-01\n57258\n\n\n1990-03-01\n32740\n\n\n1990-04-01\n32812\n\n\n1990-05-01\n58464\n\n\n1990-06-01\n37632\n\n\n1990-07-01\n43697\n\n\n\n\n\n\nA série é plotada na Figura 1.3. Pode-se observar alguns períodos de queda no volume, por exemplo, próximo de 2015 durante a crise política do país e em 2020 durante a pandemia, onde a produção chegou a níveis anteriores aos dos anos 2000.\n\n\n\n\n\nFigura 1.3: Produção de carros no Brasil\n\n\n\n\n\n\n1.2.2 Séries temporais multivariadas\nNa Tabela 1.3 são exibidas apenas as primeiras observações de séries de produção de quatro tipos de energia para o ano de 2023 no Brasil. Os dados são fornecidos em frequência horária e estão disponíveis em https://dados.ons.org.br/group/programacao-da-operacao.\n\n\n\n\nTabela 1.3: Produção de energia no Brasil em 2023\n\n\ndin_instante\nname\nvalue\n\n\n\n\n2023-01-01 00:00:00\nhidraulica\n39057.309\n\n\n2023-01-01 00:00:00\ntermica\n5698.335\n\n\n2023-01-01 00:00:00\neolica\n14138.750\n\n\n2023-01-01 00:00:00\nsolar\n21.155\n\n\n2023-01-01 01:00:00\nhidraulica\n39624.650\n\n\n2023-01-01 01:00:00\ntermica\n5727.550\n\n\n\n\n\n\nA série temporal multivariada é plotada na Figura 1.4. Pode-se observar a queda de produção da fonte hidráulica no período mais seco do ano, além da tendência de aumento da energia solar a partir de maio.\n\n\n\n\n\nFigura 1.4: Produção de energia no Brasil em 2023\n\n\n\n\nOutro exemplo de série multivariada de índices de produção de bens de capital, de consumo duráveis, intermediários e de consumo não duráveis é plotada na Figura 4.5, porém em painéis separados. A série foi obtida em https://www.ibge.gov.br/estatisticas/economicas/industria/9294-pesquisa-industrial-mensal-producao-fisica-brasil?=&t=series-historicas. Essa visualização é útil, uma vez que possibilita avaliar melhor o padrão e variabilidade de cada série, permitindo ajustar a escala de cada série de forma individual.\n\n\n\n\n\nFigura 1.5: Bens de consumo duráveis, intermediários e de consumo não duráveis\n\n\n\n\nAs últimas observações de mais um exemplo de série temporal multivariada são observadas na Tabela 1.4 considerando dados de visualizaçoes de 4 vídeos da playlist Tolerâncias e ajustes do canal da engenharia de manufatura e qualidade.\n\n\n\n\nTabela 1.4: Visualizações de vídeos de tolerâncias e ajustes no youtube\n\n\nDate\nViews\nVideo\n\n\n\n\n2024-09-15\n15\n#4\n\n\n2024-09-16\n35\n#4\n\n\n2024-09-17\n38\n#4\n\n\n2024-09-18\n27\n#4\n\n\n2024-09-19\n40\n#4\n\n\n2024-09-20\n26\n#4\n\n\n\n\n\n\nA série multivariada é plotada na Figura 1.6. A série inicia em 2018, ano de início do canal, porém só tem dados segundo a data de lançamento de cada vídeo.\n\n\n\n\n\nFigura 1.6: Visualizações de vídeos de tolerâncias e ajustes no youtube\n\n\n\n\nA série do vídeo 4 a partir de setembro de 2018 é exibida na Figura 1.7.\n\n\n\n\n\nFigura 1.7: Visualizações do vídeo 4\n\n\n\n\n\n\n1.2.3 Graficos de sazonalidade\nPode-se visualizar os dados da série do vídeo 4 em subséries anuais, de forma a ver a sazonalidade presente nos dados. A Figura 1.8 expõe o gráfico. Os dados foram agregados mensalmente. Pode-se visualizar os picos de visualizações de Abril a Junho e de Setembro a Outubro, coincidindo com períodos de picos de estudos nos dois semestres anuais.\n\n\n\n\n\nFigura 1.8: Gráfico sazonal: Visualizações do vídeo 4\n\n\n\n\nPode-se plotar o gráfico sazonal visualizando a variação anual dentro de cada mês, conforme Figura 1.9.\n\n\n\n\n\nFigura 1.9: Gráfico de subséries sazonais: Visualizações do vídeo 4\n\n\n\n\n\n\n1.2.4 Correlação entre séries\nA Figura 4.6 exibe diagramas de dispersão e correlações aos pares para a série multivaria de produção de bens exposta na Figura Figura 4.5. Pode-se confirmar a alta relação linear entre tais índices, com correlação linear positiva variando de 0,70 a 0,84.\n\n\n\n\n\nFigura 1.10: Bens de consumo duráveis, intermediários e de consumo não duráveis\n\n\n\n\n\n\n1.2.5 Gráficos de decomposição de séries temporais\nA Figura 1.11 apresenta a série temporal de níveis de \\(CO_2\\) na atmosfera medida no Observatório Mauna Loa, Havaí, desde 1958, https://climate.nasa.gov/vital-signs/carbon-dioxide. Observa-se um padrão de crescimento não linear com ciclos sazonais bem definidos.\n\n\n\n\n\nFigura 1.11: Emissões de CO2, Observatório Mauna Loa, Havaí\n\n\n\n\nA Figura 1.12 plota a série a partir de 2020. Pode-se observar que os períodos sazonais de pico coincidem com o início da primavera no hemisfério norte, enquanto os vales são observados no período de crescimento das plantas, as quais capturam parte significativa do \\(CO_2\\) da atmosfera.\n\n\n\n\n\nFigura 1.12: Emissões de CO2, a partir de 2020\n\n\n\n\nO gráfico sazonal também pode ser útil neste caso, conforme Figura 1.13. Observa-se claramente a sazonalidade com pico próximo de maio e declínio próximo de outubro. A tendência de aumento anual de emissões também fica clara na escala de cor que, neste caso, considera o ano.\n\n\n\n\n\nFigura 1.13: Gráfico sazonal de Emissões de CO2\n\n\n\n\nO gráfico de subséries sazonais, plotado na Figura 1.14, também deixa clara a tendência de aumento de emissões desde o início da série, independente do mês e a sazonalidade com pico em maio e vale em outubro.\n\n\n\n\n\nFigura 1.14: Gráfico de subséries sazonais: Emissões de CO2\n\n\n\n\n\n\n1.2.6 Gráficos de decomposição\nExistem diversas formas de decompor séries temporais. A Tabela 1.5 expõe os resultados de uma decomposição aditiva da série CO2. A componente cíclica é removida e o restante é suavizado para encontrar uma tendência. O resíduo consiste na diferença entre a série original e a soma da tendência e da componente sazonal.\n\n\n\n\nTabela 1.5: Decomposição da série de níveis de CO2 na atmosfera\n\n\nCO2\ntrend\nseason_year\nremainder\nseason_adjust\n\n\n\n\n315.71\n314.9477\n1.0263767\n-0.2640423\n314.6836\n\n\n317.45\n315.0187\n2.2221543\n0.2091377\n315.2278\n\n\n317.51\n315.0898\n2.7703197\n-0.3500701\n314.7397\n\n\n317.27\n315.1608\n2.2787986\n-0.1695914\n314.9912\n\n\n315.87\n315.2266\n0.8557299\n-0.2123500\n315.0143\n\n\n314.93\n315.2924\n-1.0241591\n0.6617119\n315.9542\n\n\n\n\n\n\nA Figura 1.15 expõe o resultado da decomposição da série de emissões de CO2. Observa-se claramente a separação da tendência e do padrão sazonal da série, facilitando a interpretação desta.\n\n\n\n\n\nFigura 1.15: Gráficos de decomposição da série de níveis de CO2 na atmosfera\n\n\n\n\n\n\n1.2.7 Gráficos de previsão\nA Figura Figura 4.16 exibe a série de temperatura instantânea na cidade de São joão del-Rei dos dias 15 a 28 de maio. Os dados foram obtidos em https://tempo.inmet.gov.br/TabelaEstacoes/A001. Observa-se que a série plotada em cor preta exibe comportamento cíclico dado a variação diária entre a temperatura mínima, que varia de 8 a 13 ºC, e a máxima diárias, que gira em torno de 25 a 28 ºC no período. Também é possível observar uma tendência de aumento na temperatura nos dias considerados. A Figura expõe a previsão para dois dias à frente em azul, com intervalos de confiança de 80 a 90%.\n\n\n\n\n\nFigura 1.16: Previsão da temperatura em São João del-Rei"
  },
  {
    "objectID": "ST1.html#introdução-às-séries-temporais-e-previsão",
    "href": "ST1.html#introdução-às-séries-temporais-e-previsão",
    "title": "1  Introdução e gráficos",
    "section": "1.1 Introdução às séries temporais e previsão",
    "text": "1.1 Introdução às séries temporais e previsão\nUma série temporal consiste em um conjunto de observações de uma variável aleatória ordenadas no tempo. Uma série temporal pode ser descrita matematicamente como \\(y_1, ..., y_T\\), onde \\(T\\) consiste no último período da série. A análise de séries temporais visa o estudo e obtenção de modelos preditivos para este tipo de dados. O objetivo ao final é realizar previsões com o modelo obtido, de forma a viabilizar ações de planejamento, prever cenários e possibilidades.\nA previsão é importante em diversos contextos das engenharias, administração e ciências. Por exemplo, para decidir o nível de produção e planejar o próximo período é necessário prever a demanda. Para avaliar se um investimento é viável é importante prever a sua rentabilidade. Para planejamento dos sistemas energéticos é importante prever o consumo de energia. Para prever a capacidade de produção de energia hidroelétrica é preciso prever a precipitação.\nNeste curso serão apresentados diversos modelos para análise e previsão de séries temporais, sendo boa parte dos exemplos obtidos de casos brasileiros. Serão consideradas séries de dados de produção, indústria, agricultura, clima, energia, economia, investimentos, mobilidade, transporte, saúde, entre outros."
  },
  {
    "objectID": "ST2.html#estatísiticas-descritivas",
    "href": "ST2.html#estatísiticas-descritivas",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.1 Estatísiticas descritivas",
    "text": "2.1 Estatísiticas descritivas\nAo iniciar-se a avaliação de séries temporais é importante observar agumas setatísticas simples, de forma a compreender a magnitude dos dados, considerando tendência central e distribuição das observações da série.\n\n2.1.1 Estatísticas simples\nA Tabela 2.1 expõe a média e o desvio-padrão para a série multivariada de energia produzida em MWh no Brasil em 2023, segundo cada fonte. Observa-se a superioridade da série hidráulica em relação às demais, confirmando a dependência desta fonte na matriz energética brasileira.\n\n\n\n\nTabela 2.1: Média e desvio-padrão da série multivariada de Energia\n\n\nname\nmean\nsd\n\n\n\n\nsolar\n4909.736\n6929.487\n\n\ntermica\n8250.471\n1886.645\n\n\neolica\n10887.856\n3931.696\n\n\nhidraulica\n50466.854\n11061.858\n\n\n\n\n\n\nA Tabela 2.2 expõe os quartis da mesma série para todas as fontes consideradas. Recordando, os quartis são valores na série que dividem os dados em quatro partes iguais. O primeiro deixa 25% das observações abaixo deste, o segundo ou a mediana deixa 50% das observações abaixo, enquanto o terceiro e último deixa 75% dos dados abaixo. Observa-se também o mínimo (0%) e máximo (100%) de cada série.\n\n\n\n\nTabela 2.2: Média e desvio-padrão da série multivariada de Energia\n\n\nname\n0%\n25%\n50%\n75%\n100%\n\n\n\n\neolica\n692.913\n7975.784\n11133.851\n13983.090\n20166.24\n\n\nhidraulica\n23565.749\n41825.293\n50623.416\n58907.708\n81006.77\n\n\nsolar\n0.237\n4.913\n588.847\n7368.716\n27222.57\n\n\ntermica\n4415.886\n6868.407\n8269.444\n9438.016\n19248.15"
  },
  {
    "objectID": "ST2.html#autocorrelação",
    "href": "ST2.html#autocorrelação",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.2 Autocorrelação",
    "text": "2.2 Autocorrelação\nA autocorrelação é uma estatística importante para avaliar séries temporais. Para avaliar a autocorrelação, deve-se defasar a série e testar a correlação da série original com a série defasada. Para uma defasagem (lag) de uma observação, \\(k= 1\\), calcula-se a correlação \\(r_1\\) entre \\(y_t\\) e \\(y_{t-1}\\). Para uma defasagem de duas observações, \\(k= 2\\), calcula-se a correlação \\(r_2\\) entre \\(y_t\\) e \\(y_{t-2}\\) e assim sucessivamente.\n\\[\nr_k = \\frac{\\sum_{t=k+1}^T (y_t-\\bar{y})(y_{t-k}-\\bar{y})}{\\sum_{t=1}^T (y_t-\\bar{y})^2}\n\\]\nO correlograma consiste no gráfico que plota tais autocorrelações. A Figura Figura 2.1 plota o correlograma da série de níveis de CO2 a partir de 2000.\n\n\n\n\n\nFigura 2.1: Correlograma da série de níveis de CO2\n\n\n\n\nSéries com tendência geralmente apresentam correlações mais altas nas defasagens menores, uma vez que os valores adjacentes na série são próximos. Séries com sazonalidade apresentam autocorrelação alta no período sazonal. Para o caso plotado, pode-se confirmar a presença de tendência e de autocorrelação anual na série.\nA Tabela 2.3 apresenta algumas estatísticas relacionadas à autocorrelação: o primeiro coeficiente de autocorrelação, \\(r_1\\); a soma dos quadrados dos primeiros 10 coeficientes de autocorrelação, \\(\\sum_{k=1}^{10}r_i^2\\); o primeiro coeficiente de correlação da série diferenciada; a soma dos quadrados dos primeiros 10 coeficientes da série diferenciada; o primeiro coeficiente de correlação da série diferenciada com defasagem de duas observações; a soma dos quadrados dos primeiros 10 coeficientes da série diferenciada de duas observações; e o coeficiente de autocorrelação do primeiro lag sazonal, caso a série tenha sazonalidade.\n\n\n\n\nTabela 2.3: Estatísticas relacionadas à autocorrelação\n\n\n\n\n\n\n\n\n\n\n\nacf1\nacf10\ndiff1_acf1\ndiff1_acf10\ndiff2_acf1\ndiff2_acf10\nseason_acf1\n\n\n\n\n0.9875842\n8.525252\n0.6864063\n1.768986\n0.2458201\n0.5501127\n0.8778667\n\n\n\n\n\n\nNa Figura 2.2 são plotadas algumas séries temporais com o correlograma correspondente. A série da Figura 2.2(a) corresponde a um ruído branco (white noise) ou uma sequência de números aleatórios seguindo a distribuição normal. Tal série não apresenta autocorrelação significativa, conforme indica o seu correlograma na Figura 2.2(d). A série da Figura 2.2(b) apresenta padrão cíclico com sazonalidade de 24h, conforme correlograma da Figura 2.2(e). Já a série da Figura 2.2(c) apresenta tendência linear positiva clara com sazonalidade anual, conforme correlograma da Figura 2.2(f).\n\n\n\n\n\nFigura 2.2: Séries e respectivos correlogramas"
  },
  {
    "objectID": "ST2.html#métodos-simples-de-previsão",
    "href": "ST2.html#métodos-simples-de-previsão",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.3 Métodos simples de previsão",
    "text": "2.3 Métodos simples de previsão\n\n2.3.1 Média\nSeja a série histórica \\(y_1, ..., y_T\\). Seja \\(h\\) o número de períodos à frente que se deseja prever. A média pode ser aplicada para previsão de séries temporais, de forma que uma ou mais observações futuras são previstas a partir da média das \\(T\\) observações disponíveis da série.\n\\[\n\\hat{y}_{T+h|T}=\\frac{1}{T}\\sum_{t=1}^Ty_t=\\frac{y_1+y_2+...+y_T}{T}\n\\]\nNa Figura 2.3 expõe-se a previsão com a média para três dias à frente para a série temporal de produção de carros no Brasil.\n\n\n\n\n\nFigura 2.3: Previsão por média na série de produção de carros no Brasil\n\n\n\n\n\n\n2.3.2 Método ingênuo\nO método ingênuo propõe prever as observações futuras como a última observação disponível.\n\\[\n\\hat{y}_{T+h|T}=y_T\n\\]\nNa Figura 2.4 expõe-se a previsão com o método ingênuo para três dias à frente para a série temporal de produção de carros no Brasil.\n\n\n\n\n\nFigura 2.4: Previsão por média na série de produção de carros no Brasil\n\n\n\n\n\n\n2.3.3 Ingênuo sazonal\nO método ingênuo sazonal é indicado para séries muito sazonais e propõe prever as observações futuras iguais aos períodos das estações anteriores, por exemplo mesmo valor do mês do ano anterior. Na formulação dos valores previstos à seguir, \\(m\\) consiste no período sazonal e \\(k\\) é a parte inteira de \\((h-1)/m\\), ou seja, o número completo de anos do período de previsão antes de \\(T+h\\).\n\\[\n\\hat{y}_{T+h|T}=y_{T+h-m(k+1)}\n\\]\nNa Figura 2.5 expõe-se a previsão com o método ingênuo sazonal para três dias à frente para a série temporal de produção de carros no Brasil.\n\n\n\n\n\nFigura 2.5: Previsão por média na série de produção de carros no Brasil\n\n\n\n\nA Figura 2.6 apresenta a série de temperatura instantânea coletada de hora em hora das duas primeiras semanas de maio de 2024 para a cidade de São joão del-Rei. Os dados foram obtidos em https://tempo.inmet.gov.br/TabelaEstacoes/A001. Foram considerados os dados da primeira semana para treinar os modelos, sendo as previsões plotadas para a semana seguinte juntamente com as observações. As previsões obtidas com o método ingênuo sazonal apresentam bom ajuste aos dados.\n\n\n\n\n\nFigura 2.6: Previsão da temperatura em São João del-Rei em Maio de 2024 pelos três métodos benchmarking apresentados\n\n\n\n\n\n\n2.3.4 Deriva\nO método da deriva é uma variação do ingênuo que permite a previsão de observações com tendência de crescimento ou decréscimo segundo a deriva observada entre a primeira e última observação.\n\\[\n\\hat{y}_{T+h|T} = y_T + \\frac{h}{T-1}\\sum_{t=2}^T(y_t-y_{t-1}) =y_T+h \\bigg(\\frac{y_T-y_1}{T-1}\\bigg)\n\\]\nNa Figura 2.7 aplica-se a previsão com o método da deriva para três dias à frente para a série temporal de produção de carros no Brasil.\n\n\n\n\n\nFigura 2.7: Previsão por deriva na série de produção de carros no Brasil"
  },
  {
    "objectID": "ST2.html#resíduos-e-valores-previstos",
    "href": "ST2.html#resíduos-e-valores-previstos",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.4 Resíduos e valores previstos",
    "text": "2.4 Resíduos e valores previstos\nOs valores previstos são denotados por \\(\\hat{y}_{t|t-1}\\), implicando que a previsão de \\(\\hat{y}_{t}\\) é baseada nas observações anteriores, \\(y_1, ..., y_{t-1}\\).\nOs resíduos de uma série temporal consistem nos valores do erro, sendo calculados como a diferença entre o observado e o previsto em cada instante de tempo, \\(e_t=y_t-\\hat{y}_t\\).\nNa Tabela 2.4 são observados os valores previstos (.fitted) e os resíduos (.resid) para as previsões obtidas com o método ingênuo sazonal para o último exemplo para as últimas observações.\n\n\n\n\nTabela 2.4: Valores previstos e residuais obtidos pelo método ingênuo para a série de produção de carros\n\n\nData\nTemp\n.fitted\n.resid\n\n\n\n\n2024-05-07 18:00:00\n27.8\n26.4\n1.4\n\n\n2024-05-07 19:00:00\n27.9\n25.6\n2.3\n\n\n2024-05-07 20:00:00\n25.8\n24.1\n1.7\n\n\n2024-05-07 21:00:00\n23.0\n22.4\n0.6\n\n\n2024-05-07 22:00:00\n20.3\n21.8\n-1.5\n\n\n2024-05-07 23:00:00\n18.8\n20.7\n-1.9\n\n\n\n\n\n\n\n2.4.1 Diagnósticos dos resíduos\nOs resíduos de um modelo de séries temporais devem ser:\n\nNão correlacionados.\nCom média nula.\n\nSe os resíduos forem correlacionados eles apresentaram informações que deveriam ser incorporadas ao modelo, de forma a melhorar as previsões. Se os resíduos apresentam média diferente de zero, o modelo apresenta um viés. O viés pode ser corrigido subtraindo-o das previsões. Já a autocorrelação entre os resíduos tem correção mais trabalhosa, sendo este tema tratado posteriormente.\nÉ interessante, porém não-obrigatório, que os resíduos sejam:\n\nHomocedásticos.\nNormalmente distribuídos.\n\nA homocedasticidade consiste na igualdade de variâncias. Séries com resíduos heterocedásticos podem ser tranformadas, visando obter homocedasticidade e normalidade.\nNa Figura 2.8 é plotada a série histórica de 187 observações do índice Ibovespa, disponível em https://www.infomoney.com.br/cotacoes/b3/indice/ibovespa/historico/.\n\n\n\n\n\nFigura 2.8: Série do índice Ibovespa\n\n\n\n\nA previsão de índices da bolsa é geralmente feita com bom resultado usando o método ingênuo. Neste caso os resíduos serão calculados como a diferença da observação atual e anterior, \\(e_t = y_t - \\hat{y}_t = y_t - y_{t-1}\\). Na Figura 2.9 são plotados os resíduos para tal método. De forma geral estes aparentam apresentar boa distribuição, sem assimetrias e tendência.\n\n\n\n\n\nFigura 2.9: Resíduos da série do índice Ibovespa para o método ingênuo\n\n\n\n\nNa Figura 2.10 é plotado o histograma dos resíduos, o qual aparenta adequar-se bem à distribuição normal.\n\n\n\n\n\nFigura 2.10: Histograma dos resíduos da série do índice Ibovespa\n\n\n\n\nNa Figura 2.11 observa-se o correlograma da série do índice Ibovespa. Pode-se observar que a série é autocorrelacionada considerando defasagem de até 22 observações.\n\n\n\n\n\nFigura 2.11: Correlograma da série do índice Ibovespa\n\n\n\n\nEm sequência, na Figura 2.12, plota-se o correlograma dos resíduos. Pode-se observar que o método ingênuo resultou em resíduos não correlacionados, de forma que o modelo considera toda a informação disponível nos dados. Obviamente podem haver modelos melhores que também garantam a ausência de autocorrelação residual.\n\n\n\n\n\nFigura 2.12: Correlograma dos resíduos da série do índice Ibovespa"
  },
  {
    "objectID": "ST2.html#testes-para-diagnóstico-de-autocorrelação",
    "href": "ST2.html#testes-para-diagnóstico-de-autocorrelação",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.5 Testes para diagnóstico de autocorrelação",
    "text": "2.5 Testes para diagnóstico de autocorrelação\nUm teste portmanteau é um teste para averiguar se as \\(l\\) primeiras autocorrelações são diferentes do que se esperaria para um ruído branco. Um destes testes seria o de Box-Pierce, com estatística calculada conforme segue. Sugere-se \\(l=10\\) autocorrelações para séries não sazonais e \\(l=2m\\) para casos sazonais, com \\(m\\) sendo o período sazonal. Porém, o teste não é adequado para \\(l\\) alto, sugerindo-se no máximo \\(l=T/5\\).\n\\[\nQ = T\\sum_{k=1}^l r_k^2\n\\]\nUm teste mais adequado é o de Ljung-Box, com estatística calculada conforme segue.\n\\[\nQ^* = T(T+2)\\sum_{k=1}^l (T-k)^{-1}r_k^2\n\\]\nEm ambos os casos um alto valor de \\(Q^*\\) (ou \\(Q\\)) sugere que as autocorrelações não vem de um ruído branco. Para decisão, considera-se que \\(Q^*\\) (ou \\(Q\\)) segue a distribuição \\(\\chi^2\\) com \\(l\\) graus de liberdade.\nNa Tabela 2.5 expõe-se o valor \\(Q\\) e \\(Q^*\\) para os resíduos do modelo ingênuo para os dados do índice Ibovespa. Pode-se concluir que, para ambas os testes, as autocorrelações dos resíduos não diferem das de uma série ruído branco.\n\n\n\n\nTabela 2.5: Valores das estatísticas Q e Q* para os resíduos do método ingênuo para o índice Ibovespa\n\n\n\n\n\n\n\n\n\n\nTeste\n.model\nbp_stat\nbp_pvalue\nlb_stat\nlb_pvalue\n\n\n\n\nBox-Pierce (Q)\nNAIVE(FECHAMENTO)\n9.180843\n0.5150314\nNA\nNA\n\n\nLjung-Box (Q*)\nNAIVE(FECHAMENTO)\nNA\nNA\n9.508178\n0.4846474\n\n\n\n\n\n\nO método da deriva é um pouco mais adequado que o ingênuo para séries de índices de bolsas de valores. Na Tabela 2.6 são exibidos os resultados dos testes de Box-Pierce e de Ljung-Box para as autocorrelações residuais de tal método.\n\n\n\n\nTabela 2.6: Valores das estatísticas Q e Q* para os resíduos do método da deriva para o índice Ibovespa\n\n\n\n\n\n\n\n\n\n\nTeste\n.model\nbp_stat\nbp_pvalue\nlb_stat\nlb_pvalue\n\n\n\n\nBox-Pierce (Q)\nRW(FECHAMENTO ~ drift())\n9.180843\n0.5150314\nNA\nNA\n\n\nLjung-Box (Q*)\nRW(FECHAMENTO ~ drift())\nNA\nNA\n9.508178\n0.4846474"
  },
  {
    "objectID": "ST2.html#previsão-e-intervalos-de-confiança",
    "href": "ST2.html#previsão-e-intervalos-de-confiança",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.6 Previsão e intervalos de confiança",
    "text": "2.6 Previsão e intervalos de confiança\nAo se realizar previsões com séries temporais, considera-se um intervalo de confiança para a previsão com nível de probabilidade ou confiança de interesse. Para por exemplo um intervalo de previsão de 95% os valores obtidos consistem nos limites que garantem que o valor previsto está entre eles com 95% de confiança.\nUm intervalo de previsão para \\(h\\) passos à frente com 95% de confiança pode ser calculado conforme segue.\n\\[\n\\hat{y}_{T+h|T} \\pm1,96 \\hat\\sigma_h,\n\\]\nonde \\(1,96\\) consiste no valor do quantil na distribuição normal-padrão \\(z\\), com 0,95 de probabilidade ou confiança. Obviamente, caso seja desejado um intervalo com nível de confiança diferente, deve-se selecionar o valor \\(z\\) adequado.\nO desvio-padrão para previsões com \\(h=1\\) (um passo a frente) pode ser calculado como o desvio-padrão dos resíduos, onde \\(K\\) é o número de parâmetros do modelo e \\(M\\) o número de valores ausentes nos resíduos (para o método ingênuo e o da deriva, por exemplo, \\(M=1\\), uma vez que a primeira observação não pode ser estimada).\n\\[\n\\hat\\sigma = \\sqrt{\\frac{1}{T-K-M}\\sum_{t=1}^T e_t^2}\n\\]\nPara previsões com \\(h&gt;1\\) a estimativa de \\(\\sigma_h\\) é mais complexa. A Tabela 2.7 expõe as Equações para estimar o desvio-padrão para os métodos benchmarking até aqui expostos, onde \\(m\\) é o período sazonal e \\(k\\) consiste na parte inteira de \\((h−1)/m\\).\n\n\nTabela 2.7: Desvio-padrão para previsão para os métodos considerados\n\n\nMétodo\ndesvio-padrão para \\(h\\) previsões\n\n\n\n\nMédia\n\\(\\hat\\sigma_h = \\hat\\sigma\\sqrt{1+1/T}\\)\n\n\nIngênuo\n\\(\\hat\\sigma_h = \\hat\\sigma\\sqrt{h}\\)\n\n\nIngênuo sazonal\n\\(\\hat\\sigma_h = \\hat\\sigma\\sqrt{k+1}\\)\n\n\nDeriva\n\\(\\hat\\sigma_h = \\hat\\sigma\\sqrt{h(1+h/(T-1))}\\)\n\n\n\n\nNa Tabela 2.8 são apresentados os intervalos de confiança de 80 e 95% para \\(h=10\\) períodos para o índice Ibovespa.\n\n\n\n\nTabela 2.8: Intervalo de previsão para a série do índice Ibovespa\n\n\n\n\n\n\n\n\n\n\n.model\nDATA\nFECHAMENTO\n.mean\n80%\n95%\n\n\n\n\nRW(FECHAMENTO ~ drift())\n188\nN(133, 0.91)\n132.7030\n[131.4798, 133.9262]80\n[130.8322, 134.5737]95\n\n\nRW(FECHAMENTO ~ drift())\n189\nN(133, 1.8)\n132.7089\n[130.9744, 134.4435]80\n[130.0562, 135.3616]95\n\n\nRW(FECHAMENTO ~ drift())\n190\nN(133, 2.8)\n132.7149\n[130.5849, 134.8449]80\n[129.4574, 135.9724]95\n\n\nRW(FECHAMENTO ~ drift())\n191\nN(133, 3.7)\n132.7209\n[130.2549, 135.1869]80\n[128.9495, 136.4923]95\n\n\nRW(FECHAMENTO ~ drift())\n192\nN(133, 4.7)\n132.7269\n[129.9626, 135.4912]80\n[128.4992, 136.9545]95\n\n\nRW(FECHAMENTO ~ drift())\n193\nN(133, 5.6)\n132.7328\n[129.6968, 135.7689]80\n[128.0896, 137.3761]95\n\n\nRW(FECHAMENTO ~ drift())\n194\nN(133, 6.6)\n132.7388\n[129.4510, 136.0266]80\n[127.7105, 137.7671]95\n\n\nRW(FECHAMENTO ~ drift())\n195\nN(133, 7.6)\n132.7448\n[129.2209, 136.2687]80\n[127.3554, 138.1342]95\n\n\nRW(FECHAMENTO ~ drift())\n196\nN(133, 8.6)\n132.7508\n[129.0034, 136.4981]80\n[127.0197, 138.4818]95\n\n\nRW(FECHAMENTO ~ drift())\n197\nN(133, 9.5)\n132.7567\n[128.7966, 136.7169]80\n[126.7002, 138.8132]95\n\n\n\n\n\n\nA Figura 2.13 plota tais intervalos juntamente com a série.\n\n\n\n\n\nFigura 2.13: Intervalo de previsão para a série do índice Ibovespa"
  },
  {
    "objectID": "ST2.html#transformações",
    "href": "ST2.html#transformações",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.7 Transformações",
    "text": "2.7 Transformações\nTransformações podem ser usadas nas séries temporais, de forma a garantir, por exemplo, que as pressuposições sobre os resíduos sejam cumpridas, ou que alguma variação que aumenta ou cresce com o tempo seja corrigida. A transformação logarítima é geralmente útil. Tomando a série original, \\(y_1, y_2, ..., y_T\\), a série transformada fica \\(w_1, w_2, ..., w_T\\), com \\(w_t =log(y_t)\\). Uma mudança de uma unidade na escala log de base 10 corresponde a uma multiplicação por 10 na escala original.\nOutras transformações podem ser mais interessantes em alguns casos, porém nem sempre de fácil interpretação, por exemplo as transfoprmações de potência, \\(w_t = y_t^p\\). A transformação de Box-Cox envolve ambos logarítmo e potência, conforme segue.\n\\[\nw_t = \\Bigg\\{ \\begin{matrix}\n                \\text{log}(y_t), \\text{ }\\lambda=0 \\\\\n                (\\text{sign}(y_t)|y_t|^\\lambda-1)/\\lambda, \\text{ }\\lambda&gt;0\n             \\end{matrix}\n\\]\nonde \\(\\text{sign}(y_t) = 1\\) se \\(y\\geq0\\) e \\(\\text{sign}(y_t) =-1\\), caso contrário.\nNa Figura 2.14 apresenta-se graficamente a série temporal das ações da vale (VALE3), https://br.investing.com/equities/vale-on-n1-historical-data. Pode-se observar que a série apresenta alta variabilidade, especialmente de 2021 a 2023.\n\n\n\n\n\nFigura 2.14: Série temporal do valor da ação VALE3\n\n\n\n\nNa Figura 2.15 apresenta-se a mesma série após transformação de Box-Cox com \\(\\lambda = 1,27\\).\n\n\n\n\n\nFigura 2.15: Série temporal do valor da ação VALE3 com transformação de Box-Cox"
  },
  {
    "objectID": "ST2.html#avaliação-de-modelos-de-séries-temporais",
    "href": "ST2.html#avaliação-de-modelos-de-séries-temporais",
    "title": "2  Análise descritiva, métodos simples de previsão e diagnóstico",
    "section": "2.8 Avaliação de modelos de séries temporais",
    "text": "2.8 Avaliação de modelos de séries temporais\nUma avaliação ideal de um modelo de séries temporais deve ser baseada no desempenho do modelo em novos dados e não nos valores residuais. Para tal, deve-se considerar dados separados para teste do modelo ou em dados futuros. Portanto, não se deve considerar os dados usados para estimar (treinar) o modelo para avaliar seu desempenho.\nConforme visto no caso para dados de temperatura instantânea para São João del-Rei, uma primeira abordagem consiste em simplesmente usar parte inicial da série para treino do modelo e as últimas observações para teste. O percentual de observações usadas para treino/teste depende do número de observações disponíveis na série.\nNa Figura 2.16 ilustra-se arbitrariamente a separação das primeiras 75% observações para treino e os 25% restantes para teste.\n\n\n\n\n\nFigura 2.16: Observações de treino e teste para validar séries temporais\n\n\n\n\nO erro de previsão (não confundir com resíduo) é calculado conforme segue, onde \\(y_1,...,y_T\\) são os dados de treino e \\(y_{T+1}, y_{T+2}, ...\\) de teste.\n\\[\ne_{T+h} = y_{T+h} - \\hat{y}_{T+h|T}\n\\]\nO desempenho do modelo pode ser medido por diversas métricas. A Tabela 2.10 apresenta as principais métricas de ajuste. O erro médio absuluto (mean absolute error - MAE) e a raiz da média dos quadrados dos erros (root mean square error - RMSE) são medidos na mesma escala da variável da série. O MAE é menos suscetível a outliers e ambos devem ser minimizados. O erro percentual médio absuluto (mean absolute percentage error - MAPE) tem a vantagem de ser livre de escala, permitindo a comparação de séries distintas.\n\n\nTabela 2.9: Métricas de erro\n\n\nMétrica\nFórmula\n\n\n\n\nMAE\n\\(\\text{MAE = mean}(|e_t|)\\)\n\n\nRMSE\n\\(\\text{RMSE = }\\sqrt{\\text{mean}(e_t^2)}\\)\n\n\nMAPE\n\\(\\text{MAPE = mean}(|p_t|)\\), \\(p_t = 100e_t/y_t\\)\n\n\nMASE\n\\(\\text{MAE = mean}(|q_j|)\\)\n\n\n\n\nAs métricas com o erro padronizado, \\(q_j\\), são alternativais ao MAPE para comparar desempenho em séries distintas. Elas consideram a escala dos dados de treino para tal. A fórmula à seguir é usada para padronizar os erros. Em séries sazonais substitui-se \\(T-1\\) por \\(T-m\\), onde \\(m\\) é o período sazonal. O MASE na tabela acima considera tal padronização.\n\\[\nq_j = \\frac{e_j}{\\frac{1}{T-1}\\sum_{t+2}^T |y_t-y_{t-1}|}\n\\]\nA Tabela 2.10 expõe o desempenho dos três métodos considerados nos dados de temperatura instantânea de São João-del-Rei. O método ingênuo sazonal para esta série foi o que apresentou melhor ajuste.\n\n\n\n\nTabela 2.10: Valores das estatísticas Q e Q* para os resíduos do método da deriva para o índice Ibovespa\n\n\n.model\nRMSE\nMAE\nMAPE\n\n\n\n\nIngenuo\n5.923621\n4.980952\n23.721859\n\n\nIngenuo sazonal\n1.700928\n1.405357\n8.140928\n\n\nmedia\n5.697090\n5.171627\n27.555762"
  },
  {
    "objectID": "ST3.html#decomposição",
    "href": "ST3.html#decomposição",
    "title": "3  Decomposição de séries temporais",
    "section": "3.1 Decomposição",
    "text": "3.1 Decomposição\nAs séries temporais exibem comportamentos variados. A decomposição destas pode facilitar a análise e previsão. Geralmente considera-se a tendência, sazonalidade e o resto na decomposição, havendo vários métodos para separar tais componentes. Antes, porém, são importantes algumas considerações sobre tratamentos iniciais às vezes necessários.\n\n3.1.1 Ajustes e transformações\nAlguns ajustes são comumente necessários antes de realizar a decomposição de uma série temporal. Por exemplo, em alguns casos é importante corrigir a sazonalidades devido à diferenças de calendário. Em séries que exibem alguma variável com frequência mensal, pode haver alguma sazonalidade nos meses com número menor de dias, sendo interessante talvez trabalhar com a média mensal, dividindo a variável pelo número de dias de cada mês.\nDados relacionados à população também podem ser ajustados per capita, ou por pessoa. Este ajuste é muito comum no PIB e em outras variáveis econômicas, por exemplo. Em séries relacionadas a disponibilidade de algum serviço para a população é mais fácil avaliar a disponibilidade ajustando os dados por mil pessoas, por exemplo, de forma a eliminar o efeito do crescimento populacional. O mesmo pode ser feito para séries de saúde pública, por exemplo de número de pessoas infectadas ou a mortalidade pode ser dividida por 1000 ou 100 mil, dependendo da ordem de grandeza de cada série, de forma a viabilizar comparação entre populações de localidades distintas. Em séries econômicas às vezes é importante considerar a inflação, de forma a dar uma dimensão real da série, permitindo comparação em diferentes momentos. Para deflacionar uma série basta dividí-la pelo deflator, um índice que corrige a inflação.\nTransformações como a de Box-Cox ou outra mais simples também podem ser úteis para facilitar o tratamento da série. Conforme visto anteriormente, uma série que exibe uma variação sazonal não constante, ou heterocedástica, ao ser transformada pode exibir um padrão de sazonalidade de mais fácil decomposição ou tratamento.\nA série plotada na Figura 3.1 consiste na produção mensal de gás natural no Brasil a partir os anos 2000. A série está disponível em https://www.gov.br/anp/pt-br/centrais-de-conteudo/dados-estatisticos.\n\n\n\n\n\nFigura 3.1: Produção mensal de gás natural no Brasil\n\n\n\n\nA Figura 3.2 plota novamente a série considerando a normalização por número de dias no mês.\n\n\n\n\n\nFigura 3.2: Produção mensal de gás natural no Brasil\n\n\n\n\nA série normalizada é submetida a uma transformação de Box-Cox de forma a corrigir a heterocedasticidade, com \\(\\lambda=-0.06\\), sendo o resultado plotado na Figura 3.3.\n\n\n\n\n\nFigura 3.3: Produção mensal de gás natural no Brasil com transformação de Box-Cox"
  },
  {
    "objectID": "ST3.html#componentes-de-uma-série",
    "href": "ST3.html#componentes-de-uma-série",
    "title": "3  Decomposição de séries temporais",
    "section": "3.2 Componentes de uma série",
    "text": "3.2 Componentes de uma série\nAssumindo uma decomposição aditiva, pode-se escrever:\n\\[\ny_t = S_t+ T_t+R_t,\n\\]\nonde \\(S_t\\) é a componente sazonal, \\(T_t\\) é a tendência e \\(R_t\\) é o resto no período \\(t\\). No caso multiplicativo tem-se:\n\\[\ny_t = S_t \\times T_t \\times R_t\n\\]\nO caso multiplicativo é ideal quando a variação em séries sazonais muda com o tempo, seguindo padrão heterocedástico.\nA série plotada na Figura 3.4 exibe o índice de produção física mensal de bens intermediários, ou seja, aqueles empregados na produção de produtos finais, tais como produtos minerais, produtos metalúrgicos, têxteis, papel e celulose, produtos químicos, borracha, plásticos, componentes elétricos e eletrônicos. A série está disponível em https://www.ibge.gov.br/estatisticas/economicas/industria.html.\n\n\n\n\n\nFigura 3.4: Produção mensal de produtos intermediários no Brasil\n\n\n\n\nA sequer exibem-se as primeiras linhas das componentes da série, considerando a decomposição aditiva.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nname\n.model\nData\nvalue\ntrend\nseason_year\nremainder\nseason_adjust\n\n\n\n\nintermediarios\nstl\n2002 Jan\n87.97245\n95.10887\n-7.0894994\n-0.0469214\n95.06195\n\n\nintermediarios\nstl\n2002 Feb\n85.22869\n95.33164\n-11.1630761\n1.0601292\n96.39177\n\n\nintermediarios\nstl\n2002 Mar\n94.94150\n95.55440\n0.8473573\n-1.4602601\n94.09414\n\n\nintermediarios\nstl\n2002 Apr\n96.00238\n95.77717\n-2.0387398\n2.2639509\n98.04112\n\n\nintermediarios\nstl\n2002 May\n99.12757\n95.99987\n3.8247141\n-0.6970134\n95.30286\n\n\nintermediarios\nstl\n2002 Jun\n97.15759\n96.22257\n1.7226365\n-0.7876163\n95.43495\n\n\n\n\n\nA série é plotada novamente na Figura 3.5 com a tendência em destaque. Observam-se dois períodos de queda mais acentuada relativos à crise de 2008/2009 e à pandemia de COVID-19.\n\n\n\n\n\nFigura 3.5: Produção mensal de produtos intermediários no Brasil com tendência em destaque\n\n\n\n\nAs componentes são plotadas separadamente na Figura 3.6.\n\n\n\n\n\nFigura 3.6: Componentes da série de produtos intermediários"
  },
  {
    "objectID": "ST3.html#dados-com-sazonalidade-ajustada",
    "href": "ST3.html#dados-com-sazonalidade-ajustada",
    "title": "3  Decomposição de séries temporais",
    "section": "3.3 Dados com sazonalidade ajustada",
    "text": "3.3 Dados com sazonalidade ajustada\nPode ser útil remover a sazonalidade da série, resultando em uma série com sazonalidade ajustada. Para casos aditivos a série resultante seria dada por \\(y_t-S_t\\), enquanto que para casos multiplicativos seria \\(y_t/S_t\\).\nNa Figura 3.7 plota-se a série de produtos intermediários ajustada sazonalmente.\n\n\n\n\n\nFigura 3.7: Série de produtos intermediários com ajuste da sazonalidade"
  },
  {
    "objectID": "ST3.html#média-móvel",
    "href": "ST3.html#média-móvel",
    "title": "3  Decomposição de séries temporais",
    "section": "3.4 Média móvel",
    "text": "3.4 Média móvel\nUm dos métodos clássicos para estimar a tendência é a média móvel. Uma média móvel de ordem \\(m\\) pode ser escrita como segue.\n\\[\n\\hat{T}_t=\\frac{1}{m}\\sum_{j=-k}^{k} y_{t+j}\n\\]\nDenota-se uma média móvel como \\(m\\)-MA, ou média móvel de ordem \\(m\\). A título de exemplo seja a série \\(5,10,12,20,23,27\\). Considerando \\(k = 2\\), tem-se uma média móvel de ordem \\(m=5\\), 5-MA. Para este caso, seguem os cálculos das médias móveis para a terceira e quarta observações, \\(t=3,4\\). Observa-se que o \\(k\\) determina o número de observações não suavizadas no ínico e fim da série.\n\\[\n\\hat{T}_3=\\frac{1}{2\\times2+1}(5+10+12+20+23)=14\n\\]\n\\[\n\\hat{T}_4=\\frac{1}{2\\times2+1}(10+12+20+23+27)=18,4\n\\]\nNa Figura 3.8 observa-se graficamente a média móvel com diferentes ordens, para a série de volume de carros produzidos no Brasil. Quando maior a ordem da série, mais suave o resultado.\n\n\n\n\n\nFigura 3.8: Média móvel para a série de carros produzidos com distintas defasagens\n\n\n\n\nÉ interessante em alguns casos realizar a média móvel de uma média móvel, com o objetivo final de centrar médias móveis pares. Uma média móvel \\(2\\times4\\)-MA consiste em uma média móvel \\(4\\)-MA seguida de uma \\(2\\)-MA.\nPor exemplo, para a série da Tabela 3.1 o problema da média móvel \\(4\\)-MA é que ela não é simétrica em relação à série original, tendo uma observação não estimada no início e duas no final. Ao tomar desta série resultante uma média móvel de ordem \\(2\\)-MA, resultando na \\(2\\times4\\)-MA, tem-se uma série média móvel simétrica com a original, com duas observações ausentes no início e fim.\n\n\nTabela 3.1: \\(2\\times4\\)-MA\n\n\nSérie\n\\(4\\)-MA\n\\(2\\times4\\)-MA\n\n\n\n\n5\n\n\n\n\n10\n11,75\n\n\n\n12\n16,25\n14\n\n\n20\n20,5\n18,375\n\n\n23\n25\n22,75\n\n\n27\n\n\n\n\n30"
  },
  {
    "objectID": "ST3.html#estimando-a-tendência-com-dados-sazonais",
    "href": "ST3.html#estimando-a-tendência-com-dados-sazonais",
    "title": "3  Decomposição de séries temporais",
    "section": "3.5 Estimando a tendência com dados sazonais",
    "text": "3.5 Estimando a tendência com dados sazonais\nAo realizar uma média móvel \\(2\\times4\\)-MA, a estimativa feita ao final fica conforme a Equação abaixo, consistindo em uma média ponderada.\n\\[\n\\hat{T}_t=\\frac{1}{8}y_{t-2}+\\frac{1}{4}y_{t-1}+\\frac{1}{4}y_{t}+\\frac{1}{4}y_{t+1}+\\frac{1}{8}y_{t+2}\n\\]\nEste modelo pode ser usado para estimar tendência de séries com sazonalidade quadrimestral, por exemplo. Recomenda-se usar uma média móvel de ordem \\(2\\times m\\)-MA para estimar a tendência de uma série com sazonalidade de ordem \\(m\\).\nNa Figura 3.9 observa-se novamente a série de índice de produção de itens intermediários plotada sazonalmente. Como ficou clara a sazonalidade anual, pode-se pensar na suavização de ordem \\(2\\times 12\\)-MA.\n\n\n\n\n\nFigura 3.9: Gráfico sazonal da série de produtos intermediários\n\n\n\n\nA Figura 3.10 exibe a série do índice de produção de produtos intermediários com média móvel \\(2\\times 12\\)-MA. Pode-se confirmar que a sazonalidade foi eliminada. A tendência estimada é muito similar à obtida anteriormente com método mais sofisticado.\n\n\n\n\n\nFigura 3.10: Tendência para a série de produtos intermediários estimada com média móvel"
  },
  {
    "objectID": "ST3.html#decomposição-clássica",
    "href": "ST3.html#decomposição-clássica",
    "title": "3  Decomposição de séries temporais",
    "section": "3.6 Decomposição clássica",
    "text": "3.6 Decomposição clássica\nA decomposição clássica tem um século de tradição e é o primeiro método para tal. Ela contempla a forma aditiva e a multiplicativa. A seguir são expostos os passos para a decomposição aditiva:\n\nSe o período sazonal, \\(m\\), é par, estime a tendência \\(\\hat{T}_t\\) como uma média móvel \\(2\\times m\\)-MA. Se \\(m\\) é ímpar, estime a tendência com uma média móvel \\(m\\)-MA.\nCalcule a série sem a tendência, \\(y_t - \\hat{T}_t\\).\nCalcule a componente sazonal para cada estação como a média de todos os períodos desta. Por exemplo, para uma série com sazonalidade anual. O mês de janeiro terá como valor de \\(\\hat{S}_t\\) a média de todas as observações de janeiro. O procedimento é realizado para todos os meses.\nCalcule o resto tomando a diferença da série em relação à tendência a sazonalidade, \\(\\hat{R}_t=y_t - \\hat{T}_t - \\hat{S}_t\\).\n\nA Figura 3.11 expõe o resultado gráfico da decomposição clássica da série de produtos intermediários. Pode-se observar que neste caso a sazonalidade é constante, diferente do resultado óbtido com método mais sofisticado.\n\n\n\n\n\nFigura 3.11: Decomposição clássica da série de produtos intermediários\n\n\n\n\nPassos para a decomposição multiplicativa.\n\nSe o período sazonal, \\(m\\), é par, estime a tendência \\(\\hat{T}_t\\) como uma média móvel \\(2\\times m\\)-MA. Se \\(m\\) é ímpar, estime a tendência com uma média móvel \\(m\\)-MA.\nCalcule a série sem a tendência, \\(y_t / \\hat{T}_t\\).\nCalcule a componente sazonal para cada estação como a média de todos os períodos desta. Por exemplo, para uma série com sazonalidade anual. O mês de janeiro terá como valor de \\(\\hat{S}_t\\) a média de todas as observações de janeiro. O procedimento é realizado para todos os meses.\nCalcule o resto tomando a razão da série em relação à tendência e à sazonalidade, \\(\\hat{R}_t=y_t / (\\hat{T}_t \\times \\hat{S}_t)\\).\n\nA Figura 3.12 plota o número de passageiros em vôos no Brasil, disponível em https://www.anac.gov.br/acesso-a-informacao/dados-abertos/areas-de-atuacao/todos-os-dados-abertos.\n\n\n\n\n\nFigura 3.12: Série de passageiros de vôos no Brasil\n\n\n\n\nObserva-se na Figura 3.13 sazonalidade anual com picos nos períodos de férias escolares, em Julho e Dezembro/Janeiro.\n\n\n\n\n\nFigura 3.13: Gráfico sazonal da série de passageiros de vôos no Brasil\n\n\n\n\nA Figura 3.14 expõe o resultado gráfico da decomposição clássica multiplicativa da série de passageiros em vôos no Brasil.\n\n\n\n\n\nFigura 3.14: Decomposição clássica multiplicativa da série de passageiros de vôos no Brasil"
  },
  {
    "objectID": "ST3.html#métodos-usados-por-agências-de-estatística",
    "href": "ST3.html#métodos-usados-por-agências-de-estatística",
    "title": "3  Decomposição de séries temporais",
    "section": "3.7 Métodos usados por agências de estatística",
    "text": "3.7 Métodos usados por agências de estatística\nO método X-11 é discutido em Dagum & Bianconcini (2016). Possibilita a decomposição aditiva e a multiplicativa, é robusto a altas variações e outliers e a estimativa de tendência é disponível em toda série. O método também captura outras formas de sazonalidade e feriados.\nA Figura 3.15 exibe o resultado da decomposição aditiva pelo método X-11 na série do índice de produção de produtos intermediários.\n\n\n\n\n\nFigura 3.15: Decomposição da série de produtos intermediários via X-11\n\n\n\n\nO método SEATS consiste em uma decomposição sazonal de séries temporais por ARIMA (ARIMA será discutida futuramente) e foi proposto pelo Banco da Espanha. A Figura 3.16 expõe o resultado gráfico do método SEATS para decompor a série de passageiros em vôos do Brasil.\n\n\n\n\n\nFigura 3.16: Decomposição da série de produtos intermediários via SEATS\n\n\n\n\n\n3.7.1 Decomposição via STL\nA sigla STL significa Seasonal and Trend decomposition using Loess”* que em português seria decomposição de tendência e sazonalidade usando LOESS, enquanto LOESS é um método de regressão não linear, locally estimated scatterplot smoothing, ou em tradução livre suavização por regressão local.\nO método STL apresenta diversas vantagens em relação aos anteriores:\n\nTrata qualquer tipo de sazonalidade;\nA componente sazonal pode mudar com o tempo;\nA suavização da tendência pode ser controlada pelo usuário;\nPode ser robusto a outliers (há uma opção para tal), de forma que desvios não usuáis não afetarão a tendência e ciclo, mas o resto.\n\nO método, entretanto, tem algumas limitações. As possibilidades elencadas são disponíveis apenas para decomposições aditivas. Para casos multiplicativs, recomenda-se trasnformar a série via logaritmo e depois fazer a decomposição aditiva.\nA Figura 3.17 expõe os gráficos da decomposição do logarítmo da série de passageiros em vôos do Brasil.\n\n\n\n\n\nFigura 3.17: Decomposição da série log(passageiros) em vôos no Brasil via STL\n\n\n\n\n\n\n3.7.2 Previsão via decomposição\nA Figura Figura 3.18 apresenta a previsão via decomposição para o caso anterior. Foi considerado até o ano de 2018 para treinamento e pode-se observar a previsão para 2019 e 2020 junto com as observações disponíveis.\n\n\n\n\n\nFigura 3.18: Previsão via decomposição da série de log(passageiros) de vôos no Brasil\n\n\n\n\nA Figura 3.19 apresenta os resíduos obtidos da decomposição para o caso anterior. Observa-se que apresentam boa aderência à normal e sem presença de autocorrelação.\n\n\n\n\n\nFigura 3.19: Resíduos do modelo obtido via decomposição por STL da série de log(passageiros)"
  },
  {
    "objectID": "ST4.html#previsão",
    "href": "ST4.html#previsão",
    "title": "4  Regressão de séries temporais",
    "section": "4.7 Previsão",
    "text": "4.7 Previsão\nA previsão à frente não é geralmente possível quando se considera outras séries como preditores uma vez que não se conhece os valores futuros das séries. Por exemplo, no último caso do petróleo e derivados, os derivados vêm depois, sendo mais útil para previsão do volume refinado um modelo que considere ou a decomposição ou outros métodos mais sofisticados ainda não abordados, os quais levam em conta a autocorrelação da série. Entretanto, nos casos de regressão onde se utiliza como preditores a tendência e a sazonalidade a partir de variáveis dummy, é possível realizar a previsão à frente. A Figura Figura 4.16 expõe a previsão de dois dias à frente para a temperatura de São joão del-Rei utilizando o modelo anteriormente obtido.\n\n\n\n\n\nFigura 4.16: Previsão da temperatura em São João del-Rei\n\n\n\n\nApesar de não ser possível realizar previsões à frente para casos de regressão considerando outras séries temporais como preditores, é possível realizar nestes casos previsões baseadas em cenários. Seja o caso exposto anteriormente onde deseja-se prever o índice de produção de bens de consumo duráveis em função dos bens de capital e intermediários. A Figura 4.17 expõe a previsão para dois cenários, um de aumento e outro de decréscimo nos índices de produção de bens de capital e intermediários. Este tipo de análise pode ser útil para adiantar possíveis cenários e viabilizar ações de planejamento.\n\n\n\n\n\nFigura 4.17: Previsão de cenários para produção de bens de capital"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Gardner, Everette S., and Ed. Mckenzie. 1985. “Forecasting Trends\nin Time Series.” Management Science 31 (10): 1237–46. https://doi.org/10.1287/mnsc.31.10.1237.\n\n\nHolt, Charles C. 2004. “Forecasting Seasonals and Trends by\nExponentially Weighted Moving Averages.” International\nJournal of Forecasting 20 (1): 5–10. https://doi.org/https://doi.org/10.1016/j.ijforecast.2003.09.015.\n\n\nHyndman, RJ, and G Athanasopoulos. 2021. Forecasting: Principles and\nPractice. OTexts. OTexts.com/fpp3.\n\n\nHyndman, Rob, Anne B Koehler, J Keith Ord, and Ralph D Snyder. 2008.\nForecasting with Exponential Smoothing: The State Space\nApproach. Springer Science & Business Media.\n\n\nWinters, Peter R. 1960. “Forecasting Sales by Exponentially\nWeighted Moving Averages.” Management Science 6 (3):\n324–42. https://doi.org/10.1287/mnsc.6.3.324."
  },
  {
    "objectID": "ST4.html#regressão-não-linear",
    "href": "ST4.html#regressão-não-linear",
    "title": "4  Regressão de séries temporais",
    "section": "4.8 Regressão não linear",
    "text": "4.8 Regressão não linear\nTrasnformações podem ser interessantes para tratar a não lineariedade na série a ser predita e nas preditoras. Há muitos casos que a tendência observada em uma série não é linear. Nestes casos podem ser considerada transformação polinomial na tendência.\nUma opção interessante em alguns casos é utilizar transformação logarítimica em ambas séries independentes e dependente ou em apenas uma destas. Para o caso simples, com transformação em ambas as séries, tem-se o seguinte modelo.\n\\[\n\\text{log} (y_t) = \\beta_0+\\beta_1\\text{log} (x_t)\n\\]\nPode-se pensar em considerar um termo quadrático ou de ordem maior para a tendência, de forma a contemplar uma tendência não linear. Entretanto não se recomenda tal estratégia, uma vez que na maioria dos casos a previsão resultante extrapola muito a realidade.\n\\[\n\\hat{y}_t = \\beta_0+\\beta_{1}t+\\beta_{2}t^2\n\\]\nUma abordagem mais interessante é pensar em modelos lineares por partes, de forma a considerar modelos lineares distintos em cada parte do horizonte temporal da série, consistindo em um modelo não linear formado por peças lineares (piecewise regression). Por exemplo, um modelo com uma divisão no tempo, \\(\\tau\\), ´pode ser descrito conforme segue:\n\\[\n\\hat{y}_t = \\beta_0+\\beta_{1}t+\\beta_{2}(t-\\tau)_+,\n\\] onde:\n\\[\n(t-\\tau)_+ = \\bigg\\{\n\\begin{align} 0 \\text{, se } t&lt; \\tau \\\\\n              t-\\tau \\text{, se } t\\geq \\tau\n\\end{align}\n\\]\nA Figura 4.18 expõe a série temporal da evolução do recorde na prova de 100m nado peito na categoria masculina. Pode-se observar que de 1960 até 1980 o melhor tempo diminuiu com maior intensidade, passando para outro padrão de variação de 1980 a 2000 e, posteriormente, de 2000 até aqui com outra tendência.\n\n\n\n\n\nFigura 4.18: Evolução do recorde na prova de nado peito, 100m, masculino\n\n\n\n\nA Figura 4.19 expõe a mesma série com três modelos, um com transformação logarítimica na resposta, resultando em um modelo exponencial, um linear e outro linear por partes (piecewise). Foram consideradas duas partições, em 1977 e 2000. Pode-se observar que o terceiro caso parece interessante para ajustar-se melhor em cada momento considerado da série.\n\n\n\n\n\nFigura 4.19: Evolução do record na prova de nado peito, 100m, masculino com modelos não lineares"
  },
  {
    "objectID": "ST1.html#implementação-em-r",
    "href": "ST1.html#implementação-em-r",
    "title": "1  Introdução e gráficos",
    "section": "1.3 Implementação em R",
    "text": "1.3 Implementação em R\nA seguir apresenta-se boa parte da implementação na linguagem R para obter os dados, gráficos e análises expostos no presente capítulo. Os dados utilizados estão disponíveis em https://github.com/robsonpro/Previsao.\nCarregando pacotes.\n\nlibrary(rbcb)\nlibrary(forecast)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(lubridate)\nlibrary(fpp3)\nlibrary(GGally)\ntheme_set(theme_bw())\n\nSérie temporal do IPCA obtida usando o pacote rbcb.\n\nipca &lt;- get_series(c(IPCA = 433), as = \"ts\")\n\nipca_ts &lt;- as_tsibble(ipca, index = index)\n\nhead(ipca_ts)\n\nVisualizando a série.\n\nipca_ts |&gt;\n  autoplot(value) + labs(x=\"\", y=\"IPCA\", \n                         title=\"IPCA no Brasil\")\n\nVizualizando a série a partir de 2020.\n\nipca_ts |&gt;\n  filter(year(index) &gt;= 2020) |&gt;\n  autoplot(value) + \n  labs(x=\"\", y=\"IPCA\", \n       title=\"IPCA no Brasil a partir de 2020\")\n\nSérie de volume de produção de carros no Brasil.\n\ncarros &lt;- read.csv(\"vendas_veiculos.csv\", \n                   sep=\";\")\n\ncarros_ts &lt;- carros |&gt;\n  mutate(data = as.Date(data, format = \"%d/%m/%Y\")) |&gt;\n  as_tsibble(index=data)\n\nhead(carros_ts)\n\nVisualizando a série.\n\ncarros_ts |&gt;\n  autoplot(valor) +\n  labs(x=\"\", y=\"Carros produzidos\",\n       title=\"Produção de carros no Brasil\")\n\nSérie multivariada de produção de energia em 2023 no Brasil.\n\nenergia_2023 &lt;- read.csv(\"BALANCO_ENERGIA_SUBSISTEMA_2023.csv\",\n                         header=T, sep=\";\")\n\n\nenergia_2023_ts &lt;- energia_2023 |&gt;\n  filter(id_subsistena == \"SIN\") |&gt;\n  rename_with(~ tolower(gsub(\"val_ger\", \"\", .x))) |&gt;\n  mutate(din_instante = \n           as.POSIXct(din_instante,\n                      format = \"%Y-%m-%d %H:%M:%S\")) |&gt;\n  as_tsibble(index = din_instante) |&gt;\n  select(!c(id_subsistena, nom_subsistema,\n            val_carga,val_intercambio)) |&gt;\n  pivot_longer(!din_instante)\n\nhead(energia_2023_ts)\n\nVisualizando.\n\nenergia_2023_ts |&gt; \n  autoplot(value, alpha = 0.5) +\n  labs(y=\"Energia (MWh)\", x=\"\",\n       title=\"Produção de energia no Brasil em 2023\")\n\nSérie de índices de produção de bens de consumo.\n\nprod &lt;- read.csv(\"Producao_bens.csv\",\n                 header=T)\n\nprod$Data &lt;- yearmonth(seq(as.Date(\"2002/1/1\"),\n                           length=271,\n                           by=\"month\"))\n\nprod &lt;- prod |&gt;\n  pivot_longer(cols=capital:nao_duraveis)\n\nprod_ts &lt;- prod |&gt;\n  as_tsibble(key=name, index=Data)\n\nVisualizando em painéis separados.\n\nprod_ts |&gt;\n  autoplot(value) +\n  facet_wrap(nrow = 4, ~name, scales=\"free_y\") +\n  guides(colour=\"none\")\n\nCorrelação entre séries.\n\ndf_prod &lt;- prod_ts |&gt;\n  pivot_wider(names_from=name,\n              values_from=value)\n\nggpairs(df_prod, columns = 2:5)\n\nSérie de emissão de CO2.\n\nco2 &lt;- read.csv(\"co2_mm_mlo.txt\",\n                header=T,\n                skip=41,\n                sep=\"\")\n\nco2 &lt;- co2[, 1:5]\n\ncolnames(co2) &lt;- c(\"year\", \"month\", \"decimal.date\",\n                   \"monthly.averaged\",\n                   \"de-season.alized\")\n\nco2$Date &lt;- as.Date(paste(co2$year, co2$month, \"01\",\n                          sep=\"-\"))\n\nco2_ts &lt;- tsibble(Date = co2$Date,\n                  CO2 = co2$monthly.averaged,\n                  index = Date)\n\nVisualizando.\n\nco2_ts |&gt;\n  autoplot(CO2) +\n  labs(y=\"CO2 [PPM]\", x=\"\",\n       title=\"Emissões de CO2\")\n\nGráfico sazonal.\n\nco2_ts &lt;- co2_ts |&gt;\n  filter(!is.na(CO2))\n\nco2_ts &lt;- co2_ts |&gt;\n  index_by(yearMonth = yearmonth(Date)) |&gt;\n  summarise(CO2 = sum(CO2, na.rm=T))\n\n\nco2_ts |&gt;\n  gg_season(CO2) +\n  labs(x=\"\", y=\"CO2 [PPM]\",\n       title = \"Gráfico sazonal: emissões de CO2\")\n\nGráfico de subséries sazonais.\n\nco2_tsibble |&gt; gg_subseries(CO2) + labs(x=\"\", y = \"CP2 [PPM]\") +\n  labs(title=\"Gráfico de subséries sazonais: CO2\")"
  },
  {
    "objectID": "ST5.html#suavização-exponencial-simples",
    "href": "ST5.html#suavização-exponencial-simples",
    "title": "5  Suavização exponencial",
    "section": "5.1 Suavização exponencial simples",
    "text": "5.1 Suavização exponencial simples\nA suavização exponencial consiste em uma média ponderada das observações anteriores, com peso decaindo exponencialmente à medida que as observações ficam mais distantes no tempo.\nO caso simples pode ser descrito matematicamente conforme segue:\n\\[\n\\hat y_{T+1|T} = \\alpha y_T + \\alpha(1-\\alpha)y_{T-1} + \\alpha(1-\\alpha)^2y_{T-2}+...\n\\]\nonde \\(0&lt; \\alpha &lt;1\\) consiste no parâmetro de suavização. A previsão um passo à frente consiste em uma média ponderada das observações anteriores, \\(y_1,...,y_T\\), com taxa de decrescimento dos pesos controlada pelo parâmetro \\(\\alpha\\). A Tabela 5.1 expõe os pesos para cinco últimas observações da série para distintos valores de \\(\\alpha\\). Observa-se que a soma dos pesos é próxima de 1.\n\n\nTabela 5.1: Pesos na suavização exponencial simples\n\n\nObservação\n\\(\\alpha=0.2\\)\n\\(\\alpha=0.5\\)\n\\(\\alpha=0.8\\)\n\n\n\n\n\\(y_T\\)\n0.200000\n0.500000\n0.800000\n\n\n\\(y_T-1\\)\n0.160000\n0.250000\n0.160000\n\n\n\\(y_T-2\\)\n0.128000\n0.125000\n0.032000\n\n\n\\(y_T-3\\)\n0.102400\n0.062500\n0.006400\n\n\n\\(y_T-4\\)\n0.081920\n0.031250\n0.001280\n\n\n\\(y_T-5\\)\n0.065536\n0.015625\n0.000256\n\n\n\n\nA Figura 5.1 expõe os mesmos pesos plotados segundo o tempo. Observa-se que quanto maior o \\(\\alpha\\), maior a taxa de decrescimento dos pesos da última observação em relação às anteriores.\n\n\n\n\n\nFigura 5.1: Pesos na suavização exponencial simples\n\n\n\n\nO modelo exposto para prever a observação futura pode ser descrito sempre considerando a última observação e a previsão desta:\n\\[\n\\hat y_{T+1|T} = \\alpha y_T +(1-\\alpha)\\hat y_{T|T-1}\n\\]\nDe forma similar os valores estimados para a série ficam:\n\\[\n\\hat y_{t+1|t} = \\alpha y_t +(1-\\alpha)\\hat y_{t|t-1},\n\\]\npara \\(t=1,...,T\\).\nSeja \\(l_0\\) o valor estimado para a primeira observação, \\(t=1\\), então:\n\\[\n\\begin{align}\n\\hat y_{2|1} &= \\alpha y_1 +(1-\\alpha) l_0 \\\\\n\\hat y_{3|2} &= \\alpha y_2 +(1-\\alpha) \\hat y_{2|1} \\\\\n\\hat y_{4|3} &= \\alpha y_3 +(1-\\alpha) \\hat y_{3|2} \\\\\n\\vdots \\\\\n\\hat y_{T|T-1} &= \\alpha y_{T-1} +(1-\\alpha) \\hat y_{T-1|T-2} \\\\\n\\hat y_{T+1|T} &= \\alpha y_{T} +(1-\\alpha) \\hat y_{T|T-1} \\\\\n\\end{align}\n\\]\nObserve que cada equação pode ser substituída na posterior:\n\\[\n\\begin{align}\n\\hat y_{3|2} &= \\alpha y_2 +(1-\\alpha) [\\alpha y_1 +(1-\\alpha) l_0] \\\\\n&= \\alpha y_2 + \\alpha(1-\\alpha)y_1 +(1-\\alpha)^2 l_0\\\\\n\\hat y_{4|3} &= \\alpha y_3 +(1-\\alpha)[\\alpha y_2 + \\alpha(1-\\alpha y_1 +(1-\\alpha)^2 l_0] \\\\\n&= \\alpha y_3 +\\alpha(1-\\alpha) y_2 +\\alpha(1-\\alpha)^2 y_1 +(1-\\alpha)^3 l_0 \\\\\n\\vdots \\\\\n\\hat y_{T+1|T} &= \\sum_{j=0}^{T-1} \\alpha (1-\\alpha)^j y_{T-j}+ (1-\\alpha)^T l_0 \\\\\n\\end{align}\n\\]\nComo o último termo fica muito pequeno para \\(T\\) grande, então a equação fica conforme o modelo apresentado inicialmente.\nA representação em componentes também é comum para a suavização exponencial, sendo o caso simples conforme segue:\n\\[\n\\begin{align}\n\\text{Equação de previsão:    } \\hat y_{t+h} &= l_t\\\\\n\\text{Equação de suavização:    } l_t &= \\alpha y_t + (1-\\alpha)l_{t-1},\\\\\n\\end{align}\n\\]\nonde \\(l_t\\) consiste no nível no período \\(t\\) e \\(\\hat y_{t+h} = l_t\\) a previsão no período \\(t+h\\).\nSe \\(h=1\\), tem-se o valor estimado, enquanto se \\(t=T\\), tem-se a previsão para além dos dados de treino. Fazendo \\(l_t = \\hat y_{t+1|t}\\) e \\(l_{t-1} = \\hat y_{t|t-1}\\), tem-se o modelo ponderado já exposto. Tal representação não é tão útil para o caso simples, porém, quando considerados termos de tendência e suavização, será. O modelo simples, até aqui explicitado é recomendado para casos sem tendência e sazonalidade.\nA Figura 5.2 expõe o resultado da suavização exponencial simples para a série do IPCA no Brasil a partir de 2019. Os parâmetros estimados \\(\\alpha\\) e \\(l_0\\) expostos na Tabela 5.2 foram estimados minimizando a soma dos quadrados dos erros para as estimativas um passo à frente.\n\n\n\n\nTabela 5.2: Parâmetros de suavização exponencial simples para a série do IPCA no Brasil a partir de 2019\n\n\nterm\nestimate\n\n\n\n\nalpha\n0.6373463\n\n\nl[0]\n0.3856718\n\n\n\n\n\n\n\n\n\n\n\nFigura 5.2: Exponencial simples para a série IPCA no Brasil a partir de 2019\n\n\n\n\nA Tabela 5.3 apresenta os valores estimados \\(\\hat y_t\\) para as últimas observações da série.\n\n\n\n\nTabela 5.3: Pesos na suavização exponencial simples\n\n\nindex\nvalue\n.fitted\n\n\n\n\n2024 Apr\n0.38\n0.3506233\n\n\n2024 May\n0.46\n0.3693464\n\n\n2024 Jun\n0.21\n0.4271242\n\n\n2024 Jul\n0.38\n0.2887409\n\n\n2024 Aug\n-0.02\n0.3469045\n\n\n2024 Sep\n0.44\n0.1130593"
  },
  {
    "objectID": "ST5.html#suavização-exponencial-com-tendência",
    "href": "ST5.html#suavização-exponencial-com-tendência",
    "title": "5  Suavização exponencial",
    "section": "5.2 Suavização exponencial com tendência",
    "text": "5.2 Suavização exponencial com tendência\nEm casos com tendência pode-se considerar o método de Holt (2004), o qual considera uma equação para o nível, \\(l_t\\), uma para a tendência, \\(b_t\\), e a de previsão, \\(\\hat y_{t+h|t}\\).\n\\[\n\\begin{align}\n\\text{Equação de previsão:    } \\hat y_{t+h} &= l_t + hb_t\\\\\n\\text{Equação do nível:    } l_t &= \\alpha y_t + (1-\\alpha)(l_{t-1}+b_{t-1})\\\\\n\\text{Equação de tendência:    } b_t &= \\beta^*(l_t-l_{t-1})+(1-\\beta^*)b_{t-1}\n\\end{align}\n\\]\nNeste caso \\(l_t\\) é uma média ponderada da observação \\(y_t\\) e da previsão um passo a frente, dada por \\(l_{t-1}+b_{t-1}\\). A equação de tendência mostra que \\(b_t\\) é uma média ponderada da tendência no tempo \\(t\\), baseada em \\(l_t-l_{t-1}\\), e na estimativa anterior da tendência, \\(b_{t-1}\\).\nA Figura 5.3 expõe a série anual da população projetada para o Brasil até 2010, revisada em 2008, disponível em https://seriesestatisticas.ibge.gov.br/default.aspx. Observa-se tendência de crescimento muito próxima de linear.\n\n\n\n\n\nFigura 5.3: População do Brasil\n\n\n\n\nA Tabela 5.4 expõe os parâmetros estimados de suavização exponencial com tendência para a série da populaçao projetada do Brasil.\n\n\n\n\nTabela 5.4: Parâmetros de suavização exponencial com tendência para a série da população projetada do Brasil\n\n\n.model\nterm\nestimate\n\n\n\n\nAAN\nalpha\n9.953798e-01\n\n\nAAN\nbeta\n4.433299e-01\n\n\nAAN\nl[0]\n1.169488e+08\n\n\nAAN\nb[0]\n2.842713e+06\n\n\n\n\n\n\n\n5.2.1 Suavização exponencial com tendência amortecida\nUm problema do método de Holt (2004) para suavização exponencial com tendência é que ele costuma apresentar uma estimativa linear que em longos horizontes de previsão costuma não se confirmar. Uma opção é a abordagem de Gardner e Mckenzie (1985) que propõe amortecer as previsões. O método inclui o parâmetro de amortecimento \\(0&lt;\\phi&lt;1\\).\n\\[\n\\begin{align}\n\\text{Equação de previsão:    } \\hat y_{t+h} &= l_t + (\\phi+\\phi^2+...+\\phi^h)b_t\\\\\n\\text{Equação do nível:    } l_t &= \\alpha y_t + (1-\\alpha)(l_{t-1}+\\phi b_{t-1})\\\\\n\\text{Equação de tendência:    } b_t &= \\beta^*(l_t-l_{t-1})+(1-\\beta^*)\\phi b_{t-1}\n\\end{align}\n\\]\nCaso \\(\\phi=1\\), então tem-se o método de Holt já exposto. O método tende a gerar previsões com tendência para curtos períodos e previsões constantes em longos horizontes à frente das observações. A Figura 5.4 expõe as previsões 15 anos à frente para a população do Brasil considerando os dados projetados até 2010. Observa-se que o método de Holt projetaria 212 milhões de pessoas em 2020, enquanto o mesmo amortecido projetaria 204 milhões para mesmo ano. Foi considerado neste caso \\(\\phi=0.9\\). Dados já observados do censo de 2022 indicam a população do Brasil neste ano atingiu 203 milhões de pessoas.\n\n\n\n\n\nFigura 5.4: População do Brasil\n\n\n\n\nA Figura 5.5 expõe os mesmos métodos aplicados à série anual de emissão de gases de efeito estufa pela indústria, disponível em https://plataforma.seeg.eco.br/. Foi considerado um \\(\\phi = 0.95\\) para o caso com amortecimento.\n\n\n\n\n\nFigura 5.5: Emissões de gases de efeito estufa pela indústria"
  },
  {
    "objectID": "ST5.html#suavização-exponencial-com-sazonalidade",
    "href": "ST5.html#suavização-exponencial-com-sazonalidade",
    "title": "5  Suavização exponencial",
    "section": "5.3 Suavização exponencial com sazonalidade",
    "text": "5.3 Suavização exponencial com sazonalidade\nHolt (2004) e Winters (1960) consideraram a sazonalidade na suavização exponencial. Logo, além das equações de previsão, nível e tendência, o método inclui uma equação adicional para a sazonalidade. O método considera ambos os casos aditivo e multiplicativo.\nO método Holt-Winter aditivo compreende as equações à seguir:\n\\[\n\\begin{align}\n\\text{Equação de previsão:    } \\hat y_{t+h} &= l_t + hb_t + s_{t+h-m(k+1)}\\\\\n\\text{Equação do nível:    } l_t &= \\alpha (y_t-s_{t-m}) + (1-\\alpha)(l_{t-1}+b_{t-1})\\\\\n\\text{Equação de tendência:    } b_t &= \\beta^*(l_t-l_{t-1})+(1-\\beta^*)b_{t-1}\\\\\n\\text{Equação de sazonalidade:    } s_t &= \\gamma(y_t-l_{t-1}-b_{t-1})+(1-\\gamma)s_{t-1},\n\\end{align}\n\\]\nonde \\(k\\) consiste na parte inteira de \\((h−1)/m\\) que garante que a estimativa dos índices sazonais usados para previsão vêm do último período sazonal da série. A equação de nível consiste em uma média ponderada entre a observação ajustada sazonalmente, \\(y_t-s_{t-m}\\), e a previsão não sazonal, \\(l_{t-1}+b_{t-1}\\), para o tempo \\(t\\). A equação de tendência não muda e a sazonal considera uma média móvel do índice sazonal atual, \\(y_t-l_{t-1}-b_{t-1}\\), e do mesmo período da estação anterior, \\(s_{t-1}\\).\nO caso multiplicativo é exposto à seguir.\n\\[\n\\begin{align}\n\\text{Equação de previsão:    } \\hat y_{t+h} &= (l_t + hb_t)  s_{t+h-m(k+1)}\\\\\n\\text{Equação do nível:    } l_t &= \\alpha \\frac{y_t}{s_{t-m}} + (1-\\alpha)(l_{t-1}+b_{t-1})\\\\\n\\text{Equação de tendência:    } b_t &= \\beta^*(l_t-l_{t-1})+(1-\\beta^*)b_{t-1}\\\\\n\\text{Equação de sazonalidade:    } s_t &= \\gamma \\frac {y_t}{(l_{t-1}-b_{t-1})}+(1-\\gamma)s_{t-1},\n\\end{align}\n\\]\nA Figura 5.6 plota a série temporal de exportações do Brasil em US$ FOB, disponível em https://balanca.economia.gov.br/balanca/publicacoes_dados_consolidados/pg.html. Observa-se em geral tendência de crescimento com estagnação de 2016 a 2021 devido a crise político-econômica e a pandemia.\n\n\n\n\n\nFigura 5.6: Exportações do Brasil\n\n\n\n\nA Figura 5.7 expõe o gráfico sazonal da mesma série. O padrão cíclico não é tão claro, mas nota-se maior volume de exportações de março a agosto.\n\n\n\n\n\nFigura 5.7: Gráfico sazonal para a série de exportações do Brasil\n\n\n\n\nA Figura 5.8 expõe modelos de suavização exponencial com tendência e sazonalidade para a série de exportações do Brasil. Os modelos foram estimados considerando dados de até 2022, sendo as previsões plotadas 3 anos à frente. O resultado foi plotado a partir de 2020, para melhor visualização.\n\n\n\n\n\nFigura 5.8: Modelos de suavização exponencial com tendência e sazonalidade para a série de exportações do Brasil\n\n\n\n\n\n5.3.1 Suavização exponencial com tendência amortecida e sazonalidade\nO método de Holt-Winter também pode considerar o amortecimento. O caso multiplicativo geralmente fornece bons resultados, sendo descrito conforme segue.\n\\[\n\\begin{align}\n\\text{Equação de previsão:    } \\hat y_{t+h} &= [l_t + (\\phi+\\phi^2+...+\\phi^h)b_t]  s_{t+h-m(k+1)}\\\\\n\\text{Equação do nível:    } l_t &= \\alpha \\frac{y_t}{s_{t-m}} + (1-\\alpha)(l_{t-1}+b_{t-1})\\\\\n\\text{Equação de tendência:    } b_t &= \\beta^*(l_t-l_{t-1})+(1-\\beta^*)b_{t-1}\\\\\n\\text{Equação de sazonalidade:    } s_t &= \\gamma \\frac {y_t}{(l_{t-1}-\\phi b_{t-1})}+(1-\\gamma)s_{t-1},\n\\end{align}\n\\]\nA Figura 5.9 expõe modelos de suavização exponencial com tendência amortecida e sazonalidade para a série de exportações do Brasil. O caso multiplicativo parece uma opção interessante com boa adequação aos períodos disponíveis, fazendo uma projeção à frente mais conservadora em comparação ao sem amortecimento.\n\n\n\n\n\nFigura 5.9: Modelos de suavização exponencial com tendência amortecida e sazonalidade para a série de exportações do Brasil"
  },
  {
    "objectID": "ST5.html#modelos-de-ets-e-definição-de-espaço-de-estados",
    "href": "ST5.html#modelos-de-ets-e-definição-de-espaço-de-estados",
    "title": "5  Suavização exponencial",
    "section": "5.4 Modelos de ETS e definição de espaço de estados",
    "text": "5.4 Modelos de ETS e definição de espaço de estados\nOs modelos de suavização exponencial podem ser concebidos como modelos de espaço de estados, com uma equação de medição que descreve os dados observados e outras de estados, por exemplo as de nível tendência e sazonalidade, que descrevem como os componentes ou estados mudam no horizonte de tempo. Ademais, além do erro aditivo há a possibilidade de considerar o erro multiplicativo nos modelos de suavização exponencial.\nOs modelos de suavização exponencial são geralmente denotados por ETS(.,.,.) para descrever as três componentes (erro, tendência, suavização). O erro pode ser aditivo ou multiplicativo, E={A,M}. A tendência pode ser não considerada (N), aditiva (A) ou atitiva amortecida (damped) (Ad), T ={N,A,Ad}. Por fim, a sazonalidade pode ser não considerada, aditiva ou multiplicativa, S={N,A,M}. Logo, há 18 modelos possíveis.\nRetomando a suavização exponencial simples representada em componentes:\n\\[\n\\begin{align}\n\\text{Equação de previsão:    } \\hat y_{t+h} &= l_t\\\\\n\\text{Equação de suavização:    } l_t &= \\alpha y_t + (1-\\alpha)l_{t-1}.\\\\\n\\end{align}\n\\]\nManipulando a Equação de suavização, tem-se:\n\\[\n\\begin{align}\nl_t &= l_{t-1} + \\alpha(y_t-l_{t-1}) \\\\\n    &= l_{t-1} + \\alpha e_t,\n\\end{align}\n\\]\nonde \\(e_t=y_t-l_{t-1}=y_t - \\hat{y}_{t|t-1}\\) é o resíduo no tempo \\(t\\). Pode-se, portanto, considerar que a observação de treino é igual ao nível anterior mais o erro, \\(y_t=l_{t-1}+e_t\\). Logo, deve-se assumir os resíduos como ruído branco, \\(e_t = \\varepsilon_t \\sim NID(0,\\sigma_\\varepsilon^2)\\) ou normalmente e identicamente distribuídos.\nQuando o erro é multiplicativo, tem-se \\(e_t=(y_t - \\hat{y}_{t|t-1})/\\hat{y}_{t|t-1}\\).\nA título de exemplo serão apresentados os modelos Holt-Winters aditivos com erro aditivo ETS(A,A,A) e multiplicativo ETS(M,A,A).\n\n5.4.1 Modelo de Holt-Winter ETS(A,A,A)\nPara este modelo considerando o erro igual a \\(\\varepsilon_t =y_t - l_{t-1} + b_{t-1} + s_{t-m}\\), tem-se o modelo a seguir:\n\\[\n\\begin{align}\ny_t &= l_{t-1} + b_{t-1} + s_{t-m} + \\varepsilon_t\\\\\nl_t &= l_{t-1}+b_{t-1}+ \\alpha \\varepsilon_t\\\\\nb_t &=b_{t-1} + \\beta\\varepsilon_t \\\\\ns_t &= s_{t-m} + \\gamma\\varepsilon_t, \\\\\n\\end{align}\n\\]\nonde \\(\\beta=\\beta^*\\alpha\\).\n\n\n5.4.2 Modelo de Holt-Winter ETS(M,A,A)\nPara o caso com erro multiplicativo o erro com tendência e sazonalidade aditiva, o erro é calculado conforme segue:\n\\[\ne_t=\n\\frac{y_t - (l_{t-1} + b_{t-1} + s_{t-m})}{(l_{t-1} + b_{t-1} + s_{t-m} )}\n\\]\nO modelo fica conforme segue:\n\\[\n\\begin{align}\ny_t &= (l_{t-1} + b_{t-1} + s_{t-m} ) (1+\\varepsilon_t)\\\\\nl_t &= l_{t-1}+b_{t-1}+ \\alpha (l_{t-1}-b_{t-1}-s_{t-m})\\varepsilon_t\\\\\nb_t &=b_{t-1} + \\beta(l_{t-1} + b_{t-1} + s_{t-m} ) \\varepsilon_t \\\\\ns_t &= s_{t-m} + \\gamma(l_{t-1} + b_{t-1} + s_{t-m} ) \\varepsilon_t\\\\\n\\end{align}\n\\]\nRJ Hyndman e Athanasopoulos (2021) explicitam todos os 18 modelos possíveis de suavização com a notação de estado de espaços."
  },
  {
    "objectID": "ST5.html#previsão-e-intervalo-de-confiança-com-ets",
    "href": "ST5.html#previsão-e-intervalo-de-confiança-com-ets",
    "title": "5  Suavização exponencial",
    "section": "5.5 Previsão e intervalo de confiança com ETS",
    "text": "5.5 Previsão e intervalo de confiança com ETS\nA previsão commodelos de ETS pode ser realizada iterando as equações à frente, \\(t=T+1, ..., T+h\\). Por exemplo, para o modelo ETS(M,A,A) a previsão para o primeiro período não disponível seria \\(\\hat y_T+1 = l_{T} + b_{T} + s_{T}\\).\nO intervalo de confiança pode ser calculado conforme já exposto anteriormente, \\(\\hat{y}_{T+h|T} \\pm1,96 \\hat\\sigma_h\\), com 1,96 sendo o valor do quantil da distribuição \\(z\\) para 0,95 de confiança. O desvio-padrão depende do método ETS usado e são bastante complexos. Rob Hyndman et al. (2008) fornece os cálculos detalhados.\nA Figura 5.10 apresenta o fluxo de veículos kilômetro 579 da BR040 em Minas Gerais de 01/03 a 07/04/2019 considerando os dois sentidos de circulação. A série está disponível em https://servicos.dnit.gov.br/dadospnct/ContagemContinua. Observa-se uma sazonalidade semanal e diária na série, com fluxo distinto nos dias 3 e 4 de março devido ao carnaval.\n\n\n\n\n\nFigura 5.10: Fluxo de veículos na BR040 no kilômetro 579 de 01/03 a 07/04/2019\n\n\n\n\nA Figura 5.11 plota a série apenas para os carros de passeio a partir de 11 de março, primeira semana após a do carnaval de 2019. Observa-se regularidade no fluxo e pico nas sextas e sábados.\n\n\n\n\n\nFigura 5.11: Fluxo de carros de passeio na BR040 no kilômetro 579 de 01/03 a 07/04/2019\n\n\n\n\nA Figura 5.12 expõe o gráfico sazonal da série anterior considerando a semana como período sazonal. Enfatiza-se a regularidade entre as 4 semanas disponíveis e observa-se novamente o pico de fluxo nas sextas e domingos devido idas e retornos de fins de semana.\n\n\n\n\n\nFigura 5.12: Gráfico sazonal semanal do fluxo de carros de passeio na BR040 no kilômetro 579 de 01/03 a 07/04/2019\n\n\n\n\nA Figura 5.13 expõe o gráfico sazonal diário do fuxo de veículos na via e kilômetro considerados. Observa-se fluxo mínimo de 0 às 4h da manhã de 7 às 17h na maior parte dos dias. Nas segundas-feiras observa-se um fluxo maior a partir das 6 da manhã. Nas sextas e domingos observa-se um fluxo maior entre as 12 e 18h.\n\n\n\n\n\nFigura 5.13: Gráfico sazonal diário do fluxo de carros de passeio na BR040 no kilômetro 579 de 01/03 a 07/04/2019\n\n\n\n\nA Figura 5.14 expõe o resultado do modelo de suavização exponencial com tendência amortecida e sazonalidade. Foram considerados os dias de março para estimativa e a série completa é plotada juntamente com a previsão para a primeira semana de abril. Será importante avaliar posteriormente métodos que capturem variações sazonais distintas.\n\n\n\n\n\nFigura 5.14: Gráfico sazonal diário do fluxo de carros de passeio na BR040 no kilômetro 579 de 01/03 a 07/04/2019\n\n\n\n\n\n\n\n\nGardner, Everette S., e Ed. Mckenzie. 1985. «Forecasting Trends in Time Series». Management Science 31 (10): 1237–46. https://doi.org/10.1287/mnsc.31.10.1237.\n\n\nHolt, Charles C. 2004. «Forecasting seasonals and trends by exponentially weighted moving averages». International Journal of Forecasting 20 (1): 5–10. https://doi.org/https://doi.org/10.1016/j.ijforecast.2003.09.015.\n\n\nHyndman, RJ, e G Athanasopoulos. 2021. Forecasting: principles and practice. OTexts. OTexts.com/fpp3.\n\n\nHyndman, Rob, Anne B Koehler, J Keith Ord, e Ralph D Snyder. 2008. Forecasting with exponential smoothing: the state space approach. Springer Science & Business Media.\n\n\nWinters, Peter R. 1960. «Forecasting Sales by Exponentially Weighted Moving Averages». Management Science 6 (3): 324–42. https://doi.org/10.1287/mnsc.6.3.324."
  }
]
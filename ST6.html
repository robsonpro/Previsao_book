<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Pereira">

<title>6&nbsp; Modelos auto-regressivos integrados de médias móveis (ARIMA) – Séries Temporais e Previsão</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ST7.html" rel="next">
<link href="./ST5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ST6.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos auto-regressivos integrados de médias móveis (ARIMA)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Séries Temporais e Previsão</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ST1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução e gráficos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ST2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análise descritiva, métodos simples de previsão e diagnóstico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ST3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Decomposição de séries temporais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ST4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regressão de séries temporais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ST5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Suavização exponencial</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ST6.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos auto-regressivos integrados de médias móveis (ARIMA)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ST7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regressão dinâmica</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#estacionariedade-em-séries-temporais" id="toc-estacionariedade-em-séries-temporais" class="nav-link active" data-scroll-target="#estacionariedade-em-séries-temporais"><span class="header-section-number">6.1</span> Estacionariedade em séries temporais</a>
  <ul class="collapse">
  <li><a href="#diferenciação" id="toc-diferenciação" class="nav-link" data-scroll-target="#diferenciação"><span class="header-section-number">6.1.1</span> Diferenciação</a></li>
  <li><a href="#testes-de-raízes-unitárias" id="toc-testes-de-raízes-unitárias" class="nav-link" data-scroll-target="#testes-de-raízes-unitárias"><span class="header-section-number">6.1.2</span> Testes de raízes unitárias</a></li>
  <li><a href="#operador-de-defasagem" id="toc-operador-de-defasagem" class="nav-link" data-scroll-target="#operador-de-defasagem"><span class="header-section-number">6.1.3</span> Operador de defasagem</a></li>
  </ul></li>
  <li><a href="#modelos-autorregressivos" id="toc-modelos-autorregressivos" class="nav-link" data-scroll-target="#modelos-autorregressivos"><span class="header-section-number">6.2</span> Modelos autorregressivos</a>
  <ul class="collapse">
  <li><a href="#previsão-para-modelos-autoregressivos" id="toc-previsão-para-modelos-autoregressivos" class="nav-link" data-scroll-target="#previsão-para-modelos-autoregressivos"><span class="header-section-number">6.2.1</span> Previsão para modelos autoregressivos</a></li>
  </ul></li>
  <li><a href="#modelos-de-média-móvel" id="toc-modelos-de-média-móvel" class="nav-link" data-scroll-target="#modelos-de-média-móvel"><span class="header-section-number">6.3</span> Modelos de média móvel</a>
  <ul class="collapse">
  <li><a href="#previsão-para-modelos-de-média-móvel" id="toc-previsão-para-modelos-de-média-móvel" class="nav-link" data-scroll-target="#previsão-para-modelos-de-média-móvel"><span class="header-section-number">6.3.1</span> Previsão para modelos de média móvel</a></li>
  </ul></li>
  <li><a href="#modelos-arima-não-sazonais" id="toc-modelos-arima-não-sazonais" class="nav-link" data-scroll-target="#modelos-arima-não-sazonais"><span class="header-section-number">6.4</span> Modelos ARIMA não sazonais</a>
  <ul class="collapse">
  <li><a href="#previsão-com-modelos-arima-não-sazonais" id="toc-previsão-com-modelos-arima-não-sazonais" class="nav-link" data-scroll-target="#previsão-com-modelos-arima-não-sazonais"><span class="header-section-number">6.4.1</span> Previsão com modelos ARIMA não sazonais</a></li>
  </ul></li>
  <li><a href="#autocorrelação-parcial" id="toc-autocorrelação-parcial" class="nav-link" data-scroll-target="#autocorrelação-parcial"><span class="header-section-number">6.5</span> Autocorrelação parcial</a>
  <ul class="collapse">
  <li><a href="#modelagem-e-seleção-de-modelos" id="toc-modelagem-e-seleção-de-modelos" class="nav-link" data-scroll-target="#modelagem-e-seleção-de-modelos"><span class="header-section-number">6.5.1</span> Modelagem e seleção de modelos</a></li>
  </ul></li>
  <li><a href="#sarima-arima-com-sazonalidade" id="toc-sarima-arima-com-sazonalidade" class="nav-link" data-scroll-target="#sarima-arima-com-sazonalidade"><span class="header-section-number">6.6</span> SARIMA: ARIMA com sazonalidade</a></li>
  <li><a href="#implementações-em-r" id="toc-implementações-em-r" class="nav-link" data-scroll-target="#implementações-em-r"><span class="header-section-number">6.7</span> Implementações em R</a></li>
  <li><a href="#exercícios-propostos." id="toc-exercícios-propostos." class="nav-link" data-scroll-target="#exercícios-propostos."><span class="header-section-number">6.8</span> Exercícios propostos.</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos auto-regressivos integrados de médias móveis (ARIMA)</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Pereira </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="estacionariedade-em-séries-temporais" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="estacionariedade-em-séries-temporais"><span class="header-section-number">6.1</span> Estacionariedade em séries temporais</h2>
<p>As séries temporais estacionárias são aquelas que não apresentam tendência ou sazonalidade, de forma que suas propriedades estatísticas permaneçam constantes ao longo do tempo. Séries estacionárias variam com média e variância constantes. Apesar de muitas séries temporais não serem estacionárias, não é difícil torná-las estacionárias. Um ruído branco, <span class="math inline">\(\varepsilon_t\)</span>, é um exemplo de série estacionária, apresentando as seguintes propriedades <span class="citation" data-cites="harvey1990econometric">(<a href="references.html#ref-harvey1990econometric" role="doc-biblioref">Harvey 1990</a>)</span>:</p>
<p><span class="math display">\[
\begin{align}
E(\varepsilon_t)&amp; = 0, \text{ } t=1,\dots,T \\
E(\varepsilon_t^2)&amp;= Var(\varepsilon_t) = \sigma^2, \text{ } t=1,\dots,T \\
E(\varepsilon_t\varepsilon_s)&amp; = 0, \text{ } t \neq s, \text{ } t=1,\dots,T. \\
\end{align}
\]</span></p>
<p>Algumas séries cíclicas podem ser estacionárias, caso os picos e vales não sejam previsíveis devido a variabilidade na dimensão do ciclo.</p>
<p>A <a href="#fig-series" class="quarto-xref">Figura&nbsp;<span>6.1</span></a> expõe exemplos de séries temporais estacionárias. À esquerda observa-se um ruído branco e à direita a série de variação na ação PETR3 para pouco mais de 10 meses de 2024.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-series" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-series-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-series-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-series-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.1: Exemplos de séries temporais estacionárias
</figcaption>
</figure>
</div>
</div>
</div>
<section id="diferenciação" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="diferenciação"><span class="header-section-number">6.1.1</span> Diferenciação</h3>
<p>A diferenciação é útil para tornar uma série não estacionária em estacionária. Apesar de muitas séries observadas na indústria, na economia e em negócios apresentarem mudança nas suas propriedades, o comportamento da variação da série, isto é, o comportamento da série diferenciada é geralmente estacionário <span class="citation" data-cites="box2008time">(<a href="references.html#ref-box2008time" role="doc-biblioref">Box et al. 2008</a>)</span>. Logo, a diferenciação serve para remover a variação no nível de uma série, estabilizando sua média.</p>
<p>A diferenciação consiste na variação entre observações subsequentes. Ou seja, considerando uma série com <span class="math inline">\(T\)</span> observações, a série diferenciada contém ao final <span class="math inline">\(T-1\)</span> observações. A série diferenciada é denotada <span class="math inline">\(y_t'\)</span>, sendo obtida conforme a <a href="#eq-diff" class="quarto-xref">Equação&nbsp;<span>6.1</span></a>.</p>
<p><span id="eq-diff"><span class="math display">\[
y_t' = y_t-y_{t-1}
\tag{6.1}\]</span></span></p>
<p>A <a href="#tbl-diffibov" class="quarto-xref">Tabela&nbsp;<span>6.1</span></a> expõe as primeiras observações na série do índice Ibovespa e variação deste. Observa-se para estas primeiras observações variações positivas, ou seja, alta em relação ao período anterior, para a maioria dos dias, mas também variações negativas, ou seja, queda em relação ao período anterior.</p>
<div class="cell">
<div id="tbl-diffibov" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-diffibov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.1: Primeiras observações do índice Ibovespa e sua variação
</figcaption>
<div aria-describedby="tbl-diffibov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Fechamento</th>
<th style="text-align: right;">Variação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">131,59</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">132,16</td>
<td style="text-align: right;">0,57</td>
</tr>
<tr class="odd">
<td style="text-align: right;">130,57</td>
<td style="text-align: right;">-1,59</td>
</tr>
<tr class="even">
<td style="text-align: right;">131,06</td>
<td style="text-align: right;">0,50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">133,12</td>
<td style="text-align: right;">2,06</td>
</tr>
<tr class="even">
<td style="text-align: right;">133,75</td>
<td style="text-align: right;">0,62</td>
</tr>
<tr class="odd">
<td style="text-align: right;">134,96</td>
<td style="text-align: right;">1,21</td>
</tr>
<tr class="even">
<td style="text-align: right;">135,12</td>
<td style="text-align: right;">0,16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">134,88</td>
<td style="text-align: right;">-0,24</td>
</tr>
<tr class="even">
<td style="text-align: right;">134,03</td>
<td style="text-align: right;">-0,85</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Se a série diferenciada consiste em um ruído branco, <span class="math inline">\(\varepsilon_t\)</span>, então pode-se escrever:</p>
<p><span class="math display">\[
y_t-y_{t-1} = \varepsilon_t
\]</span></p>
<p>Um modelo onde a observação posterior é igual à anterior adicionada de um ruído branco, <span class="math inline">\(y_t = y_{t-1}+\varepsilon_t\)</span>, é chamado de caminhada aleatória (<em>random walk</em>). O modelo de caminhada aleatória estima a próxima observação igual à anterior, <span class="math inline">\(\hat y_t = y_{t-1}\)</span>, conforme o método ingênuo. No caso de média não nula, como a maior parte das séries, pode-se adicionar uma constante, conforme segue, onde <span class="math inline">\(c\)</span> é estimada pela média das diferenças.</p>
<p><span class="math display">\[
y_t-y_{t-1} = \varepsilon_t + c
\]</span></p>
<p>A <a href="#fig-difcor" class="quarto-xref">Figura&nbsp;<span>6.2</span></a> expõe a série não estacionária do índice Ibovespa, além da série obtida a partir da diferenciação desta que, obviamente, consiste na variação diária do índice. A série diferenciada apresenta estacionariedade. A Figura exibe também os correlogramas da série do índice e da variação deste. Observa-se que a série diferenciada, ao contrário da original, não apresenta autocorrelação.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-difcor" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-difcor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-difcor-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difcor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.2: Série temporal não estacionária, diferenciação e autocorrelação
</figcaption>
</figure>
</div>
</div>
</div>
<p>O modelo de caminhada aleatória é muito útil para séries econométricas e de finanças. Geralmente tais séries apresentam longos períodos de tendência de queda ou crescimento, com mudanças inesperadas de difícil explicação.</p>
<p>Em casos onde a diferenciação de primeira ordem não garante a estacionariedade, pode-se ainda aplicar uma diferenciação de segunda ordem, conforme expresso na <a href="#eq-diff2" class="quarto-xref">Equação&nbsp;<span>6.2</span></a>.</p>
<p><span id="eq-diff2"><span class="math display">\[
\begin{align}
y_t'' &amp;= y_t'-y_{t-1}' \\
      &amp;= (y_t-y_{t-1})-(y_{t-1}-y_{t-2}) \\
      &amp;= y_t-2y_{t-1}+y_{t-2}
\end{align}
\tag{6.2}\]</span></span></p>
<p>Em séries sazonais é importante aplicar a diferenciação sazonal, conforme exposto na <a href="#eq-diffsaz" class="quarto-xref">Equação&nbsp;<span>6.3</span></a>, onde <span class="math inline">\(m\)</span> é o número de períodos sazonais.</p>
<p><span id="eq-diffsaz"><span class="math display">\[
y_t'= y_t - y_{t-m}
\tag{6.3}\]</span></span></p>
<p>A <a href="#fig-voosdiff" class="quarto-xref">Figura&nbsp;<span>6.3</span></a> apresenta a série de passageiros em vôos do Brasil. Foi aplicado logaritmo para estabilizar a variação anual. Posteriormente, foi realizada diferenciação sazonal, <span class="math inline">\(m=12\)</span>. Em seguida, realizou-se a diferenciação simples, de forma a garantir a estacionariedade. Pode-se observar que a diferenciação anual elimina a sazonalidade e a mensal a tendência.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-voosdiff" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-voosdiff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-voosdiff-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-voosdiff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.3: Passageiros em vôos do Brasil: série original, log da série, variação sazonal e variação de segunda ordem
</figcaption>
</figure>
</div>
</div>
</div>
<p>Tomando a diferenciação de primeira ordem como sendo sazonal, <span class="math inline">\(y' = y_t-y_{t-m}\)</span>, então a diferenciação de segunda ordem pode ser expressa conforme a <a href="#eq-difsaz" class="quarto-xref">Equação&nbsp;<span>6.4</span></a>.</p>
<p><span id="eq-difsaz"><span class="math display">\[
\begin{align}
y'' &amp;= y'-y'_{t-1} \\
    &amp;= (y_t-y_{t-m})-(y_{t-1}-y_{t-m-1}) \\
    &amp;= y_t - y_{t-m} -y_{t-1}+y_{t-m-1} \\
\end{align}
\tag{6.4}\]</span></span></p>
</section>
<section id="testes-de-raízes-unitárias" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="testes-de-raízes-unitárias"><span class="header-section-number">6.1.2</span> Testes de raízes unitárias</h3>
<p>Um modelo autoregressivo de primeira ordem, <span class="math inline">\(y_t = \phi y_{t-1}+\varepsilon_t\)</span>, consiste em um modelo estacionário se <span class="math inline">\(|\phi|&lt;1\)</span>. Se <span class="math inline">\(\phi=1\)</span>, tem-se um modelo de caminhada aleatória, a série tem raiz unitária e é, consequentemente, não estacionária <span class="citation" data-cites="box2008time">(<a href="references.html#ref-box2008time" role="doc-biblioref">Box et al. 2008</a>)</span>. Logo, os testes de raízes unitárias tem o objetivo de avaliar se a série apresenta ou não estacionariedade.</p>
<p>O teste de Kwiatkowski-Phillips-Schmidt-Shin (KPSS) <span class="citation" data-cites="kwiatkowski1992testing">(<a href="references.html#ref-kwiatkowski1992testing" role="doc-biblioref">Kwiatkowski et al. 1992</a>)</span> é uma opção, com a hipótese nula indicando a estacionariedade da série. A <a href="#tbl-kpss1" class="quarto-xref">Tabela&nbsp;<span>6.2</span></a> apresenta o resultado do teste para a série do índice Ibovespa, indicando a rejeição da hipótese nula de estacionariedade, sendo necessária a diferenciação da série. A <a href="#tbl-kpss1dif" class="quarto-xref">Tabela&nbsp;<span>6.3</span></a> apresenta o resultado do teste para a série do índice diferenciada. Observa-se neste caso que o resultado sugere que a hipótese nula de estacionariedade da série não deve ser rejeitada.</p>
<div class="cell">
<div id="tbl-kpss1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kpss1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.2: Teste KPSS para o índice Ibovespa
</figcaption>
<div aria-describedby="tbl-kpss1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0,7490546</td>
<td style="text-align: right;">0,01</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div id="tbl-kpss1dif" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kpss1dif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.3: Teste KPSS para a variação do índice Ibovespa
</figcaption>
<div aria-describedby="tbl-kpss1dif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0,1841354</td>
<td style="text-align: right;">0,1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="operador-de-defasagem" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="operador-de-defasagem"><span class="header-section-number">6.1.3</span> Operador de defasagem</h3>
<p>O operador ou notação de defasagem (<em>backward shift notation</em> - <span class="math inline">\(B\)</span>) é útil para trabalhar com diferenciação <span class="citation" data-cites="box2008time">(<a href="references.html#ref-box2008time" role="doc-biblioref">Box et al. 2008</a>)</span>, defasagem (<em>lag</em>) e para representação de modelos ARIMA. O operador <span class="math inline">\(B\)</span> em <span class="math inline">\(y_t\)</span> defasa a observação em um período no tempo, conforme <a href="#eq-bsop" class="quarto-xref">Equação&nbsp;<span>6.5</span></a>.</p>
<p><span id="eq-bsop"><span class="math display">\[
By_t = y_{t-1}
\tag{6.5}\]</span></span></p>
<p>No caso de defasagem de segunda ordem, tem-se:</p>
<p><span class="math display">\[
B(By_t) = B^2y_t = By_{t-1} = y_{t-2}
\]</span></p>
<p>Logo, de forma geral, <span class="math inline">\(B^ky_t = y_{t-k}\)</span>. Para casos sazonais pode-se usar a diferenciação sazonal. Por exemplo, em séries de frquência horária e sazonalidade diária, pode ser útil usar <span class="math inline">\(B^{24}y_t = y_{t-24}\)</span>, de forma a retornar na mesma hora no dia anterior.</p>
<p>A diferenciação de primeira ordem com a notação de defasagem pode ser escrita segundo a <a href="#eq-Bdif" class="quarto-xref">Equação&nbsp;<span>6.6</span></a>.</p>
<p><span id="eq-Bdif"><span class="math display">\[
\begin{align}
y'_t &amp;= y_t-y_{t-1} \\
     &amp;=y_t-By_t \\
     &amp;=(1-B)y_t
\end{align}
\tag{6.6}\]</span></span></p>
<p>De forma análoga, a diferenciação de segunda ordem fica segundo a <a href="#eq-Bdif2" class="quarto-xref">Equação&nbsp;<span>6.7</span></a>.</p>
<p><span id="eq-Bdif2"><span class="math display">\[
\begin{align}
y_t'' &amp;= y_t-2y_{t-1}+y_{t-2} \\
      &amp;= y_t-2By_t+B^2y_t \\
      &amp;= (1-B)^2y_t
\end{align}
\tag{6.7}\]</span></span></p>
</section>
</section>
<section id="modelos-autorregressivos" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="modelos-autorregressivos"><span class="header-section-number">6.2</span> Modelos autorregressivos</h2>
<p>Um modelo autorregressivo consiste em um modelo de regressão para a série, <span class="math inline">\(y_t\)</span>, em função do seu passado, isto é, em função de termos defasados da série, <span class="math inline">\(y_{t-1}, y_{t-2}, ..., y_{t-p}\)</span>. Um modelo autorregressivo de ordem <span class="math inline">\(p\)</span> ou <span class="math inline">\(AR(p)\)</span> pode ser escrito segundo a <a href="#eq-armodel" class="quarto-xref">Equação&nbsp;<span>6.8</span></a>.</p>
<p><span id="eq-armodel"><span class="math display">\[
\begin{align}
y_t &amp;= c+\phi_1y_{t-1} + \phi_2y_{t-2} + \ldots + \phi_py_{t-p} + \varepsilon_t \\
    &amp;= c+\phi_1By_t + \phi_2B^2y_t + \ldots + \phi_pB^py_t + \varepsilon_t \\
\end{align}
\tag{6.8}\]</span></span></p>
<p>Um modelo autoregressivo de primeira ordem é denotado <span class="math inline">\(y_t = c+ \phi_1 y_{t-1} + \varepsilon_t\)</span>. Em uma série estacionária tem-se <span class="math inline">\(E(y_t) = E(y_{t-1}) = \mu_y\)</span>. Subtraindo-se a média tanto na série quanto no termo defasado, pode-se eliminar a constante:</p>
<p><span class="math display">\[
\begin{align}
y_t - \mu_y=&amp; \phi_1(y_{t-1}-\mu_y) + \varepsilon_t \\
y_t =&amp; \phi_1y_{t-1}+ \mu_y -\phi_1\mu_y + \varepsilon_t \\
y_t =&amp; \phi_1y_{t-1}+ \mu_y(1 -\phi_1) + \varepsilon_t \\
\end{align}
\]</span></p>
<p>Logo, <span class="math inline">\(c=\mu_y(1 -\phi_1)\)</span> para um modelo <span class="math inline">\(AR(1)\)</span> e, generalizando, <span class="math inline">\(c = \mu_y(1-\phi_1-\phi_2-...-\phi_p) = \mu_y(1-\sum_i^p \phi_i)\)</span> para um modelo <span class="math inline">\(AR(p)\)</span> <span class="citation" data-cites="makridakis2008forecasting hamilton2020time">(<a href="references.html#ref-makridakis2008forecasting" role="doc-biblioref">Makridakis, Wheelwright, e Hyndman 2008</a>; <a href="references.html#ref-hamilton2020time" role="doc-biblioref">Hamilton 1994</a>)</span>. Para <span class="math inline">\(\mu_y=0\)</span>, pode-se usar a representação com notação de defasagem da <a href="#eq-armodel2" class="quarto-xref">Equação&nbsp;<span>6.9</span></a>. Pode-se observar que tal modelo é um modelo de regressão que ao invés de considerar outras variáveis independentes, considera valores anteriores da prória série, sendo, portanto, um modelo autoregressivo. Tal modelo não deve, entretanto, ser tratado como um modelo de regressão obtido por mínimos quadrados. Primeiro, porque a independência dos erros pode ser violada, dado o usual relacionamento entre os termos do lado direito. Segundo, pois a determinação da maior defasagem, <span class="math inline">\(p\)</span>, no modelo não é simples <span class="citation" data-cites="makridakis2008forecasting">(<a href="references.html#ref-makridakis2008forecasting" role="doc-biblioref">Makridakis, Wheelwright, e Hyndman 2008</a>)</span>.</p>
<p><span id="eq-armodel2"><span class="math display">\[
(1-\phi_1B- \phi_2B^2 - \ldots - \phi_pB^p)y_t = \varepsilon_t \\
\tag{6.9}\]</span></span></p>
<p>A <a href="#fig-ar" class="quarto-xref">Figura&nbsp;<span>6.4</span></a> expõe séries temporais que seguem processos autorregressivos <span class="math inline">\(AR(1)\)</span> e <span class="math inline">\(AR(2)\)</span>. Na <a href="#fig-ar" class="quarto-xref">Figura&nbsp;<span>6.4</span></a>(a) tem-se um processo autorregressivo de primeira ordem, <span class="math inline">\(AR(1)\)</span>, com <span class="math inline">\(y_t=0,6y_{t-1}+\varepsilon_t\)</span>. Na <a href="#fig-ar" class="quarto-xref">Figura&nbsp;<span>6.4</span></a>(b) tem-se um processo autorregressivo de segunda ordem, <span class="math inline">\(AR(2)\)</span>, com <span class="math inline">\(y_t = 8-0,5y_{t-1}+0,3y_{t-2}+\varepsilon_t\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ar" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-ar-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.4: Processos autorregressivos
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os processos autorregressivos são muito flexíveis. A mudança dos parâmetros <span class="math inline">\(\phi_1,..., \phi_p\)</span> pode resultar em padrões de séries temporais muito distintos <span class="citation" data-cites="hyndman2018forecasting">(<a href="references.html#ref-hyndman2018forecasting" role="doc-biblioref">R. Hyndman e Athanasopoulos 2021</a>)</span>.</p>
<p>Para um modelo <span class="math inline">\(AR(1)\)</span>, <span class="math inline">\(y_t=c+\phi_1y_{t-1} + \varepsilon_t\)</span>:</p>
<ul>
<li>Se <span class="math inline">\(c=0\)</span> e <span class="math inline">\(\phi_1=0\)</span>, tem-se um ruído branco.</li>
<li>Se <span class="math inline">\(c=0\)</span> e <span class="math inline">\(\phi_1=1\)</span>, tem-se uma caminhada aleatória.</li>
<li>Se <span class="math inline">\(c\neq0\)</span> e <span class="math inline">\(\phi_1=1\)</span>, tem-se uma caminhada aleatória com deriva.</li>
<li>Se <span class="math inline">\(\phi_1&lt;0\)</span>, <span class="math inline">\(y_t\)</span> tende a oscilar em torno da média.</li>
</ul>
<p>Os processos autorregressivos são úteis para modelar séries estacionárias, devendo satisfazer algumas restrições <span class="citation" data-cites="hyndman2018forecasting cryer2008time harvey1990econometric">(<a href="references.html#ref-hyndman2018forecasting" role="doc-biblioref">R. Hyndman e Athanasopoulos 2021</a>; <a href="references.html#ref-cryer2008time" role="doc-biblioref">Cryer e Chan 2008</a>; <a href="references.html#ref-harvey1990econometric" role="doc-biblioref">Harvey 1990</a>)</span>:</p>
<ul>
<li>Para um modelo <span class="math inline">\(AR(1)\)</span>: <span class="math inline">\(|\phi_1|1\)</span>.</li>
<li>Para um modelo <span class="math inline">\(AR(2)\)</span>: <span class="math inline">\(|\phi_2|&lt;1\)</span>, <span class="math inline">\(\phi_1+\phi_2&lt;1\)</span>, <span class="math inline">\(\phi_2-\phi_1&lt;1\)</span>.</li>
</ul>
<p>Para um processo autoregressivo AR(1) a autocorrelação decai exponencialmente com o aumento da defasagem <span class="citation" data-cites="harvey1990econometric">(<a href="references.html#ref-harvey1990econometric" role="doc-biblioref">Harvey 1990</a>)</span>. Seja um modelo AR(1) com média nula. Recordando que a autocorrelação para defasagem de <span class="math inline">\(k\)</span> observações neste caso consiste em <span class="math inline">\(\rho_k=E(y_ty_{t-k})\)</span>, tem-se:</p>
<p><span class="math display">\[
\begin{align}
E(y_ty_{t-k}) &amp; = \phi E(y_{t-1}y_{t-k})  + E(\varepsilon_t y_{t-k}) \\
\rho_k &amp;= \phi \rho_{k-1}
\end{align}
\]</span></p>
<p>Logo, se <span class="math inline">\(|\phi| &lt;1\)</span>, então a autocorrelação de um modelo AR(1) decai exponencialmente em magnitude. Se <span class="math inline">\(0&lt;\phi&lt;1\)</span>, tem-se autocorrelações positivas e se <span class="math inline">\(-1&lt;\phi&lt;0\)</span>, as autocorrelações se alternam em sinal com a primeira negativa e com magnitude diminuindo exponencialmente <span class="citation" data-cites="cryer2008time">(<a href="references.html#ref-cryer2008time" role="doc-biblioref">Cryer e Chan 2008</a>)</span>. A <a href="#fig-aracfs" class="quarto-xref">Figura&nbsp;<span>6.5</span></a> exibe correlogramas de processos AR(1), com <span class="math inline">\(\phi=0,9\)</span> e <span class="math inline">\(\phi=-0,7\)</span>, confirmando tais afirmações.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-aracfs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aracfs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-aracfs-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aracfs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.5: Correlogrmas de processos autorregressivos de primeira ordem
</figcaption>
</figure>
</div>
</div>
</div>
<section id="previsão-para-modelos-autoregressivos" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="previsão-para-modelos-autoregressivos"><span class="header-section-number">6.2.1</span> Previsão para modelos autoregressivos</h3>
<p>A previsão para um modelo <span class="math inline">\(AR(1)\)</span> pode ser realizada de forma simples. Seja o modelo <span class="math inline">\(y_t = c + \phi y_{t-1} + \varepsilon_t\)</span>. A previsão para um período à frente das observações disponíveis, <span class="math inline">\(\hat y_{T+1}\)</span>, pode ser obtida segundo <a href="#eq-predar1" class="quarto-xref">Equação&nbsp;<span>6.10</span></a>.</p>
<p><span id="eq-predar1"><span class="math display">\[
\hat y_{T+1} = c + \phi y_{T}
\tag{6.10}\]</span></span></p>
<p>De forma análoga, para dois períodos à frente, a previsão fica:</p>
<p><span class="math display">\[
\begin{align}
\hat y_{T+2} =&amp; c + \phi y_{T+1} \\
\hat y_{T+2} =&amp; c + \phi (c + \phi y_{T}) \\
\hat y_{T+2} =&amp; c + \phi c + \phi^2 y_{T} \\
\hat y_{T+2} =&amp; c(1 + \phi) + \phi^2 y_{T} \\
\end{align}
\]</span></p>
<p>Seguindo este raciocício recursivo, pode-se obter a previsão para <span class="math inline">\(h\)</span> períodos à frente para um modelo <span class="math inline">\(AR(1)\)</span> conforme <a href="#eq-predar1h" class="quarto-xref">Equação&nbsp;<span>6.11</span></a>.</p>
<p><span id="eq-predar1h"><span class="math display">\[
\hat y_{T+h} = c(1 + \phi + \phi^2 + \dots+\phi^{h-1}) + \phi^h y_{T}
\tag{6.11}\]</span></span></p>
<p>Fazendo:</p>
<p><span class="math display">\[S_h = 1 + \phi + \phi^2 + \dots+\phi^{h-1},\]</span></p>
<p>logo,</p>
<p><span class="math display">\[\phi S_h = \phi + \phi^2 + \dots+\phi^{h}.\]</span></p>
<p>Portanto,</p>
<p><span class="math display">\[
\begin{align}
S_h - \phi S_h =&amp; 1-\phi^h \\
S_h(1-\phi) =&amp; 1-\phi^h \\
S_h =&amp; \frac{1-\phi^h}{1-\phi}, \text{} |\phi|&lt;1.
\end{align}
\]</span></p>
<p>Consequentemente, a previsão para um modelo <span class="math inline">\(AR(1)\)</span> também pode ser escrita segundo a <a href="#eq-predar1h2" class="quarto-xref">Equação&nbsp;<span>6.12</span></a>, pois, conforme já visto, <span class="math inline">\(c=\mu(1-\phi)\)</span>.</p>
<p><span id="eq-predar1h2"><span class="math display">\[
\begin{align}
\hat y_{T+h} =&amp; c\frac{1-\phi^h}{1-\phi} + \phi^h y_{T} \\
\hat y_{T+h} =&amp; \mu_y + \phi^h (y_{T}-\mu_y)
\end{align}
\tag{6.12}\]</span></span></p>
<p>Já para modelos de média móvel de ordem genérica, <span class="math inline">\(AR(p)\)</span>, não há uma fórmula tão simples, usa-se simplesmente o processo recursivo de previsão. Portanto, para <span class="math inline">\(h=1\)</span>, a previsão fica segundo a <a href="#eq-predarp1" class="quarto-xref">Equação&nbsp;<span>6.13</span></a>.</p>
<p><span id="eq-predarp1"><span class="math display">\[
\hat y_{T+1} = c+\phi_1y_{T} + \phi_2y_{T-1} + \ldots + \phi_py_{T+1-p}
\tag{6.13}\]</span></span></p>
<p>Para <span class="math inline">\(h\)</span> períodos à frente, a previsão para um modelo <span class="math inline">\(AR(p)\)</span> é obtida a partir da <a href="#eq-predarph" class="quarto-xref">Equação&nbsp;<span>6.14</span></a>.</p>
<p><span id="eq-predarph"><span class="math display">\[
\hat y_{T+h} = c+\phi_1y_{T+h-1} + \phi_2y_{T+h-2} + \ldots + \phi_py_{T+h-p}
\tag{6.14}\]</span></span></p>
</section>
</section>
<section id="modelos-de-média-móvel" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="modelos-de-média-móvel"><span class="header-section-number">6.3</span> Modelos de média móvel</h2>
<p>Um modelo de média móvel considera os erros passados ao invés das observações passadas, sendo um modelo de média móvel de ordem <span class="math inline">\(q\)</span>, <span class="math inline">\(MA(q)\)</span> definido conforme <a href="#eq-mamodel" class="quarto-xref">Equação&nbsp;<span>6.15</span></a>. Como os valores do erro não são observáveis, este modelo também não é uma regressão habitual <span class="citation" data-cites="hyndman2018forecasting">(<a href="references.html#ref-hyndman2018forecasting" role="doc-biblioref">R. Hyndman e Athanasopoulos 2021</a>)</span>.</p>
<p><span id="eq-mamodel"><span class="math display">\[
\begin{align}
y_t&amp;=c+\varepsilon_t+\theta_1\varepsilon_{t-1} + \theta_2\varepsilon_{t-2} + \ldots + \theta_q\varepsilon_{t-q}\\
&amp;=c+\varepsilon_t+\theta_1B\varepsilon_t+\theta_2B^2\varepsilon_t+\ldots+\theta_qB^q\varepsilon_t \\
&amp;=c+ (1+\theta_1B+\theta_2B^2+\ldots+\theta_qB^q)\varepsilon_t
\end{align}
\tag{6.15}\]</span></span></p>
<p>É importante também distinguir os modelos <span class="math inline">\(MA(q)\)</span> dos modelos de média móvel para estimativa da tendência na decomposição clássica. Enquanto os modelos aqui apresentados tem o objetivo de realizar previsões, aqueles visam suavizar a séries temporal, eliminando sua sazonalidade.</p>
<p>A <a href="#fig-ma" class="quarto-xref">Figura&nbsp;<span>6.6</span></a> ilustra processos de média móvel. Na <a href="#fig-ma" class="quarto-xref">Figura&nbsp;<span>6.6</span></a>(a) um processo de média móvel de primeira ordem, <span class="math inline">\(MA(1)\)</span>, é observado com <span class="math inline">\(y_t = 15 + \varepsilon_t + 0.6\varepsilon_{t-1}\)</span>. Na <a href="#fig-ma" class="quarto-xref">Figura&nbsp;<span>6.6</span></a>(b) tem-se um processo de média móvel de segunda ordem, <span class="math inline">\(MA(2)\)</span>, com <span class="math inline">\(y_t = 8 + \varepsilon_t - 0.9\varepsilon_{t-1} + 0.5\varepsilon_{t-2}\)</span>. Mudando os parâmetros <span class="math inline">\(\theta_1, ..., \theta_q\)</span> a série varia significativamente. Assim como nos modelos autorregressivos, nos de média móvel a variância do erro <span class="math inline">\(\sigma_\varepsilon\)</span> só muda a amplitude da série, não o padrão.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ma" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-ma-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.6: Processos de média móvel
</figcaption>
</figure>
</div>
</div>
</div>
<p>Qualquer processo estacionário <span class="math inline">\(AR(p)\)</span> pode ser escrito como um processo <span class="math inline">\(MA(\infty)\)</span>. Para o caso <span class="math inline">\(AR(1)\)</span>, tem-se:</p>
<p><span class="math display">\[
\begin{align}
y_t &amp;= \phi_1y_{t-1} + \varepsilon_t\\
    &amp;=  \phi_1(\phi_1y_{t-2} + \varepsilon_{t-1}) + \varepsilon_t\\
    &amp;= \phi_1^2y_{t-2} + \phi_1\varepsilon_{t-1} + \varepsilon_t\\
    &amp;= \phi_1^3y_{t-3} + \phi_1^2\varepsilon_{t-2} + \phi_1\varepsilon_{t-1} + \varepsilon_t\\
    &amp;= ...\\
\end{align}
\]</span></p>
<p>À medida que <span class="math inline">\(k\)</span> aumenta, <span class="math inline">\(\phi_1^k\)</span> diminui, considerando <span class="math inline">\(-1&lt;\phi_1&lt;1\)</span>, de forma que o termo de potência maior pode ser desconsiderado. Fazendo <span class="math inline">\(\phi_1 = \theta_1\)</span>, <span class="math inline">\(\phi_1^2 = \theta_2\)</span> e assim sucessivamente, tem-se o modelo de média móvel inicialmente exposto. De forma análoga, impondo algumas restrições nos parâmetros do modelo <span class="math inline">\(MA(q)\)</span> é possível escrevê-lo como um processo <span class="math inline">\(AR(\infty)\)</span>.</p>
<p>Qualquer processo <span class="math inline">\(MA(q)\)</span> é estacionário. Para um processo MA(1), as condições de estacionariedade são satisfeitas conforme segue <span class="citation" data-cites="harvey1990econometric">(<a href="references.html#ref-harvey1990econometric" role="doc-biblioref">Harvey 1990</a>)</span>:</p>
<p><span class="math display">\[
\begin{align}
E(y_t) &amp; = E(\varepsilon_t) + \theta E(\varepsilon_{t-1}) = 0 \\
E(y_t^2) &amp; = E(\varepsilon_t^2) + 2\theta E(\varepsilon_t\varepsilon_{t-1}) + \theta^2 E(\varepsilon_{t-1}^2)= \sigma^2(1+\theta^2) \\
E(y_ty_{t-1}) &amp;= E[(\varepsilon_t + \theta \varepsilon_{t-1})(\varepsilon_{t-1} + \theta \varepsilon_{t-2})] = \theta \sigma^2 \\
E(y_ty_{t-k}) &amp;= E[(\varepsilon_t + \theta \varepsilon_{t-1})(\varepsilon_{t-k} + \theta \varepsilon_{t-k-1})] = 0, \text{ } k =2,3,... \\
\end{align}
\]</span></p>
<p>A partir de tais condições não é difícil entender que um processo MA(1) apresenta uma queda acentuada na autocorrelação após a defasagem de uma observação, assim como um processo MA(2) apresentará queda na autocorrelação após a defasagem de duas observações. A <a href="#fig-maacfs" class="quarto-xref">Figura&nbsp;<span>6.7</span></a> expõe correlogramas de tais processos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-maacfs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-maacfs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-maacfs-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-maacfs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.7: Correlogramas de processos de média móvel
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para processos MA(q), de forma análoga a um processo MA(1), não é difícil comprovar as condições de estacionariedade <span class="citation" data-cites="harvey1990econometric">(<a href="references.html#ref-harvey1990econometric" role="doc-biblioref">Harvey 1990</a>)</span>.</p>
<section id="previsão-para-modelos-de-média-móvel" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="previsão-para-modelos-de-média-móvel"><span class="header-section-number">6.3.1</span> Previsão para modelos de média móvel</h3>
<p>Considerando inicialmente um modelo de média móvel <span class="math inline">\(MA(1)\)</span>, <span class="math inline">\(y_t = c + \varepsilon_t + \theta_1\varepsilon_{t-1}\)</span>, seja a previsão um período à frente, <span class="math inline">\(h=1\)</span>, obtida segundo a <a href="#eq-predma11" class="quarto-xref">Equação&nbsp;<span>6.16</span></a>, pois <span class="math inline">\(\varepsilon_{T+1},\dots,\varepsilon_{T+h}\)</span> são desconhecidos e tem esperança nula. A constante <span class="math inline">\(c\)</span> pode ser estimada segundo a média da série, <span class="math inline">\(c=\mu_y\)</span>.</p>
<p><span id="eq-predma11"><span class="math display">\[
\begin{align}
\hat y_{T+1} &amp;= c + \varepsilon_{T+1} + \theta_1\varepsilon_{T} \\
\hat y_{T+1} &amp;= c + \theta_1\varepsilon_{T}
\end{align}
\tag{6.16}\]</span></span></p>
<p>Já para <span class="math inline">\(h \ge 2\)</span> a previsão consiste apenas na constante, conforme <a href="#eq-predma12" class="quarto-xref">Equação&nbsp;<span>6.17</span></a>.</p>
<p><span id="eq-predma12"><span class="math display">\[
\begin{align}
\hat y_{T+1} &amp;= c + \varepsilon_{T+2} + \theta_1\varepsilon_{T+1} \\
\hat y_{T+1} &amp;= c
\end{align}
\tag{6.17}\]</span></span></p>
<p>Para um modelo de média-móvel de ordem <span class="math inline">\(q\)</span>, <span class="math inline">\(MA(q)\)</span> a previsão para um período à frente pode ser obtida segundo a <a href="#eq-predmaq1" class="quarto-xref">Equação&nbsp;<span>6.18</span></a>.</p>
<p><span id="eq-predmaq1"><span class="math display">\[
\begin{align}
\hat y_{T+1}&amp;=c+\varepsilon_{T+1}+\theta_1\varepsilon_{T} + \theta_2\varepsilon_{T-1} + \ldots + \theta_q\varepsilon_{T+1-q} \\
\hat y_{T+1}&amp;=c+\theta_1\varepsilon_{T} + \theta_2\varepsilon_{T-1} + \ldots + \theta_q\varepsilon_{T+1-q}
\end{align}
\tag{6.18}\]</span></span></p>
<p>A previsão sempre conterá termos de erros observados, portanto, se <span class="math inline">\(h&gt;q\)</span>, ou seja, se o período de previsão for maior que a ordem do modelo, todos os termos de erro serão desconhecidos e a previsão será igual à constante, conforme <a href="#eq-predmaqh" class="quarto-xref">Equação&nbsp;<span>6.19</span></a>.</p>
<p><span id="eq-predmaqh"><span class="math display">\[
\hat y_{T+h}=c
\tag{6.19}\]</span></span></p>
</section>
</section>
<section id="modelos-arima-não-sazonais" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="modelos-arima-não-sazonais"><span class="header-section-number">6.4</span> Modelos ARIMA não sazonais</h2>
<p>Um modelo autorregressivo integrado de média móvel (ARIMA) combina um modelo autorregressivo da série diferenciada e um de média móvel. Para diferenciação de primeira ordem o modelo é expresso segundo a <a href="#eq-arimaa" class="quarto-xref">Equação&nbsp;<span>6.20</span></a>.</p>
<p><span id="eq-arimaa"><span class="math display">\[
\begin{align}
y_t'&amp;=c+\phi_1y'_{t-1} + \phi_2y'_{t-2} + \ldots + \phi_py'_{t-p} + \theta_1\varepsilon_{t-1} + \theta_2\varepsilon_{t-2} + \ldots + \theta_q\varepsilon_{t-q} + \varepsilon_t \\
&amp;= c+\phi_1By'_t + \phi_2B^2y'_t + \ldots + \phi_pB^py'_t+\theta_1B\varepsilon_t + \theta_2B^2\varepsilon_t + \ldots + \theta_qB^q\varepsilon_t + \varepsilon_t \\
\end{align}
\tag{6.20}\]</span></span></p>
<p>Logo, considerando ordem de diferenciação <span class="math inline">\(d\)</span>, pode-se representar um modelo <span class="math inline">\(ARIMA(p,d,q)\)</span> usando a <a href="#eq-arimaa2" class="quarto-xref">Equação&nbsp;<span>6.21</span></a>.</p>
<p><span id="eq-arimaa2"><span class="math display">\[
(1-\phi_1B- \ldots - \phi_pB^p)(1-B)^dy_t = c+( 1+\theta_1B+\ldots+\theta_qB^q)\varepsilon_t.
\tag{6.21}\]</span></span></p>
<p>Quando não é necessária a diferenciação da série, isto é, <span class="math inline">\(d=0\)</span>, tem-se um modelo <span class="math inline">\(ARMA(p,d)\)</span> <span class="citation" data-cites="box2008time">(<a href="references.html#ref-box2008time" role="doc-biblioref">Box et al. 2008</a>)</span>. A <a href="#tbl-casosarima" class="quarto-xref">Tabela&nbsp;<span>6.4</span></a> expõe a sintaxe do modelo ARIMA correspondente para alguns casos especiais já conhecidos.</p>
<div id="tbl-casosarima" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-casosarima-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.4: Casos especiais e modelos ARIMA correspondentes
</figcaption>
<div aria-describedby="tbl-casosarima-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Caso especial</th>
<th>Modelo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ruído branco</td>
<td><span class="math inline">\(ARIMA(0,0,0)\)</span> sem cte</td>
</tr>
<tr class="even">
<td>Caminhada aleatória</td>
<td><span class="math inline">\(ARIMA(0,1,0)\)</span> sem cte</td>
</tr>
<tr class="odd">
<td>Caminhada aleatória com deriva</td>
<td><span class="math inline">\(ARIMA(0,1,0)\)</span> com cte</td>
</tr>
<tr class="even">
<td>Autorregressão</td>
<td><span class="math inline">\(ARIMA(p,0,0)\)</span></td>
</tr>
<tr class="odd">
<td>Média móvel</td>
<td><span class="math inline">\(ARIMA(0,0,q)\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>A <a href="#fig-coque" class="quarto-xref">Figura&nbsp;<span>6.8</span></a> expõe a série temporal do volume de produção de coque no Brasil a partir de 2021.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-coque" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-coque-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-coque-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-coque-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.8: Volume de produção de coque no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>É difícil selecionar apropriadamente os valores adequados de <span class="math inline">\(p,d,q\)</span> ao se estimar um modelo ARIMA para uma série de interesse. O pacote <code>fable</code> auxilia na otimização destes parâmetros segundo a série em análise. A seguir expõe-se o resultado do modelo ARIMA obtido automaticamente.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: value 
Model: ARIMA(1,0,0) w/ mean 

Coefficients:
         ar1    constant
      0,2763  271035,558
s.e.  0,1433    4547,139

sigma^2 estimated as 969282769:  log likelihood=-516,68
AIC=1039,35   AICc=1039,95   BIC=1044,7</code></pre>
</div>
</div>
<p>Foi obtido um modelo ARIMA(1,0,0) exposto a seguir, onde <span class="math inline">\(\varepsilon_t\)</span> é ruído branco com <span class="math inline">\(\sigma_\varepsilon = 31133,31\)</span>.</p>
<p><span class="math display">\[
y_t = 271035,56 + 0,28y_{t-1} + \varepsilon_t
\]</span></p>
<p>A <a href="#fig-for_fitcoque" class="quarto-xref">Figura&nbsp;<span>6.9</span></a> expõe a previsão de 10 meses à frente usando tal modelo.</p>
<div class="cell" data-tbl-cap="Previsão para 10 meses via ARIMA para a série de volume de produção de coque no Brasil">
<div class="cell-output-display">
<div id="fig-for_fitcoque" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-for_fitcoque-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-for_fitcoque-1.png" id="fig-for_fitcoque" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-for_fitcoque-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.9
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-vale20" class="quarto-xref">Figura&nbsp;<span>6.10</span></a> expõe a série temporal do valor da ação VALE3 a partir de 2020.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-vale20" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vale20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-vale20-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vale20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.10: Série temporal do valor da ação VALE3
</figcaption>
</figure>
</div>
</div>
</div>
<p>Abaixo expõe-se o modelo ARIMA obtido para a série.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Valor 
Model: ARIMA(2,0,2) w/ mean 

Coefficients:
         ar1      ar2      ma1     ma2  constant
      1,4603  -0,7901  -0,6441  0,4800   23,9391
s.e.  0,1549   0,1356   0,2359  0,1225    0,5966

sigma^2 estimated as 25,64:  log likelihood=-135,27
AIC=282,53   AICc=284,74   BIC=293,37</code></pre>
</div>
</div>
<p>Foi obtido um modelo <span class="math inline">\(ARIMA(2,0,2)\)</span>:</p>
<p><span class="math display">\[
y_t = 23,94 + 1,46y_{t-1} - 0,79y_{t-2} -0,64\varepsilon_{t-1} + 0,48\varepsilon_{t-2} + \varepsilon_t
\]</span></p>
<p>A <a href="#fig-resi" class="quarto-xref">Figura&nbsp;<span>6.11</span></a> expõe os gráficos dos resíduos do modelo ARIMA(2,0,2) aplicado à série do preço da ação VALE3. Observa-se um padrão de ruído branco, com ausência de autocorrelação.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-resi" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-resi-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.11: Resíduos do modelo ARIMA(2,0,2) para a série do valor da ação VALE3
</figcaption>
</figure>
</div>
</div>
</div>
<p>Conforme <a href="#fig-for_vale10" class="quarto-xref">Figura&nbsp;<span>6.12</span></a>, dada a previsão 10 meses à frente exibida, o modelo capturou bem o padrão cíclico não sazonal da série.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-for_vale10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-for_vale10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-for_vale10-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-for_vale10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.12: Série temporal do valor da ação VALE3
</figcaption>
</figure>
</div>
</div>
</div>
<section id="previsão-com-modelos-arima-não-sazonais" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="previsão-com-modelos-arima-não-sazonais"><span class="header-section-number">6.4.1</span> Previsão com modelos ARIMA não sazonais</h3>
<p>A previsão em modelos ARIMA é realizada usando o modelo ARIMA obtido, considerando o número de períodos à frente de interesse, <span class="math inline">\(h\)</span>, à frente das observações disponíveis, <span class="math inline">\(T+h\)</span>. Para um modelo ARIMA com <span class="math inline">\(d=1\)</span>, considerando um período à frente, <span class="math inline">\(h=1\)</span>, a previsão é realizada segundo a <a href="#eq-predarima1" class="quarto-xref">Equação&nbsp;<span>6.22</span></a>, onde o termo de erro para <span class="math inline">\(t=T+1\)</span> é desconhecido e tem esperança nula, <span class="math inline">\(E[\varepsilon_{T+1}]=0\)</span>. Para períodos de previsão maiores, <span class="math inline">\(h\ge2\)</span>, faz-se recursivamente a previsão, de forma similar ao demonstrado para os modelos autoregressivos e os de média móvel, lembrando que este último apresentará todos termos de erro nulos sempre que <span class="math inline">\(h\geq q\)</span>, uma vez que são desconhecidos.</p>
<p><span id="eq-predarima1"><span class="math display">\[
\begin{align}
y_{T+1}'&amp;=c+\phi_1y'_{T} + \phi_2y'_{T-1} + \ldots + \phi_py'_{T+1-p} + \theta_1\varepsilon_{T} + \theta_2\varepsilon_{T-1} + \ldots + \theta_q\varepsilon_{T+1-q} + \varepsilon_{T+1} \\
\hat y_{T+1}'&amp;=c+\phi_1y'_{T} + \phi_2y'_{T-1} + \ldots + \phi_py'_{T+1-p} + \theta_1\varepsilon_{T} + \theta_2\varepsilon_{T-1} + \ldots + \theta_q\varepsilon_{T+1-q} \\
\hat y_{T+1} - y_{T} &amp;= c + \phi_1(y_T-y_{T-1}) + \phi_2(y_{T-1}-y_{T-2}) + \dots + \theta_1\varepsilon_{T} + \theta_2\varepsilon_{T-1} + \ldots + \theta_q\varepsilon_{T+1-q}  \\
\hat y_{T+1} &amp;= c + y_{T} + \phi_1y_T-\phi_1y_{T-1} + \phi_2y_{T-1}-\phi_2y_{T-2} + \dots + \theta_1\varepsilon_{T} + \theta_2\varepsilon_{T-1} + \ldots + \theta_q\varepsilon_{T+1-q}  \\
\hat y_{T+1} &amp;= c + y_{T}(1 + \phi_1)+y_{T-1}(\phi_2-\phi_1) + \dots + \theta_1\varepsilon_{T} + \theta_2\varepsilon_{T-1} + \ldots + \theta_q\varepsilon_{T+1-q}  \\
\end{align}
\tag{6.22}\]</span></span></p>
<p>Em um modelo ARIMA se <span class="math inline">\(c=0\)</span> e <span class="math inline">\(d=0\)</span>, então a previsão de longo prazo tenderá para zero. Se <span class="math inline">\(c=0\)</span> e <span class="math inline">\(d=1\)</span>, a previsão a longo prazo tenderá para uma constante. Se <span class="math inline">\(c=0\)</span> e <span class="math inline">\(d=2\)</span>, a previsão a longo prazo será linear. Se <span class="math inline">\(c\neq0\)</span> e <span class="math inline">\(d=0\)</span>, a previsão a longo prazo será a média das observações. Se <span class="math inline">\(c\neq0\)</span> e <span class="math inline">\(d=1\)</span> a previsão a longo prazo será linear. Para previsões cíclicas é importante <span class="math inline">\(p\geq2\)</span> <span class="citation" data-cites="hyndman2018forecasting">(<a href="references.html#ref-hyndman2018forecasting" role="doc-biblioref">R. Hyndman e Athanasopoulos 2021</a>)</span>.</p>
</section>
</section>
<section id="autocorrelação-parcial" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="autocorrelação-parcial"><span class="header-section-number">6.5</span> Autocorrelação parcial</h2>
<p>A autocorrelação <span class="math inline">\(r_k\)</span> mede a relação linear entre a série original <span class="math inline">\(y_t\)</span> e a série defasada <span class="math inline">\(y_{t-k}\)</span>. Entretanto, se <span class="math inline">\(y_t\)</span> e <span class="math inline">\(y_{t-1}\)</span> são correlacionadas, então <span class="math inline">\(y_{t-1}\)</span> e <span class="math inline">\(y_{t-2}\)</span> também serão. Logo, haverá correlação entre <span class="math inline">\(y_t\)</span> e <span class="math inline">\(y_{t-2}\)</span>. Porém, não porque necessariamente há uma explicação plausível para <span class="math inline">\(y_t\)</span> a partir de <span class="math inline">\(y_{t-2}\)</span>, mas simplesmente porque ambas estão relacionadas indiretamente por <span class="math inline">\(y_{t-1}\)</span>.</p>
<p>A autocorrelação parcial visa corrigir este viés da autocorrelação, medindo mais diretamente a relação linear entre <span class="math inline">\(y_t\)</span> e <span class="math inline">\(y_{t-k}\)</span> desconsiderando os efeitos das defasagens anteriores, <span class="math inline">\(1,2,\ldots, k-1\)</span>.</p>
<p>A <a href="#fig-acfpacf" class="quarto-xref">Figura&nbsp;<span>6.13</span></a> expõe os correlogramas de autocorrelação (ACF) e de autocorrelação parcial (PACF) da série do preço da ação VALE3. Observa-se um padrão sinusoidal em ambos correlogramas e a última autocorrelação parcial significativa com <span class="math inline">\(k=3\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-acfpacf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-acfpacf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-acfpacf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-acfpacf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.13: Autocorrelação e autocorrelação parcial da série VALE3
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os correlogramas de ACF e PACF podem auxiliar na definição da ordem do modelo ARIMA em casos <span class="math inline">\(ARIMA(0,d,q)\)</span> e <span class="math inline">\(ARIMA(p,d,0)\)</span>. Para séries que seguem um padrão <span class="math inline">\(ARIMA(0,d,q)\)</span>:</p>
<ul>
<li>A autocorrelação parcial (PACF) decai exponencialmente ou tem padrão senoidal;</li>
<li>Há significância na autocorrelação (ACF) de lag <span class="math inline">\(q\)</span>, mas não além deste.</li>
</ul>
<p>Para séries que seguem um padrão <span class="math inline">\(ARIMA(p,d,0)\)</span>:</p>
<ul>
<li>A autocorrelação (ACF) decai exponencialmente ou tem padrão senoidal;</li>
<li>Há significância na autocorrelação parcial (PACF) de lag <span class="math inline">\(p\)</span>, mas não além deste.</li>
</ul>
<p>A seguir apresenta-se o resultado do modelo ARIMA(3,0,0) para a série da ação VALE3 indicado pela interpretação dos correlogramas da <a href="#fig-acfpacf" class="quarto-xref">Figura&nbsp;<span>6.13</span></a>. O modelo obtido apresentou resultado para <span class="math inline">\(AICc\)</span> muito próximo ao obtido pela estimativa automática apresentado anteriormente.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Valor 
Model: ARIMA(3,0,0) w/ mean 

Coefficients:
         ar1     ar2      ar3  constant
      0,8779  0,1577  -0,4693   31,4916
s.e.  0,1268  0,1812   0,1290    0,7465

sigma^2 estimated as 26,71:  log likelihood=-136,62
AIC=283,25   AICc=284,78   BIC=292,28</code></pre>
</div>
</div>
<section id="modelagem-e-seleção-de-modelos" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="modelagem-e-seleção-de-modelos"><span class="header-section-number">6.5.1</span> Modelagem e seleção de modelos</h3>
<p>Os modelos ARIMA podem ser estimados de distintas formas. Para um modelo de ordem <span class="math inline">\(p,d,q\)</span> pode-se maximizar o log da máxima verossimilhança para estimar os parâmetros <span class="math inline">\(c\)</span>, <span class="math inline">\(\phi_1,\ldots,\phi_p\)</span> e <span class="math inline">\(\theta_1,\ldots,\theta_q\)</span>, conforme realizado no pacote <code>fable</code>. É importante esclarecer que existem distintos algoritmos e, neste sentido, linguagens e pacotes computacionais diferentes podem não reportar os mesmos resultados.</p>
<p>Para comparar e selecionar modelos pode-se considerar o critério de informação de Akaike (<span class="math inline">\(AIC\)</span>), calculado conforme segue, onde <span class="math inline">\(k=0\)</span>, se <span class="math inline">\(c=0\)</span>, e <span class="math inline">\(k=1\)</span>, caso contrário.</p>
<p><span class="math display">\[
AIC = -2\text{log}(L) + 2(p+k+q+1)
\]</span></p>
<p>O AIC corrigido (<span class="math inline">\(AICc\)</span>) é calculado conforme segue.</p>
<p><span class="math display">\[
AIC_c = AIC+ \frac{2(p+k+q+1)(p+k+q+2)}{T-p-q-k-2}
\]</span></p>
<p>Outra métrica é o critério de informação Bayesiano (BIC):</p>
<p><span class="math display">\[
BIC = AIC + [\text{log}(T)-2](p+k+q+1)
\]</span></p>
<p>O modelo que minimizar tais métricas deve ser escolhido, sugerindo-se priorizar o <span class="math inline">\(AICc\)</span>. Uma abordagem para seleção de modelos ARIMA para casos não sazonais pode seguir os seguintes passos <span class="citation" data-cites="hyndman2018forecasting">(<a href="references.html#ref-hyndman2018forecasting" role="doc-biblioref">R. Hyndman e Athanasopoulos 2021</a>)</span>:</p>
<ol type="1">
<li>Visualize a série e identifique observações não usuais;</li>
<li>Realize transformação de Box-Cox para estabilizar a variância, se necessário;</li>
<li>Para séries não estacionárias, sugere-se diferenciar a série até tornar os dados estacionários;</li>
<li>Examine a autocorrelação e tente identificar algum modelo <span class="math inline">\(ARIMA(p,d,0)\)</span> via PACF ou <span class="math inline">\(ARIMA(0,d,q)\)</span> via ACF;</li>
<li>Selecione o modelo a partir do <span class="math inline">\(AICc\)</span>;</li>
<li>Avalie os resíduos do modelo selecionado;</li>
<li>Realize previsões com o modelo.</li>
</ol>
<p>Em caso de autocorrelação nos resíduos, tente ajustar outro modelo. Para exemplificar o procedimento, considere a série de produção de grãos no Brasil em toneladas, apresentada no capítulo 4, na <a href="ST7.html#fig-graos" class="quarto-xref">Figura&nbsp;<span>7.6</span></a>. Como a série aparenta apresentar leve heterocedasticidade, será realizada transformação de Box-Cox.</p>
<p>A <a href="#fig-graos-bc" class="quarto-xref">Figura&nbsp;<span>6.14</span></a> apresenta a série após transformação com <span class="math inline">\(\lambda=0,6264\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-graos-bc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graos-bc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-graos-bc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graos-bc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.14: Série de produção de grãos no Brasil com transformação de Box-Cox
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#tbl-kpss_graos" class="quarto-xref">Tabela&nbsp;<span>6.5</span></a> apresenta o resultado do teste de KPSS para a série transformada, indicando a rejeição da hipótese nula de estacionariedade desta.</p>
<div class="cell">
<div id="tbl-kpss_graos" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kpss_graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.5: Teste KPSS para a série de produção de grãos
</figcaption>
<div aria-describedby="tbl-kpss_graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1,242214</td>
<td style="text-align: right;">0,01</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-graos-diff" class="quarto-xref">Figura&nbsp;<span>6.15</span></a> apresenta a variação da série transformada. Mesmo com a transformação de Box-Cox, após 2015 houve períodos de variação mais alta. Confirma-se estacionariedade após diferenciação de primeira ordem da série transformada, conforme <a href="#tbl-kpss_graosvar" class="quarto-xref">Tabela&nbsp;<span>6.6</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-graos-diff" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graos-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-graos-diff-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graos-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.15: Variação da série transformada de produção de grãos no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-kpss_graosvar" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kpss_graosvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.6: Teste KPSS para a variação da série transformada de produção de grãos
</figcaption>
<div aria-describedby="tbl-kpss_graosvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0,5364439</td>
<td style="text-align: right;">0,0334586</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-graos-autocorr" class="quarto-xref">Figura&nbsp;<span>6.16</span></a> expõe os correlogramas de ACF e PACF para a série diferenciada e transformada. Observa-se que o primeiro indica um modelo <span class="math inline">\(ARIMA(0,1,1)\)</span>, enquanto o segundo indica um modelo <span class="math inline">\(ARIMA(1,1,0)\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-graos-autocorr" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graos-autocorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-graos-autocorr-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graos-autocorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.16: Autocorrelação e autocorrelação parcial da série de produção de grãos
</figcaption>
</figure>
</div>
</div>
</div>
<p>A seguir expõe-se o resultado do modelo <span class="math inline">\(ARIMA(1,1,0)\)</span>. Foi obtido <span class="math inline">\(ACCc\)</span> = 585,42.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: valor 
Model: ARIMA(1,1,0) w/ drift 
Transformation: box_cox(valor, lambda) 

Coefficients:
          ar1  constant
      -0,4639   41,2969
s.e.   0,1369    8,4272

sigma^2 estimated as 3430:  log likelihood=-257,09
AIC=520,17   AICc=520,73   BIC=525,72</code></pre>
</div>
</div>
<p>A seguir expõe-se o resultado do modelo <span class="math inline">\(ARIMA(0,1,1)\)</span>. Foi obtido <span class="math inline">\(ACCc\)</span> = 586,36, indicando que o modelo anterior apresentou melhor ajuste.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: valor 
Model: ARIMA(0,1,1) w/ drift 
Transformation: box_cox(valor, lambda) 

Coefficients:
          ma1  constant
      -0,4384   28,0583
s.e.   0,1109    4,7877

sigma^2 estimated as 3446:  log likelihood=-257,18
AIC=520,36   AICc=520,92   BIC=525,91</code></pre>
</div>
</div>
<p>A <a href="#fig-resi-graos" class="quarto-xref">Figura&nbsp;<span>6.17</span></a> expõe os gráficos de resíduos para o modelo <span class="math inline">\(ARIMA(1,1,0)\)</span> aplicado à série transformada de produção de grãos. Os resíduos são não correlacionados e não aparentam apresentar desvio significativo de normalidade.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-resi-graos" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resi-graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-resi-graos-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resi-graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.17: Resíduos do modelo ARIMA(1,1,0) para a série de produção de grãos
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#tbl-ljungbox-graos" class="quarto-xref">Tabela&nbsp;<span>6.7</span></a> resume o resultado do teste de Ljung-Box para os resíduos do modelo <span class="math inline">\(ARIMA(1,1,0)\)</span> para a série de produção de grãos. O teste deve ser realizado considerando <span class="math inline">\(K=p+q\)</span> graus de liberdade. O alto p-valor obtido indica não haver indícios para rejeição da hipótese nula de ausência de autocorrelação.</p>
<div class="cell">
<div id="tbl-ljungbox-graos" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ljungbox-graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.7: Teste de Ljung-Box para os resíduos do modelo ARIMA(1,1,0) para a série de produção de grãos
</figcaption>
<div aria-describedby="tbl-ljungbox-graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4,580951</td>
<td style="text-align: right;">0,8692027</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-for_graos" class="quarto-xref">Figura&nbsp;<span>6.18</span></a> expõe a previsão realizada para <span class="math inline">\(h=10\)</span> anos à frente com o modelo ajustado. A previsão pontual para 2033 é de 397000 toneladas de grãos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-for_graos" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-for_graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-for_graos-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-for_graos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.18: Previsão com o modelo ARIMA(1,1,0) para a série de produção de grãos
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sarima-arima-com-sazonalidade" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="sarima-arima-com-sazonalidade"><span class="header-section-number">6.6</span> SARIMA: ARIMA com sazonalidade</h2>
<p>Modelos ARIMA também podem ser aplicados a casos sazonais, sendo denotados <span class="math inline">\(ARIMA(p,d,q)(P,D,Q)_m\)</span>, onde <span class="math inline">\(m\)</span> é o período sazonal e os termos da parte sazonal do modelo são denotados por letras maiúsculas. Um modelo <span class="math inline">\(ARIMA(1,1,1)(1,1,1)_{12}\)</span> para uma série de frequência mensal seria para sazonalidade anual e pode ser escrito em notação de defasagem conforme <a href="#eq-sarimaa" class="quarto-xref">Equação&nbsp;<span>6.23</span></a>, onde <span class="math inline">\(\Phi_1\)</span> e <span class="math inline">\(\Theta_1\)</span> são, respectivamente, os termos autorregressivo e de média móvel, para a parte sazonal. Os modelos ARIMA sazonais são comumente chamados de SARIMA.</p>
<p><span id="eq-sarimaa"><span class="math display">\[
(1-\phi_1B)(1-\Phi_1B^{12})(1-B)(1-B^{12})y_t = c+( 1+\theta_1B)( 1+\Theta_1B^{12})\varepsilon_t
\tag{6.23}\]</span></span></p>
<p>A <a href="#fig-cheg" class="quarto-xref">Figura&nbsp;<span>6.19</span></a> expõe graficamente a série de chegada de turistas no Brasil, incluindo brasileiros que vivem no exterior e estrangeiros. A série tem frequência mensal e está disponível em <a href="https://dados.gov.br/dados/conjuntos-dados/estimativas-de-chegadas-de-turistas-internacionais-ao-brasil">Estimativas de Chegadas de Turistas Internacionais ao Brasil</a>. Observa-se tendência de crescimento no volume de chegadas com variação sazonal anual com padrão não constante. A partir de 2020 observa-se queda brusca no volume de chegadas devido à pandemia de COVID-19.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-cheg" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cheg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-cheg-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cheg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.19: Série de chegada turistas do exterior no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-chegsaz" class="quarto-xref">Figura&nbsp;<span>6.20</span></a> ilustra o gráfico sazonal da série de chegada de turistas no Brasil. Confirma-se a sazonalidade anual, com maior volume nas chegadas em dezembro e janeiro, além de volume maior em julho, em relação aos meses do outono e do inverno. Fica clara, também, a tendência de crescimento na duas últimas décadas, em relação aos anos 90 e início dos anos 2000. Destaca-se, também, o pico de chegadas em junho de 2014, devido à copa do mundo de futebol, além do aumento do volume de chegadas em agosto de 2016, devido às olimpíadas do Rio de Janeiro.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chegsaz" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chegsaz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-chegsaz-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chegsaz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.20: Chegada turistas no Brasil: gráfico sazonal
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-chegdifflog" class="quarto-xref">Figura&nbsp;<span>6.21</span></a> expõe novamente a série de chegada de turistas do exterior no Brasil, considerando o período de 2015 a 2019. A Figura também apresenta a série transformada via logarítmo, com diferenciação sazonal e diferenciação dupla. Observa-se que, por neste período a série não apresentar tendência clara, a diferenciação sazonal já praticamente viabiliza a estacionariedade. A <a href="#tbl-chegkpss" class="quarto-xref">Tabela&nbsp;<span>6.8</span></a> expõe o resultado do teste de KPSS, o qual indica a não rejeição da hipótese nula de estacionariedade da variação no log série de chegada turistas no Brasil.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chegdifflog" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chegdifflog-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-chegdifflog-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chegdifflog-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.21: Chegada turistas do exterior no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-chegkpss" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-chegkpss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.8: Teste de KPSS para a variação sazonal no log série de chegada turistas no Brasil
</figcaption>
<div aria-describedby="tbl-chegkpss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0,0591714</td>
<td style="text-align: right;">0,1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-chegcorr" class="quarto-xref">Figura&nbsp;<span>6.22</span></a> expõe os correlogramas de ACF e PACF para a variação sazonal no log série de chegada turistas no Brasil. Observa-se no correlograma de ACF pico nas autocorrelações com defasagem de uma e de doze observações, sugerindo <span class="math inline">\(q=1\)</span> e <span class="math inline">\(Q=1\)</span>. O correlograma de PACF apresenta padrão similar, sugerindo <span class="math inline">\(p=1\)</span> e <span class="math inline">\(P=1\)</span>. Logo, serão testados os modelos <span class="math inline">\(ARIMA(1,0,0)(1,1,0)_{12}\)</span> e <span class="math inline">\(ARIMA(0,0,1)(0,1,1)_{12}\)</span>, além do modelo ARIMA automático.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chegcorr" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chegcorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-chegcorr-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chegcorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.22: Correlogramas para a variação sazonal no log série de chegada turistas no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#tbl-chegarimafit" class="quarto-xref">Tabela&nbsp;<span>6.9</span></a> apresenta o resultado dos modelos ARIMA testados para o log série de chegada turistas no Brasil. Observa-se que o modelo automático apresentou os mesmos resultados que o modelo <span class="math inline">\(ARIMA(0,0,1)(0,1,1)_{12}\)</span>. A seguir expõe-se a saída do modelo automático, indicando que ele é exatamente igual ao supracitado. Logo, foi possível identificar via PACF a ordem da média móvel da parte simples e da sazonal do modelo SARIMA.</p>
<div class="cell">
<div id="tbl-chegarimafit" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-chegarimafit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.9: Modelos ARIMA para o log série de chegada turistas no Brasil
</figcaption>
<div aria-describedby="tbl-chegarimafit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Modelo</th>
<th style="text-align: right;">sigma2</th>
<th style="text-align: right;">log_lik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">AICc</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sarima001011</td>
<td style="text-align: right;">0,0164671</td>
<td style="text-align: right;">29,06562</td>
<td style="text-align: right;">-52,13123</td>
<td style="text-align: right;">-51,58578</td>
<td style="text-align: right;">-46,51763</td>
</tr>
<tr class="even">
<td style="text-align: left;">auto</td>
<td style="text-align: right;">0,0164671</td>
<td style="text-align: right;">29,06562</td>
<td style="text-align: right;">-52,13123</td>
<td style="text-align: right;">-51,58578</td>
<td style="text-align: right;">-46,51763</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sarima100110</td>
<td style="text-align: right;">0,0173195</td>
<td style="text-align: right;">28,71595</td>
<td style="text-align: right;">-51,43190</td>
<td style="text-align: right;">-50,88645</td>
<td style="text-align: right;">-45,81830</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Chegadas 
Model: ARIMA(0,0,1)(0,1,1)[12] 
Transformation: log(Chegadas) 

Coefficients:
         ma1     sma1
      0,2236  -0,5806
s.e.  0,1361   0,2472

sigma^2 estimated as 0,01647:  log likelihood=29,07
AIC=-52,13   AICc=-51,59   BIC=-46,52</code></pre>
</div>
</div>
<p>A <a href="#fig-chegresi" class="quarto-xref">Figura&nbsp;<span>6.23</span></a> expõe os gráficos de resíduos, indicando autocorrelção isolada para o lag 3, além de histograma com um pouco de assimetria à esquerda, porém, não representando desvio grave de normalidade. A <a href="#tbl-chegresilb" class="quarto-xref">Tabela&nbsp;<span>6.10</span></a> expõe o resultado do teste de Ljung-Box, que sugere a não rejeição da hipótese nula de ausência de autocorrelação nos resíduos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chegresi" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chegresi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-chegresi-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chegresi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.23: Gráficos para os resíduos do modelo <span class="math inline">\(ARIMA(0,0,1)(0,1,1)_{12}\)</span> para a variação sazonal no log série de chegada turistas no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-chegresilb" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-chegresilb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.10: Modelos ARIMA para o log série de chegada turistas no Brasil
</figcaption>
<div aria-describedby="tbl-chegresilb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31,34185</td>
<td style="text-align: right;">0,0893296</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-chegfc" class="quarto-xref">Figura&nbsp;<span>6.24</span></a> expõe o resultado da previsão dos modelos ARIMA considerados. Obviamente ambos os modelos não capturam a queda no volume de vôos nos anos da pandemia. Entretanto, as previsões apresentam boa proximidade com os resultados dos anos de 2023 e 2024. A <a href="#tbl-chegfcperf" class="quarto-xref">Tabela&nbsp;<span>6.11</span></a> expõe o desempenho dos modelos para os anos de 2023 e 2024. Confirma-se que o modelo <span class="math inline">\(ARIMA(0,0,1)(0,1,1)_{12}\)</span> apresentou melhor desempenho, com 10,3% de erro para estes anos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chegfc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chegfc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-chegfc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chegfc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.24: Previsão dos modelos ARIMA para a chegada turistas no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-chegfcperf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-chegfcperf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.11: Desempenho dos modelos ARIMA para o log da série de chegada turistas no Brasil para os anos de 2023 e 2024
</figcaption>
<div aria-describedby="tbl-chegfcperf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Modelo</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">MAE</th>
<th style="text-align: right;">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sarima001011</td>
<td style="text-align: right;">55576,20</td>
<td style="text-align: right;">47824,28</td>
<td style="text-align: right;">10,29882</td>
</tr>
<tr class="even">
<td style="text-align: left;">sarima100110</td>
<td style="text-align: right;">74167,86</td>
<td style="text-align: right;">64851,82</td>
<td style="text-align: right;">14,18985</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-passbr-dif12" class="quarto-xref">Figura&nbsp;<span>6.25</span></a> expõe a variação sazonal da série de log(passageiros) em vôos do Brasil, além dos correlogramas de ACF e PACF. Pode-se observar que a série sazonalmente diferenciada ainda apresenta alta tendência. É ainda necessário uma diferenciação de primeira ordem.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-passbr-dif12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-passbr-dif12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-passbr-dif12-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-passbr-dif12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.25: Variação sazonal no log(passageiros) de vôos no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-passbr-dif12-1" class="quarto-xref">Figura&nbsp;<span>6.26</span></a> apresenta a série mais uma vez diferenciada. Examinando-se o correlograma de ACF, pode-se sugerir um modelo MA(1) para a parte não sazonal, dada a significância no lag 1, e um modelo MA(1) para a parte sazonal, dada a significância no lag 12. Logo, pode-se sugerir um modelo <span class="math inline">\(ARIMA(0,1,1)(0,1,1)_{12}\)</span>. Ao observar o correlograma de PACF, há indícios de que um modelo autorregressivo de ordem AR(1) seja adequado para a parte não sazonal, enquanto um modelo AR(3) pode ser interessante para a parte sazonal, devido aos picos de 12, 24 e 36 meses. Entretanto, ao se tentar estimar um modelo <span class="math inline">\(ARIMA(1,1,0)(3,1,0)_{12}\)</span> não foram reportados resultados, sendo então aproximado um modelo <span class="math inline">\(ARIMA(1,1,0)(2,1,0)_{12}\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-passbr-dif12-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-passbr-dif12-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-passbr-dif12-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-passbr-dif12-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.26: Série de passageiros de vôos no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>Além dos modelos sugeridos, o método automático do pacote <code>fable</code> sugere um modelo de ordem <span class="math inline">\(ARIMA(1,1,1)(0,1,1)_{12}\)</span>, conforme <a href="#tbl-arima_" class="quarto-xref">Tabela&nbsp;<span>6.12</span></a>, muito próximo dos considerados inicialmente.</p>
<div class="cell">
<div id="tbl-arima_" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arima_-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.12: Modelos ARIMA testados para a série log(passageiros)
</figcaption>
<div aria-describedby="tbl-arima_-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Modelo</th>
<th style="text-align: left;">Ordem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sarima011011</td>
<td style="text-align: left;">&lt;ARIMA(0,1,1)(0,1,1)[12]&gt;</td>
</tr>
<tr class="even">
<td style="text-align: left;">sarima110210</td>
<td style="text-align: left;">&lt;ARIMA(1,1,0)(2,1,0)[12]&gt;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">auto</td>
<td style="text-align: left;">&lt;ARIMA(1,1,1)(0,1,1)[12]&gt;</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#tbl-arima_res" class="quarto-xref">Tabela&nbsp;<span>6.13</span></a> resume o resultado dos três modelos. Considerando o AICc, o modelo automático apresentou por pouco o melhor resultado.</p>
<div class="cell">
<div id="tbl-arima_res" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arima_res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.13: Resultados dos modelos ARIMA testados para a série log(passageiros)
</figcaption>
<div aria-describedby="tbl-arima_res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Modelo</th>
<th style="text-align: right;">sigma2</th>
<th style="text-align: right;">log_lik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">AICc</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">auto</td>
<td style="text-align: right;">0,0010447</td>
<td style="text-align: right;">455,1001</td>
<td style="text-align: right;">-902,2002</td>
<td style="text-align: right;">-902,0201</td>
<td style="text-align: right;">-888,5004</td>
</tr>
<tr class="even">
<td style="text-align: left;">sarima011011</td>
<td style="text-align: right;">0,0010532</td>
<td style="text-align: right;">453,7601</td>
<td style="text-align: right;">-901,5202</td>
<td style="text-align: right;">-901,4126</td>
<td style="text-align: right;">-891,2453</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sarima110210</td>
<td style="text-align: right;">0,0011762</td>
<td style="text-align: right;">444,0289</td>
<td style="text-align: right;">-880,0578</td>
<td style="text-align: right;">-879,8776</td>
<td style="text-align: right;">-866,3580</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A seguir são apresentados os coeficientes do modelo <span class="math inline">\(ARIMA(1,1,1)(0,1,1)_{12}\)</span>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Passageiros 
Model: ARIMA(1,1,1)(0,1,1)[12] 
Transformation: log(Passageiros) 

Coefficients:
         ar1      ma1     sma1
      0,5214  -0,6437  -0,7410
s.e.  0,2121   0,1859   0,0584

sigma^2 estimated as 0,001045:  log likelihood=455,1
AIC=-902,2   AICc=-902,02   BIC=-888,5</code></pre>
</div>
</div>
<p>A <a href="#fig-passbr-res" class="quarto-xref">Figura&nbsp;<span>6.27</span></a> apresenta os gráficos de resíduos do modelo <span class="math inline">\(ARIMA(1,1,1)(0,1,1)_{12}\)</span>. A série residual apresenta padrão estacionário e não há indícios de desvio de normalidade pelo histograma. Há significância na autocorrelação para as defasagens de 11, 13 e 22 observações.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-passbr-res" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-passbr-res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-passbr-res-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-passbr-res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.27: Série de passageiros de vôos no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#tbl-lb_auto" class="quarto-xref">Tabela&nbsp;<span>6.14</span></a> apresenta o resultado do teste de Ljung-Box para os resíduos do modelo <span class="math inline">\(ARIMA(1,1,1)(0,1,1)_{12}\)</span> para a série log(passageiros). No caso sazonal, considera-se <span class="math inline">\(K=p+q+P+Q\)</span> graus de liberdade no teste. Considerando um nível de significância de 0,05, não há indícios suficientes para rejeição da hipótese nula de ausência de autocorrelação residual.</p>
<div class="cell">
<div id="tbl-lb_auto" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lb_auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.14: Teste Ljung-Box para o modelo ARIMA(1,1,1)(0,1,1)12 para a série log(passageiros)
</figcaption>
<div aria-describedby="tbl-lb_auto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">28,77407</td>
<td style="text-align: right;">0,1195322</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-passbr-for" class="quarto-xref">Figura&nbsp;<span>6.28</span></a> apresenta a previsão para 3 anos à frente para a série de passageiros em vôos do Brasil. Sabe-se que a pandemia reduziu o volume de vôos para níveis menores que os dos anos 2000. Entretanto, o modelo capturou bem o padrão dos últimos anos e o padrão de sazonalidade no número de passageiros. Após alguns anos de observação pós-pandemia, modelos ARIMA seguirão sendo úteis para modelar a variação observada no volume de passageiros em vôos do Brasil.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-passbr-for" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-passbr-for-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-passbr-for-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-passbr-for-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.28: Previsão para 3 anos à frente para a série de passageiros de vôos no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-prodndur" class="quarto-xref">Figura&nbsp;<span>6.29</span></a> expõe a série de produtos não duráveis no Brasil. Observa-se padrão sazonal anual com tendência de crescimento até 2015 e depois de queda, com pior resultado em 2020, devido a pandemia. Após, 2021 observa-se tendência de recuperação.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-prodndur" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-prodndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-prodndur-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-prodndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.29: Produção mensal de bens não duráveis no Brasil
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-ndur_diff12" class="quarto-xref">Figura&nbsp;<span>6.30</span></a> expõe a série de bens de consumo não duráveis duplamente diferenciada - simples e sazonal (<span class="math inline">\(m=12\)</span>), considerando os dados de até dezembro de 2021. Pode-se sugerir pelo correlograma de PACF um modelo de ordem (2,1,0) para a parte não sazonal e um modelo de ordem (1,1,0) para a parte sazonal, dado o pico no atraso 12 meses. Já pelo correlograma de ACF, pode-se sugerir um modelo de ordem (0,1,1) para a parte não sazonal e um modelo de ordem (0,1,1) para a parte sazonal. Apesar de haverem outras autocorrelações siginificativas, estas não serão consideradas, uma vez que não são em sequência tanto para a tendência quanto para a sazonalidade.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ndur_diff12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ndur_diff12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-ndur_diff12-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ndur_diff12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.30: Variação sazonal na produção de bens de consumo não duráveis
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#tbl-arima_ndur" class="quarto-xref">Tabela&nbsp;<span>6.15</span></a> expõe os modelos testados manualmente e o selecionado automaticamente.</p>
<div class="cell">
<div id="tbl-arima_ndur" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arima_ndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.15: Modelos ARIMA testados para a série de bens não duráveis
</figcaption>
<div aria-describedby="tbl-arima_ndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Modelo</th>
<th style="text-align: left;">Ordem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arima210110</td>
<td style="text-align: left;">&lt;ARIMA(2,1,0)(1,1,0)[12]&gt;</td>
</tr>
<tr class="even">
<td style="text-align: left;">arima011011</td>
<td style="text-align: left;">&lt;ARIMA(0,1,1)(0,1,1)[12]&gt;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">auto</td>
<td style="text-align: left;">&lt;ARIMA(4,1,1)(0,1,1)[12]&gt;</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#tbl-arima_ndur_" class="quarto-xref">Tabela&nbsp;<span>6.16</span></a> apresenta os resultados para os modelos testados na série de bens de consumo não duráveis. O modelo <span class="math inline">\(ARIMA(4,1,1)(0,1,1)_{12}\)</span>, selecionado via pacote <code>fable</code> apresenta melhor ajuste. <span class="citation" data-cites="hyndman2008automatic">R. J. Hyndman e Khandakar (<a href="references.html#ref-hyndman2008automatic" role="doc-biblioref">2008</a>)</span> descrevem a abordagem usada no pacote para seleção automática de modelos SARIMA sem e com sazonalidade e também para modelos ETS.</p>
<div class="cell">
<div id="tbl-arima_ndur_" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arima_ndur_-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.16: Resultados dos ARIMA testados para a série de bens não duráveis
</figcaption>
<div aria-describedby="tbl-arima_ndur_-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.model</th>
<th style="text-align: right;">sigma2</th>
<th style="text-align: right;">log_lik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">AICc</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">auto</td>
<td style="text-align: right;">14,09469</td>
<td style="text-align: right;">-591,4166</td>
<td style="text-align: right;">1196,833</td>
<td style="text-align: right;">1197,374</td>
<td style="text-align: right;">1220,428</td>
</tr>
<tr class="even">
<td style="text-align: left;">arima011011</td>
<td style="text-align: right;">14,94719</td>
<td style="text-align: right;">-599,7525</td>
<td style="text-align: right;">1205,505</td>
<td style="text-align: right;">1205,619</td>
<td style="text-align: right;">1215,617</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arima210110</td>
<td style="text-align: right;">16,92686</td>
<td style="text-align: right;">-609,0919</td>
<td style="text-align: right;">1226,184</td>
<td style="text-align: right;">1226,374</td>
<td style="text-align: right;">1239,666</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-ndur_res" class="quarto-xref">Figura&nbsp;<span>6.31</span></a> apresenta os gráficos residuais para o modelo <span class="math inline">\(ARIMA(4,1,1)(0,1,1)_{12}\)</span> para a série de bens de consumo não duráveis. O valor discrepante março de 2021 é atribuído à pandemia. Observa-se picos de autocorrelação parcial para defasagens próximas de 2 anos. No entanto, pelo teste de Ljung-Box, apresentado na <a href="#tbl-lbox_ndur" class="quarto-xref">Tabela&nbsp;<span>6.17</span></a>, não há indícios suficientes que indicam a rejeição da hipótese de independência dos resíduos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ndur_res" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ndur_res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-ndur_res-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ndur_res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.31: Resíduos do modelo ARIMA(4,1,1)(0,1,1)12 para série de produção de bens de consumo não duráveis
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-lbox_ndur" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lbox_ndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.17: Teste de Ljung-Box para os resíduos da série de produção de bens de consumo não duráveis
</figcaption>
<div aria-describedby="tbl-lbox_ndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Estatística</th>
<th style="text-align: right;">pvalor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">25,45438</td>
<td style="text-align: right;">0,1129033</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-ndur-for" class="quarto-xref">Figura&nbsp;<span>6.32</span></a> apresenta graficamente os resultados de previsão para além de 2021, juntamente com os dados disponíveis e separados para teste. Observa-se boa proximidade com os dados não considerados para treinamento do modelo. Apesar da queda em 2021 devido à pandemia, o modelo treinado conseguiu apresentar uma boa projeção à curto e médio prazo.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ndur-for" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ndur-for-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ST6_files/figure-html/fig-ndur-for-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ndur-for-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.32: Previsão para 3 anos à frente para a série de bens de consumo não duráveis
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#tbl-metrics_ndur" class="quarto-xref">Tabela&nbsp;<span>6.18</span></a> finaliza a análise comparando o desempenho dos modelos estimados aplicados aos dados de teste para a série de bens de consumo não duráveis. Confirma-se a superioridade do modelo estimado automaticamente.</p>
<div class="cell">
<div id="tbl-metrics_ndur" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-metrics_ndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.18: Métricas para comparar o desenho dos modelos testados para a série de bens de consumo não duráveis
</figcaption>
<div aria-describedby="tbl-metrics_ndur-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Modelo</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">MAE</th>
<th style="text-align: right;">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arima011011</td>
<td style="text-align: right;">5,184891</td>
<td style="text-align: right;">4,167655</td>
<td style="text-align: right;">4,123478</td>
</tr>
<tr class="even">
<td style="text-align: left;">arima210110</td>
<td style="text-align: right;">7,123093</td>
<td style="text-align: right;">5,999505</td>
<td style="text-align: right;">5,991313</td>
</tr>
<tr class="odd">
<td style="text-align: left;">auto</td>
<td style="text-align: right;">5,714044</td>
<td style="text-align: right;">4,262668</td>
<td style="text-align: right;">4,127184</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="implementações-em-r" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="implementações-em-r"><span class="header-section-number">6.7</span> Implementações em R</h2>
<p>A seguir são apresentadas boa parte das implementações na linguagem R para obter os dados, gráficos e análises expostos no presente capítulo.</p>
<p>Carregando pacotes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fable)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rbcb)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ipeadatar)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Simulando uma série temporal de ruído branco. A função básica <code>rnorm</code> serve para gerar números aleatórios na distribuição normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>white <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="st">"2024-01-01"</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">199</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">+</span><span class="dv">70</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>white <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">""</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Ruído branco"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Diferenciação da série do índice Ibovespa. Usa-se o comando <code>difference</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ibov <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Ibovespa_ InfoMoney_2024.csv"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">header=</span>T)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ibov <span class="ot">&lt;-</span> ibov <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DATA =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ibov)) <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATA,FECHAMENTO) <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> DATA)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ibov <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="fu">difference</span>(FECHAMENTO)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"R$"</span>, <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Variação Índice Ibovespa"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A autocorrelação é obtida via função <code>ACF</code>, com o argumento <code>lag_max</code> para definir a diferenciação máxima. Usando a função <code>autoplot</code> em sequência, ao invés de se exibir as autocorrelações, plota-se o correlograma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ibov <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(FECHAMENTO, <span class="at">lag_max =</span> <span class="dv">30</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Índice Ibovespa"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para obter o correlograma da série diferenciada procedendo conforme segue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ibov <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(<span class="fu">difference</span>(FECHAMENTO), <span class="at">lag_max =</span> <span class="dv">30</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Variação Índice Ibovespa"</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Teste de KPSS da série do índice Ibovespa. Usa-se a opção <code>unitroot_kpss</code> no argumento da função <code>features</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>kpss1 <span class="ot">&lt;-</span> ibov <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">features</span>(FECHAMENTO, <span class="at">features =</span> unitroot_kpss)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>kpss1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Série de produção de coque.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>petro <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"petroleo_e_derivados.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>coque <span class="ot">&lt;-</span> petro <span class="sc">|&gt;</span> <span class="fu">select</span>(data,coque)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>coque_ts <span class="ot">&lt;-</span> coque <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">as.Date</span>(data, <span class="at">format=</span><span class="st">"%m/%d/%Y"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>coque_ts <span class="ot">&lt;-</span> coque_ts <span class="sc">|&gt;</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> data) <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="st">"2021-01-01"</span><span class="sc">~</span>.) <span class="sc">|&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">yearmonth</span>(data))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>coque_ts <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(coque) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"m^3"</span>, <span class="at">title=</span><span class="st">"Produção de coque no Brasil"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A série é estacionária, conforme confirma-se pelo teste de KPSS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>coque_ts <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">features</span>(coque, unitroot_kpss)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>coque_ts <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(coque) <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ARIMA automática para a série de produção de coque. Usa-se <code>ARIMA</code> em model e apenas a série de interesse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> coque_ts <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(coque))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Previsão 10 meses à frente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(coque_ts) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"m^3"</span>, <span class="at">title=</span><span class="st">"Produção de coque no Brasil"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Série temporal do valor da ação VALE3 a partir de 2020.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>vale <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"VALE3.csv"</span>, <span class="at">header =</span> T, <span class="at">dec=</span><span class="st">","</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>vale_ts <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(vale<span class="sc">$</span>Data,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">format =</span> <span class="st">"%d.%m.%Y"</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Valor =</span> vale<span class="sc">$</span>Último,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">index =</span> Date)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>vale_ts <span class="ot">&lt;-</span> vale_ts <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Date) <span class="sc">&gt;</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">yearmonth</span>(Date))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>vale_ts <span class="sc">|&gt;</span>  </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Valor) <span class="sc">+</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y =</span> <span class="st">"R$"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Valor da ação VALE3"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modelo ARIMA obtido automaticamente para a série.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> vale_ts <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Valor))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Avaliando os resíduos do modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Previsão 10 meses à frente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(vale_ts) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"R$"</span>, <span class="at">title=</span><span class="st">"Valor da ação VALE3"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correlogramas de autocorrelação ACF e PACF da série VALE3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>vale_ts <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(Valor) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>vale_ts <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PACF</span>(Valor) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modelo ARIMA(3,0,0). Deve-se usar <code>pdq(p,d,q)</code> para definir a ordem do modelo ARIMA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> vale_ts <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Valor <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>)))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Série de produção de grãos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>graos_prod <span class="ot">&lt;-</span> <span class="fu">ipeadata</span>(<span class="st">"DEPAE_SAFRA"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>graos  <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(<span class="at">valor =</span> <span class="fu">c</span>(graos_prod<span class="sc">$</span>value),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> <span class="fu">yearmonth</span>(graos_prod<span class="sc">$</span>date),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index=</span>data) <span class="sc">|&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data=</span><span class="fu">year</span>(data))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>graos <span class="sc">|&gt;</span>  </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(valor) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ton"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Produção de grãos no Brasil"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Transformação de Box-Cox da série.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> graos <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">features</span>(valor, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>graos <span class="sc">|&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="fu">box_cox</span>(valor, lambda)) <span class="sc">+</span> </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">""</span>, <span class="at">x=</span><span class="st">""</span>, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Produção de grãos no Brasil: transformação de Box-Cox"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variação da série transformada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>graos <span class="sc">|&gt;</span>  </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="fu">difference</span>(<span class="fu">box_cox</span>(valor, lambda))) <span class="sc">+</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Variação na produção de grãos no Brasil"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correlogramas de ACF e PACF para a série transformada e diferenciada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>graos <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(<span class="fu">difference</span>(<span class="fu">box_cox</span>(valor, lambda))) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>graos <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PACF</span>(<span class="fu">difference</span>(<span class="fu">box_cox</span>(valor, lambda))) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modelo ARIMA(1,1,0) para série transformada e diferenciada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> graos <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(<span class="fu">box_cox</span>(valor, lambda) <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit4)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modelo ARIMA(0,1,1).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> graos <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(<span class="fu">box_cox</span>(valor, lambda) <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit5)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Avaliação dos resíduos do modelo ARIMA(1,1,0).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tteste de Ljung-Box para os resíduos do modelo ARIMA(1,1,0). Considera-se um grau de liberdade, pois o modelo tem apenas um termo autorregressivo, <span class="math inline">\(p=1\)</span>. A diferenciação não conta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>QQ_ <span class="ot">&lt;-</span> fit4 <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">dof =</span> <span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>QQ_</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Previsão 10 anos à frente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(graos) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"ton"</span>, <span class="at">title=</span><span class="st">"Produção de grãos"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Série de passageiros em vôos no Brasil.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vroom)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>voosbr <span class="ot">&lt;-</span> <span class="fu">vroom</span>(<span class="st">"voosbr_ts.csv"</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_names =</span> T)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>voosbr_ts <span class="ot">&lt;-</span> voosbr <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">yearmonth</span>(data)) <span class="sc">|&gt;</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tsibble</span>(<span class="at">index =</span> data)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variação sazonal da série de log(passageiros) em vôos do Brasil e correlogramas de ACF e PACF.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>voosbr_ts  <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="sc">~</span><span class="st">"2019-01"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(<span class="fu">log</span>(Passageiros), <span class="dv">12</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot_type=</span><span class="st">'partial'</span>, <span class="at">lag=</span><span class="dv">36</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"log(Passageiros) de vôos no Brasil: Variação sazonal"</span>, <span class="at">y=</span><span class="st">""</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Série transformada com diferenciação simples e sazonal (<span class="math inline">\(m=12\)</span>), além dos correlogramas de ACF e PACF.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>voosbr_ts  <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="sc">~</span><span class="st">"2019-01"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(<span class="fu">log</span>(Passageiros), <span class="dv">12</span>) <span class="sc">|&gt;</span> <span class="fu">difference</span>(),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot_type=</span><span class="st">'partial'</span>, <span class="at">lag=</span><span class="dv">36</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Variação dupla"</span>, <span class="at">y=</span><span class="st">""</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Testando modelos <span class="math inline">\(ARIMA(0,1,1)(0,1,1)_{12}\)</span>, <span class="math inline">\(ARIMA(1,1,0)(2,1,0)_{12}\)</span>, além do autoarima. Para a parte sazonal soma-se no modelo <code>PDP(P,D,Q)</code> para definir a ordem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fit6 <span class="ot">&lt;-</span> voosbr_ts  <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(data)<span class="sc">&lt;</span><span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sarima011011 =</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Passageiros) <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sarima110210 =</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Passageiros) <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Passageiros), <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approx =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>fit6 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Modelo"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values_to =</span> <span class="st">"Ordem"</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Resultados dos três modelos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit6) <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AICc) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.model<span class="sc">:</span>BIC)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coeficientes do modelo automático, <span class="math inline">\(ARIMA(1,1,1)(0,1,1)_{12}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit6 <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(auto))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gráficos de resíduos do modelo <span class="math inline">\(ARIMA(1,1,1)(0,1,1)_{12}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit6 <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(auto) <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>(<span class="at">lag=</span><span class="dv">36</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Teste de Ljung-Box para os resíduos do modelo <span class="math inline">\(ARIMA(1,1,1)(0,1,1)_{12}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(fit6) <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.model <span class="sc">==</span> <span class="st">"auto"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag=</span><span class="dv">24</span>, <span class="at">dof=</span><span class="dv">3</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Previsão para 3 anos à frente para a série de passageiros em vôos do Brasil.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(fit6, <span class="at">h=</span><span class="dv">36</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">'auto'</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(voosbr_ts <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="sc">~</span><span class="st">"2020-01"</span>)) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Passageiros em vôos do Brasil"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Passageiros"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercícios-propostos." class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="exercícios-propostos."><span class="header-section-number">6.8</span> Exercícios propostos.</h2>
<p>A seguir o código para obter a série de produção de asfalto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>petro <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"petroleo_e_derivados.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>asfalto <span class="ot">&lt;-</span> petro <span class="sc">|&gt;</span> <span class="fu">select</span>(data,asfalto)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>asfalto_ts <span class="ot">&lt;-</span> asfalto <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">as.Date</span>(data, <span class="at">format=</span><span class="st">"%m/%d/%Y"</span>))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>asfalto_ts <span class="ot">&lt;-</span> asfalto_ts <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> data) <span class="sc">|&gt;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">yearmonth</span>(data))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>asfalto_ts <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(asfalto)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nos exercícios 1 ao 3 filtre a série até 2020.</p>
<ol type="1">
<li>Faça os correlogramas de ACF e PACF da série.</li>
</ol>
<ol start="2" type="1">
<li>Teste distintos modelos ARIMA, segundo autocorrelações observadas e compare com o ARIMA automático.</li>
</ol>
<ol start="3" type="1">
<li>Avalie os resíduos dos modelos testados.</li>
</ol>
<ol start="4" type="1">
<li>Considere os dados de 2021 à frente e faça a previsão. Calcule as métricas de erro e escolha o melhor modelo.</li>
</ol>
<ol start="5" type="1">
<li>Teste distintos modelos de suavização exponencial com sazonalidade para a série de produção de asfalto e compare com o melhor modelo ARIMA obtido.</li>
</ol>
<p>Seja a série de chegadas de turistas internacionais no Brasil, apresentada neste capítulo, obtida conforme segue.</p>
<ol start="6" type="1">
<li><p>Obtenha com a função <code>gg_tsdisplay</code> a diferenciação sazonal (m=12) do log da série e os correlogramas de ACF e PACF.</p></li>
<li><p>Faça o teste de KPSS para avaliar se a variação sazonal do log da série é estacionária.</p></li>
<li><p>Obtenha modelos SARIMA segundo propõem os padrões dos correlogramas de ACF e PACF. Considere o período de 2015 a 2019. Selecione o melhor modelo segundo a métrica <span class="math inline">\(AICc\)</span> e obtenha os coficientes deste via <code>report</code>.</p></li>
<li><p>Obtenha os resíduos do melhor modelo e faça o teste de Ljung-Box para avaliar a autocorrelação destes.</p></li>
<li><p>Faça a previsão cinco anos à frente (h=60), plote os resultados e compare o desempenho dos modelos considerando os anos de 2023 e 2024.</p></li>
<li><p>Considerando a série de produção de bens de consumo duráveis, apresentada no primeiro capítulo, realize o mesmo fluxo proposto nas questões 6 a 10, com as devidas adaptações (por exemplo, decidindo entre diferenciação simples, sazonal ou dupla, segundo o padrão da série). Obtenha modelos ARIMA adequados à série usando dados de até 2020 e compare-os para os últimos anos da série.</p></li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-box2008time" class="csl-entry" role="listitem">
Box, George EP, Gwilym M Jenkins, Gregory C Reinsel, e Greta M Ljung. 2008. <em>Time series analysis: forecasting and control</em>. John Wiley &amp; Sons.
</div>
<div id="ref-cryer2008time" class="csl-entry" role="listitem">
Cryer, Jonathan D, e Kung-Sik Chan. 2008. <em>Time series analysis: with applications in R</em>. Springer.
</div>
<div id="ref-hamilton2020time" class="csl-entry" role="listitem">
Hamilton, James D. 1994. <em>Time series analysis</em>. Princeton university press.
</div>
<div id="ref-harvey1990econometric" class="csl-entry" role="listitem">
Harvey, Andrew C. 1990. <em>The econometric analysis of time series</em>. MIT press.
</div>
<div id="ref-hyndman2018forecasting" class="csl-entry" role="listitem">
Hyndman, RJ, e G Athanasopoulos. 2021. <em>Forecasting: principles and practice</em>. OTexts. <a href="https://OTexts.com/fpp3">OTexts.com/fpp3</a>.
</div>
<div id="ref-hyndman2008automatic" class="csl-entry" role="listitem">
Hyndman, Rob J, e Yeasmin Khandakar. 2008. <span>«Automatic time series forecasting: the forecast package for R»</span>. <em>Journal of statistical software</em> 27: 1–22.
</div>
<div id="ref-kwiatkowski1992testing" class="csl-entry" role="listitem">
Kwiatkowski, Denis, Peter CB Phillips, Peter Schmidt, e Yongcheol Shin. 1992. <span>«Testing the null hypothesis of stationarity against the alternative of a unit root: How sure are we that economic time series have a unit root?»</span> <em>Journal of econometrics</em> 54 (1-3): 159–78.
</div>
<div id="ref-makridakis2008forecasting" class="csl-entry" role="listitem">
Makridakis, Spyros, Steven C Wheelwright, e Rob J Hyndman. 2008. <em>Forecasting methods and applications</em>. John wiley &amp; sons.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ST5.html" class="pagination-link" aria-label="Suavização exponencial">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Suavização exponencial</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ST7.html" class="pagination-link" aria-label="Regressão dinâmica">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regressão dinâmica</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>